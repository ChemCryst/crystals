<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Atomic And Structural Parameters &mdash; CRYSTALS 15.4.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=a6d7e377"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Structure Factors And Least Squares" href="sfls.html" />
    <link rel="prev" title="Reflection Data Input" href="reflectiondata.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            CRYSTALS
          </a>
              <div class="version">
                15.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">CRYSTALS documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide.html">Crystals User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../userguide/install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/gettingstarted.html">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/gettingstarted.html#organisation-of-data">Organisation of data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/gettingstarted.html#starting-the-program">Starting the program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/gettingstarted.html#customising-crystals-to-suit-your-screen-size">Customising CRYSTALS to suit your screen size</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/examples.html">Worked examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/examples.html#cyclo-a-routine-structure-analysis">Cyclo - a routine structure analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#video-demonstration">Video demonstration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-one-import-cell-and-crystal-data">Step one: Import cell and crystal data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-two-import-reflection-data">Step two: Import reflection data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-three-initial-assessment-of-the-data">Step three: Initial assessment of the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-four-structure-solution">Step four: Structure solution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-five-check-atom-types">Step five: Check atom types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-six-commence-refinement">Step six: Commence refinement…</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-seven-adding-hydrogen-atoms">Step seven: Adding Hydrogen Atoms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-eight-more-refinement-extinction">Step eight: More refinement &amp; Extinction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-nine-choose-a-nice-weighting-scheme">Step nine: Choose a nice weighting scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#step-ten-validation-and-cif-archival">Step ten: Validation and CIF archival.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/examples.html#poor-quality-data-tetraphenylene">Poor Quality Data - Tetraphenylene</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#analysis-and-solution">Analysis and solution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#refinement">Refinement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/examples.html#but-what-of-the-e-s-d-s">But what of the e.s.d’s?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/examples.html#spacegroup-quiz">Spacegroup Quiz</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/userinterface.html">User Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/userinterface.html#overview-of-the-graphical-user-interface">Overview of the graphical user interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/userinterface.html#the-menus">The Menus</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#file">File</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#x-ray-data">X-ray data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#preprocess">Diffractometer cifs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#input-pre-processed-data">Input Pre-processed data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#solve">Solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#structure">Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#fourier">Fourier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#refinement">Refinement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#results-rotax">Results -&gt; Rotax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#graphics">Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#graphics-special">Graphics -&gt; Special</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#appearance">Appearance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#appearance-atoms">Appearance -&gt; Atoms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#appearance-model">Appearance -&gt; Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../userguide/userinterface.html#development">Development</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/commandline.html">Command line</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/commandline.html#command-syntax">Command syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/faqs.html">Frequently asked questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#getting-started-organisation-of-files">Getting Started: Organisation of files.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#general-who-is-responsible-for-it">General: Who is responsible for it?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#general-where-is-the-manual">General: Where is the manual?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#general-is-there-an-example-to-work-through">General: Is there an example to work through?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#general-can-i-prepare-commands-to-run-crystals-in-batch-mode-like-shelx">General: Can I prepare commands to run CRYSTALS in batch mode (like SHELX)?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#general-is-there-any-command-line-help">General: Is there any command line help?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#general-how-can-i-switch-the-left-and-right-crystals-windows">General: How can I switch the left and right CRYSTALS windows?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#solving-structures-how-do-i-prepare-a-job-for-sir92-or-shelxs">Solving structures: How do I prepare a job for SIR92 or SHELXS?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#solving-structures-it-failed-how-do-i-prepare-a-different-job">Solving structures: It failed. How do I prepare a different job?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#solving-structures-how-do-i-import-the-solution-back-into-crystals">Solving structures: How do I import the solution back into CRYSTALS?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#cameron-how-do-i-see-a-plot-of-the-structure">CAMERON: How do I see a plot of the structure?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#cameron-can-i-rotate-it-and-label-the-atoms">CAMERON: Can I rotate it and label the atoms?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#cameron-how-do-i-delete-atoms">CAMERON: How do I delete atoms?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#fourier-how-do-i-calculate-a-fourier-map-to-find-missing-atoms">Fourier: How do I calculate a Fourier map to find missing atoms?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#refinement-what-infomation-does-crystals-need">Refinement: What infomation does CRYSTALS need?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#refinement-refinement-instructions">Refinement: Refinement instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#refinement-occupancies-of-an-atom-or-fragment-split-over-two-sites">Refinement: Occupancies of an atom or fragment split over two sites?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#refinement-how-do-i-add-restraints">Refinement: How do I add restraints?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#refinement-how-do-you-use-platon-s-squeeze-from-crystals">Refinement: How do you use Platon’s Squeeze from CRYSTALS?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#refinement-what-are-parts-assemblies-and-groups">Refinement: What are parts assemblies and groups?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#structure-how-can-i-adjust-a-molecule-or-fragment-to-have-ideal-coordinates">Structure: How can I adjust a molecule or fragment to have ideal coordinates?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#analysis-find-the-angle-between-a-plane-of-atoms-and-a-bond">Analysis: Find the angle between a plane of atoms and a bond</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#analysis-calculate-intermolecular-distances">Analysis: Calculate intermolecular distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#analysis-find-likely-h-bonds-with-donors-or-acceptors-other-the-o-and-n">Analysis: Find LIKELY H-BONDS with donors or acceptors other the O and N</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#analysis-how-do-i-use-rotax-to-test-for-twin-laws">Analysis: How do I use ROTAX to test for twin laws?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#analysis-how-do-i-add-hydrogen-atoms-to-water-molecules">Analysis: How do I add hydrogen atoms to water molecules?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#publication-editor-wants-completeness-of-the-data-at-25-degrees">Publication: Editor wants completeness of the data at 25 degrees</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#publication-what-s-the-difference-between-theta-max-and-theta-full">Publication: What’s the difference between _theta_max and _theta_full?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#publication-diagram-shows-wrong-enantiomer-what-to-do">Publication: Diagram shows wrong enantiomer. What to do?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#references-what-references-should-i-know-about">References: What References should I know about?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/faqs.html#miscellaneous-environment-variables">Miscellaneous: Environment variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../crystalsmanual.html">Crystals Reference Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Definitions And Conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="intro.html#syntax-of-commands">Syntax of Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#format-of-commands">Format of Commands</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#syntax-of-the-manual">Syntax of the manual</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#types-of-commands">Types of Commands:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#lists">Lists</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#commands">Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#immediate-commands">Immediate Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#comments">Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#continuation-lines">Continuation Lines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#index-3">Immediate commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#finish">\FINISH</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#id2">\ ….. COMMENTS ….</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#title-a-title-to-be-printed">\TITLE ….. A title to be printed …..</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#type-filename">\TYPE  ‘filename’</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#use-source">\USE source</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#script-filename">\SCRIPT filename</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#spawn-shell-command">\SPAWN      ‘shell command’</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#shell-command">$      ‘shell command’</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#commands-command">\COMMANDS   command</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#text">? text</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#manual-name">\MANUAL  ‘name’</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#help-topic">\HELP   ‘topic’</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#release-devicename-filename">\RELEASE  devicename filename</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#open-devicename-filename">\OPEN devicename filename</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#close-devicename">\CLOSE devicename</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#append-devicename-filename">\APPEND devicename filename</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#flush-devicename">\FLUSH devicename</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#device-names">Device names</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#pause-interval">\PAUSE interval</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#bench-nparam-nref">\BENCH nparam nref</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-list-state">\SET LIST   state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-watch-number">\SET WATCH number</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-file-type">\SET FILE type</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-generate-state">\SET GENERATE state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-export-state">\SET EXPORT state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-uequiv-state">\SET UEQUIV state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-pause-value">\SET PAUSE value</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-log-state">\SET LOG state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-mirror-state">\SET MIRROR state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-page-length">\SET PAGE length</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-terminal-device">\SET TERMINAL device</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-communication-speed">\SET COMMUNICATION speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-time-state">\SET TIME state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-printer-state">\SET PRINTER state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-monitor-state">\SET MONITOR state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-openmessage-state">\SET OPENMESSAGE state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-message-state">\SET MESSAGE state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-srq-state">\SET SRQ state</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#set-ratio-state">\SET RATIO state</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#files">Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#errors-and-warnings">Errors and Warnings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#warnings">Warnings</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#errors">Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#severe-errors">Severe Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#catastrophic-errors">Catastrophic Errors.</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#programming-errors">Programming Errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#errors-detected-during-the-creation-of-a-list">Errors Detected During the Creation of a LIST</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-crystals-database">The Crystals Database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="intro.html#general-list-control-directives-disk">General List-control Directives  -  \DISK</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#disk">\DISK</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#elimination-of-old-versions-of-lists-purge">Elimination of Old Versions of LISTS  -  \PURGE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#id3">\PURGE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#lists-in-current-use">LISTS in Current use</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#printed-summary-of-data-lists">Printed Summary of Data lists</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#summary">\SUMMARY</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#element-and-atom-names">Element and Atom names</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#element-names">Element Names</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#atom-names">Atom names</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#symmetry-equivalent-atoms">Symmetry equivalent atoms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#foreign-program-links">Foreign Program Links</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#foreign">\FOREIGN</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="initial.html">Initial Data Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="initial.html#scope-of-the-initial-data-input-section">Scope of the Initial Data Input section.</a></li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#abbreviated-startup-command-quickstart">Abbreviated startup command  -  QUICKSTART</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#quickstart">\QUICKSTART</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-the-cell-parameters-list-1">Input of the cell parameters  -  LIST 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#list-1">\LIST 1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#printing-the-cell-parameters">Printing the cell parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#print-1">\PRINT 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="initial.html#punch-1">\PUNCH 1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-the-unit-cell-parameter-errors-list-31">Input of the unit cell parameter errors  -  LIST 31</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#list-31">\LIST 31</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#printing-the-cell-variance-covariance-matrix">Printing the cell variance-covariance matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#print-31">\PRINT 31</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#space-group-input-spacegroup">Space Group input - \SPACEGROUP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#id1">\SPACEGROUP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-the-symmetry-data-list-2">Input of the symmetry data  -  LIST 2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#list-2">\LIST 2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#printing-the-symmetry-information">Printing the symmetry information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#print-2">\PRINT 2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-molecular-composition-composition">Input of molecular composition \COMPOSITION</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#composition">\COMPOSITION</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-the-atomic-scattering-factors-list-3">Input of the atomic scattering factors  -  \LIST 3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#list-3">\LIST 3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#printing-the-scattering-factors">Printing the scattering factors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#print-3">\PRINT 3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-the-crystal-and-data-collection-details-list-13">Input of the crystal and data collection details  -  LIST 13</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#list-13">\LIST 13</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#printing-the-experimental-conditions-list-13">Printing the experimental conditions, LIST 13</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#print-13">\PRINT 13</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-structural-formula-as-a-smiles-string-list-18">Input of Structural Formula as a SMILES string - LIST 18</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#list-18">\LIST 18</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#printing-the-smiles-string-list-18">Printing the SMILES string, LIST 18</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#print-18">\PRINT 18</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#punching-the-smiles-string-list-18">Punching the SMILES string, LIST 18</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#punch-18">\PUNCH 18</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-the-contents-of-the-asymmetric-unit-list-29">Input of the contents of the asymmetric unit  -  LIST 29</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#list-29">\LIST 29</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#printing-the-contents-of-the-asymmetric-unit-list-29">Printing the contents of the asymmetric unit, LIST 29</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#print-29">\PRINT 29</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#input-of-general-crystallographic-data-list-30">Input of General Crystallographic Data - LIST 30</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#list-30">\LIST 30</a></li>
<li class="toctree-l4"><a class="reference internal" href="initial.html#interval">INTERVAL=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="initial.html#printing-the-general-information-list-30">Printing the general information, LIST 30</a><ul>
<li class="toctree-l4"><a class="reference internal" href="initial.html#print-30">\PRINT 30</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reflectiondata.html">Reflection Data Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#scope-of-the-reflection-data-input-section-of-the-reference-manual">Scope of the Reflection Data Input section of the Reference Manual</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#reflection-data">Reflection Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#simple-input-of-f-or-fsq-data-list-6">Simple input of F or Fsq data - LIST 6</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#creation-of-list-7-from-list-6-copy-6-7">Creation of LIST 7 from LIST 6 - COPY 6 7</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#printing-list-6">Printing LIST 6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#print-6-mode">\PRINT 6 mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#punching-list-6">Punching LIST 6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#punch-6-mode">\PUNCH 6 mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#advanced-input-of-f-or-fsq-data-list-6">Advanced input of F or Fsq data - LIST 6</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#reflection-parameter-coefficients">Reflection Parameter Coefficients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#special-reflection-storage">Special Reflection storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#recognised-reflection-coefficients">Recognised reflection coefficients</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#storage-of-reflection-data">Storage of reflection data</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#compressed-reflection-data">Compressed reflection data</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#intensity-data-hkli">Intensity Data - HKLI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#hkli">\HKLI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#intensity-decay-curves-list-27">Intensity Decay Curves  \LIST 27</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#list-27">\LIST 27</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#printing-the-decay-curve">Printing the decay curve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#print-27">\PRINT 27</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#data-reduction-lp">Data Reduction - Lp</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#lp">\LP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#systematic-absence-removal-systematic">Systematic absence removal - \SYSTEMATIC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#id1">\SYSTEMATIC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#sorting-of-the-reflection-data-sort">Sorting of the reflection data  -  \SORT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#id2">\SORT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#merging-equivalent-reflections-merge">Merging equivalent reflections  -  \MERGE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#weighting-schemes-for-the-data-merge">WEIGHTING SCHEMES FOR THE DATA MERGE</a></li>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#standard-deviations-produced-by-the-merge">Standard deviations produced by the merge</a></li>
<li class="toctree-l4"><a class="reference internal" href="reflectiondata.html#merge">\MERGE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#theta-dependent-absorption-correction-thetabs">Theta-dependent Absorption Correction  -  \THETABS</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#wilson-plot-wilson">WILSON PLOT  -  \WILSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#thlim-thlim">THLIM  -  \THLIM</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectiondata.html#sigmadist-sigmadist">SIGMADIST  -  \SIGMADIST</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Atomic And Structural Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scope-of-the-atomic-and-structural-parameters-section">Scope of the atomic and structural parameters Section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specifications-of-atoms-and-other-parameters">Specifications of atoms and other parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#atom-specification">ATOM SPECIFICATION</a></li>
<li class="toctree-l4"><a class="reference internal" href="#atomic-parameter-specification">ATOMIC PARAMETER SPECIFICATION</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overall-parameter-specification">OVERALL PARAMETER SPECIFICATION</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#input-of-atoms-and-other-parameters-list-5">Input of atoms and other parameters  -  LIST 5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#list-5">\LIST 5</a></li>
<li class="toctree-l4"><a class="reference internal" href="#further-examples-of-parameter-input">Further examples of parameter input</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#printing-and-punching-list-5">Printing and punching list 5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#print-5">\PRINT 5</a></li>
<li class="toctree-l4"><a class="reference internal" href="#punch-5-mode">\PUNCH 5 mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summary-display-of-list-5-display">Summary display of LIST 5 - \DISPLAY</a></li>
<li class="toctree-l4"><a class="reference internal" href="#display-level">\DISPLAY    LEVEL=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#editing-structural-parameters-edit">Editing structural parameters -  \EDIT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#edit-inputlist-outputlist">\EDIT INPUTLIST OUTPUTLIST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reorganisation-of-lists-5-and-10-regroup">Reorganisation of lists 5 and 10  -  \REGROUP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#regroup-inputlist-outputlist">\REGROUP INPUTLIST= OUTPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#repositioning-of-atoms-collect">Repositioning of atoms  -  \COLLECT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#collect-inputlist-outputlist">\COLLECT INPUTLIST= OUTPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#shifting-the-molecule-to-a-permitted-alternative-origin-origin">Shifting the molecule to a permitted alternative origin - \ORIGIN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#origin-inputlist-outputlist-mode">\ORIGIN INPUTLIST= OUTPUTLIST= MODE=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-of-temperature-factors-convert">Conversion of temperature factors - \CONVERT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#convert-inputlist-outputlist-crossterms">\CONVERT INPUTLIST= OUTPUTLIST= CROSSTERMS=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hydrogen-placing-hydrogens">Hydrogen placing - \HYDROGENS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hydrogens-inputlist-outputlist">\HYDROGENS INPUTLIST= OUTPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#perhydrogenation-perhydro">Perhydrogenation - \PERHYDRO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#perhydro-inputlist-outputlist">\PERHYDRO INPUTLIST= OUTPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hydrogen-re-numbering-hname">Hydrogen re-numbering - \HNAME</a></li>
<li class="toctree-l3"><a class="reference internal" href="#regularisation-of-atomic-groups-regularise">Regularisation of atomic groups - \REGULARISE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-for-regularise">Input for REGULARISE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-from-regularise">Output from REGULARISE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#method-of-calculation">Method of calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regularise-mode">\REGULARISE    MODE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#uses-of-regularise">Uses of \REGULARISE</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#map-two-atomic-groups-together-match">Map two atomic groups together - \MATCH</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculation-of-interatomic-bonds-bondcalc">Calculation of interatomic bonds - \BONDCALC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Method of calculation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bonding-information-list-40">Bonding information - \LIST 40</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bonding-information-bonding">Bonding information - \BONDING</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printing-of-list-40">Printing of LIST 40</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#print-40">\PRINT 40</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summary-40">\SUMMARY 40</a></li>
<li class="toctree-l4"><a class="reference internal" href="#punch-40">\PUNCH 40</a></li>
<li class="toctree-l4"><a class="reference internal" href="#punch-40-b">\PUNCH 40 B</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-null-list-40">Creating a null LIST 40</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printing-of-list-41">Printing of LIST 41</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#print-41">\PRINT 41</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summary-41">\SUMMARY 41</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sfls.html">Structure Factors And Least Squares</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#scope-of-the-structure-factors-and-least-squares-section">Scope of the structure factors and least squares section</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#refinement">Refinement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#correlations-in-refinement">Correlations in Refinement</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#f-or-fsq-refinement">F or Fsq refinement?</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#hydrogen-atom-refinement">Hydrogen Atom Refinement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#special-positions">Special positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#atomic-parameter-refinement">Atomic parameter refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#overall-parameter-refinement">Overall parameter refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#scale-factor-definitions">Scale factor definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#structure-factor-calculation-control-list-list-23">Structure factor calculation control list  -  LIST 23</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#list-23">\LIST 23</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#printing-the-slfs-control-list">Printing the SLFS control list</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#print-23">\PRINT 23</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#special-position-constraints-special">Special position constraints - \SPECIAL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#special-action-update-tolerance">\SPECIAL  ACTION= UPDATE= TOLERANCE=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#printing-the-special-position-information">Printing the special position information</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#refinement-directives-list-12">Refinement directives  -  LIST 12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#list-12">\LIST 12</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#obsolete-refinement-directives">Obsolete Refinement directives</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#defining-the-least-squares-matrix">Defining the least squares matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#printing-of-list-12">Printing of LIST 12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#print-12">\PRINT 12</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#summary-12">\SUMMARY 12</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#punch-12">\PUNCH 12</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#creating-a-null-list-12">Creating a null LIST 12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#clear-12">\CLEAR 12</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#processing-of-list-12">Processing of LIST 12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#list-22">\LIST 22</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#restraints-list-16">Restraints  -  LIST 16</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#parameter-atom-bond-and-angle-specifications">Parameter, atom, bond and angle specifications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#list-16">\LIST 16</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#general-restraints">General restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#id1">General restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#debugging-restraints">Debugging restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#printing-the-contents-of-list-16">Printing the contents of LIST 16</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#print-16">\PRINT 16</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#summary-list-16">\SUMMARY LIST 16</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#punch-16">\PUNCH 16</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#creating-a-null-list-16">Creating a null LIST 16</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#clear-16">\CLEAR 16</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#the-special-restraints-list-17">The special restraints  -  LIST 17</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#list-17">\LIST 17</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#printing-and-punching-list-17">Printing and punching LIST 17</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#print-17">\PRINT 17</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#summary-list-17">\SUMMARY LIST 17</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#punch-17">\PUNCH 17</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#creating-a-null-list-17">Creating a null LIST 17</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#clear-17">\CLEAR 17</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#checking-restraints-check">Checking restraints - CHECK</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#check-level">\CHECK LEVEL=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#weighting-schemes-for-refinement-list-4">Weighting schemes for refinement-  LIST 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#weighting-for-refinement-against-fo">Weighting for refinement against Fo</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#weighting-for-refinement-against-fsq">Weighting for refinement against Fsq</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#list-4">\LIST 4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#weights-stored-in-list-6">Weights stored in LIST 6</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#weighting-schemes">Weighting schemes</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#dunitz-seiler-weighting-scheme-13">Dunitz Seiler weighting - scheme 13</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#chebychev-weighting-schemes-10-11">Chebychev weighting schemes 10, 11</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#robust-resistant-weighting-schemes-14-15">Robust-resistant weighting schemes 14, 15</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#statistical-weights-16">Statistical Weights, 16</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#auto-statistical-weights-17">Auto-Statistical Weights, 17</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#printing-list-4">Printing LIST 4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#print-4">\PRINT 4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#weighting-the-reflections-weight">Weighting the reflections - WEIGHT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#weight-input-factor">\WEIGHT INPUT= FACTOR=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#reflection-restriction-list-list-28">Reflection restriction list  -  LIST 28</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#list-28">\LIST 28</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#creating-a-null-list-28">Creating a null LIST 28</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#printing-the-contents-of-list-28">Printing the contents of LIST 28</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#print-28">\PRINT 28</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#structure-factor-least-squares-calculations-sfls">Structure Factor Least Squares Calculations  -  \SFLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#definitions">Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#unstable-refinements">Unstable refinements</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#sorting-of-list-6-for-structure-factor-calculations">Sorting of LIST 6 for structure factor calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#id2">\SFLS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#processing-of-the-refinement-directives">Processing of the refinement directives</a></li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#analysis-of-residuals-analyse">Analysis of residuals -  \ANALYSE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#analyse-input">\ANALYSE INPUT=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#least-squares-absorption-correction-difabs">Least squares absorption correction  - \DIFABS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#difabs-action-mode-input">\DIFABS  ACTION= MODE= INPUT=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sfls.html#internal-workings">Internal workings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#parameter-esds-list-9">Parameter esds - LIST 9</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#refinement-parameter-map-list-22">Refinement parameter map  -  LIST 22</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#the-least-squares-matrix-list-11">The least squares matrix  -  LIST 11</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#printing-the-contents-of-list-11">Printing the contents of LIST 11</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#least-squares-shift-list-list-24">Least squares shift list  -  LIST 24</a></li>
<li class="toctree-l4"><a class="reference internal" href="sfls.html#restraints-in-internal-format-list-26">Restraints in internal format  -  LIST 26</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fourier.html">Fourier Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#scope-of-the-fourier-section-of-the-user-guide">Scope of the Fourier section of the user guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#input-of-the-fourier-section-limits-list-14">Input of the Fourier section limits - LIST 14</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fourier.html#list-14">\LIST 14</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#printing-the-contents-of-list-14">Printing the contents of LIST 14</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fourier.html#print-14">\PRINT 14</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#compute-fourier-limits-from-the-symmetry">Compute Fourier limits from the symmetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#fourier-calculations-fourier">Fourier calculations  -  \FOURIER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fourier.html#fourier-input">\FOURIER INPUT=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#calculation-of-superposition-minimum-functions">Calculation of superposition minimum functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#processing-of-the-peaks-list-list-10">Processing of the peaks list  -  LIST 10</a></li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#printing-the-contents-of-list-10">Printing the contents of LIST 10</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fourier.html#print-10">\PRINT 10</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#elimination-of-duplicated-entries-in-lists-5-and-10-peaks">Elimination of duplicated entries in LISTS 5 and 10  -  \PEAKS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fourier.html#peaks-inputlist-outputlist">\PEAKS INPUTLIST= OUTPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fourier.html#slant-fourier-calculations-slant">Slant fourier calculations  -  \SLANT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fourier.html#slant-input">\SLANT INPUT=</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis Of Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#scope-of-this-section-of-the-user-guide">Scope of this section of the user guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#analysis-of-residuals-analyse">Analysis of residuals - \ANALYSE</a></li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#create-esd-list-esd">Create esd list - \ESD</a></li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#output-vcv-matrix-of-selected-atoms">Output VcV matrix of selected atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#distance-angles-calculations-distances">Distance angles calculations  -  \DISTANCES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#distances-inputlist">\DISTANCES INPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#distance-angles-symmetry-operations">Distance-angles symmetry operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#void-location-voids">Void Location  -  \VOIDS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#voids-inputlist">\VOIDS INPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#tls-analysis-best-planes-and-lines-geometry">TLS analysis, best planes and lines  -  \GEOMETRY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#geometry-inputlist">\GEOMETRY INPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#torsion-angles-torsion">Torsion angles  -  \TORSION</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#torsion-inputlist">\TORSION INPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#absolute-configuration-ton">Absolute Configuration  -  \TON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#ton">\TON</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#publication-listing-of-the-atomic-parameters-parameters">Publication listing of the atomic parameters  -  \PARAMETERS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#parameters">\PARAMETERS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#publication-listing-of-reflection-data-reflections">Publication listing of reflection data  - \REFLECTIONS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#reflections-input">\REFLECTIONS INPUT=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#summary-of-data-lists-summary">Summary of data lists - \SUMMARY</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#summary-of-type-level">\SUMMARY OF= TYPE= LEVEL=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#estimation-of-absolute-configuration-tonspek">Estimation of Absolute configuration - \TONSPEK</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#tonspek-input-type-plot-punch-filter1-filter5-weight">\TONSPEK INPUT= TYPE= PLOT= PUNCH= FILTER1= … FILTER5= WEIGHT=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#cif-lists-cif">CIF lists - \CIF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#cif">\CIF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#adding-archive-files-addarc">Adding Archive files - ADDARC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#addarc-filename">ADDARC filename</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html#graphics-cameron">Graphics - CAMERON</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysis.html#cameron">CAMERON</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="twin.html">Twinned Crystals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="twin.html#twinning-introduction">Twinning - introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="twin.html#tlqs-twins">TLQS twins</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#tls-twins">TLS twins</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="twin.html#twinning-problems">Twinning Problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twinning-initial-clues">Twinning - Initial clues</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twinning-data-collection-and-processing">Twinning - Data collection and processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twinning-structure-solution">Twinning - Structure solution</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twinning-structure-refinement">Twinning - Structure Refinement</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twin-data-stored-by-crystals">Twin Data stored by CRYSTALS</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twinning-lists-affected">Twinning - LISTS affected</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twin-list-5">Twin List 5</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twin-list-6">Twin List 6</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twin-list-13">TWIN LIST 13</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twin-list-12">Twin List 12</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twin-list-16">Twin List 16</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="twin.html#sorting-twinned-structure-data-reorder">SORTING TWINNED STRUCTURE DATA  -  \REORDER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="twin.html#reorder">\REORDER</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twins-backward-compatability">Twins - backward compatability</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twins-worked-example">Twins - Worked Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="twin.html#twinning-mathematical-aspects">Twinning - Mathematical aspects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix Calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="matrix.html#the-basic-matrix-calculator-matrix">The Basic Matrix Calculator \MATRIX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="matrix.html#matrix">\MATRIX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="obsolete.html">Obsolete Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="obsolete.html#index-0">Obsolete Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="obsolete.html#least-squares-best-planes-and-lines-molax">Least squares best planes and lines  -  \MOLAX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="obsolete.html#molax-inputlist">\MOLAX INPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="obsolete.html#thermal-displacement-parameter-analysis-aniso">Thermal displacement parameter analysis  -  \ANISO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="obsolete.html#aniso-inputlist">\ANISO INPUTLIST</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="obsolete.html#principal-atomic-displacement-directions-axes">Principal atomic displacement directions  -  \AXES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="obsolete.html#axes-inputlist">\AXES INPUTLIST=</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="obsolete.html#structure-factors-for-a-group-of-trial-models-trial">Structure factors for a group of trial models  -  \TRIAL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="obsolete.html#trial">\TRIAL</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="secret.html">Secret Lists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="secret.html#index-0">Secret LISTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="secret.html#storage-of-intermediate-results-and-the-status-of-a-refinement-list-39">Storage of intermediate results and the status of a refinement -  LIST 39</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cameron.html">Cameron Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#how-to-control-the-program">HOW TO CONTROL THE PROGRAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#command-groups">Command Groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#error-handling">ERROR HANDLING</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#abandon">Abandon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#edit">Edit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#help">Help</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#the-help-facility">The HELP facility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#mouse-activation">Mouse Activation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#general-input-syntax">General Input Syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#how-to-get-started">How To Get Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#data-input">Data Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#input-of-crystals-list-5-files">Input of CRYSTALS List 5 files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#input">INPUT</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#outputting-data">Outputting Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#output">OUTPUT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#editing-the-atom-list">Editing The Atom List</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#rename">RENAME</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#retype">RETYPE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#obeying-files">Obeying Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#obey">OBEY</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#archiving-and-retrieving-views">Archiving And Retrieving Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#archive">ARCHIVE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#retrieve">RETRIEVE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#graphical-output-devices">Graphical Output Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#screen">SCREEN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#hardcopy">HARDCOPY</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#view-direction-control">View Direction Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#basic-control">BASIC CONTROL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#xrot">XROT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#yrot">YROT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#zrot">ZROT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#rot">ROT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#cursor">CURSOR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#orientation-commands">ORIENTATION COMMANDS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#plane">PLANE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#face">FACE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#along">ALONG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#vertical">VERTICAL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#horizontal">HORIZONTAL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#bisect">BISECT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#other-related-commands">Other related commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#view">VIEW</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#copy">COPY</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#matrix">MATRIX</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#stereo">STEREO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#nostereo">NOSTEREO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#photographs">PHOTOGRAPHS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#photo">PHOTO</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#include-and-exclude">Include And Exclude</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#include">INCLUDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#exclude">EXCLUDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#further-related-commands">Further related commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#mask">MASK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#unmask">UNMASK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#switch">SWITCH</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#generation-of-dummy-atoms">Generation of Dummy atoms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#dummy">DUMMY</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#drawing-style-control">Drawing Style Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#line">LINE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#ball">BALL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#ellipse">ELLIPSE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#all">ALL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#fragment">FRAGMENT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#group">GROUP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#line-commands">LINE commands.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#ball-commands">BALL commands.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#ellipse-commands">ELLIPSE commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#connectivity-control">Connectivity Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#connect">CONNECT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id1">CONNECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#join">JOIN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#remove">REMOVE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#disconnect">DISCONNECT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#miscellaneous-connect-commands">Miscellaneous CONNECT commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#taper">TAPER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#thickness">THICKNESS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#tolerance">TOLERANCE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#control-of-colour">Control Of Colour</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#colour">COLOUR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#id2">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#atom-labelling">Atom Labelling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#label">LABEL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#nolabel">NOLABEL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#font">FONT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#text">TEXT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#other-picture-controlling-commands">Other Picture Controlling Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#maximise">MAXIMISE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#scale">SCALE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#symmetry-input">Symmetry Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#input-of-symmetry-operators">Input of symmetry operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#spacegroup">SPACEGROUP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#symmetry">SYMMETRY</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#example-of-space-group-input">Example of Space Group Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#other-symmetry-related-operations">Other symmetry related operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#setunit">SETUNIT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#enantio">ENANTIO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#special">SPECIAL</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#crystal-packing-commands">Crystal Packing Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#pack">PACK</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#cell">CELL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#window">WINDOW</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#dealing-with-connectivity">Dealing with connectivity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#intra">INTRA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#inter">INTER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#keep">KEEP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id3">INTRA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id4">INTER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id5">KEEP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#examples">EXAMPLES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#enclosure">ENCLOSURE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#choice-of-enclosure-origin">Choice of enclosure “origin”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#atom">ATOM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#point">POINT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#type-of-volume-to-be-used">Type of volume to be used</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#sphere">SPHERE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#anorthic">ANORTHIC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#orthogonal">ORTHOGONAL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#id6">EXAMPLE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#packing-more-complicated-structures">PACKING MORE COMPLICATED STRUCTURES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id7">GROUP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#unpack">UNPACK</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#add-and-move-further-symmetry-related-commands">Add And Move - Further Symmetry Related Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#add">ADD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#atoms">ATOMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id8">ALL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#initial">INITIAL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id9">GROUP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#id10">EXAMPLES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#move">MOVE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id11">ATOMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id12">ALL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id13">GROUP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#id14">INITIAL</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#distance-and-angle-calculations">Distance And Angle Calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#distance">DISTANCE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#method-of-calculation">Method of Calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#angle">ANGLE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cameron.html#torsion">TORSION</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#information-on-data-held-within-the-program">Information On Data Held Within The Program</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#information">INFORMATION</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#group-definitions">Group Definitions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#defgroup">DEFGROUP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#id15">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#miscellaneous-commands">Miscellaneous Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#reset">RESET</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#log">LOG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#id16">EDIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#menus">MENUS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#issue">ISSUE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#print">PRINT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#how-to-stop-the-program">How To Stop The Program</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cameron.html#end">END</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#menu-definition-file">Menu Definition File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cameron.html#some-useful-ideas">Some Useful Ideas</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CRYSTALS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../crystalsmanual.html">Crystals Reference Manual</a></li>
      <li class="breadcrumb-item active">Atomic And Structural Parameters</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/crystals/parameters.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound">
</div>
<section id="atomic-and-structural-parameters">
<h1>Atomic And Structural Parameters<a class="headerlink" href="#atomic-and-structural-parameters" title="Link to this heading"></a></h1>
<section id="scope-of-the-atomic-and-structural-parameters-section">
<span id="atomparams"></span><h2>Scope of the atomic and structural parameters Section<a class="headerlink" href="#scope-of-the-atomic-and-structural-parameters-section" title="Link to this heading"></a></h2>
<p>The areas covered are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Specifications</span> <span class="n">of</span> <span class="n">atoms</span> <span class="ow">and</span> <span class="n">other</span> <span class="n">parameters</span>
<span class="n">Input</span> <span class="n">of</span> <span class="n">atoms</span> <span class="ow">and</span> <span class="n">other</span> <span class="n">parameters</span>              <span class="o">-</span> \<span class="n">LIST</span> <span class="mi">5</span>
<span class="n">Re</span><span class="o">-</span><span class="n">order</span> <span class="n">the</span> <span class="n">atom</span> <span class="nb">list</span>                           <span class="o">-</span> \<span class="n">REGROUP</span>
<span class="n">Collect</span> <span class="n">atoms</span> <span class="n">together</span> <span class="n">by</span> <span class="n">symmetry</span>               <span class="o">-</span> \<span class="n">COLLECT</span>
<span class="n">Move</span> <span class="n">the</span> <span class="n">structure</span> <span class="n">into</span> <span class="n">the</span> <span class="n">cell</span>                 <span class="o">-</span> \<span class="n">ORIGIN</span>
<span class="n">Modification</span> <span class="n">of</span> <span class="n">lists</span> <span class="mi">5</span> <span class="ow">and</span> <span class="mi">10</span> <span class="n">on</span> <span class="n">the</span> <span class="n">disc</span>       <span class="o">-</span> \<span class="n">EDIT</span>
<span class="n">Applying</span> <span class="n">permitted</span> <span class="n">origin</span> <span class="n">shifts</span>                 <span class="o">-</span> \<span class="n">ORIGIN</span>
<span class="n">Conversion</span> <span class="n">of</span> <span class="n">temperature</span> <span class="n">factors</span>                <span class="o">-</span> \<span class="n">CONVERT</span>
<span class="n">Hydrogen</span> <span class="n">placing</span>                                 <span class="o">-</span> \<span class="n">HYDROGENS</span>
<span class="n">Per</span><span class="o">-</span><span class="n">hydrogenation</span>                                <span class="o">-</span> \<span class="n">PERHYDRO</span>
<span class="n">Re</span><span class="o">-</span><span class="n">numbering</span> <span class="n">hydrogen</span> <span class="n">atoms</span>                      <span class="o">-</span> \<span class="n">HNAME</span>
<span class="n">Regularisation</span> <span class="n">of</span> <span class="n">groups</span> <span class="ow">in</span> <span class="n">LIST</span> <span class="mi">5</span>               <span class="o">-</span> \<span class="n">REGULARISE</span>
</pre></div>
</div>
</section>
<section id="specifications-of-atoms-and-other-parameters">
<span id="index-0"></span><h2>Specifications of atoms and other parameters<a class="headerlink" href="#specifications-of-atoms-and-other-parameters" title="Link to this heading"></a></h2>
<p>There is a consistent syntax thoughout CRYSTALS for refering to atoms
and atomic parameters. This was referred to briefly in Chapter 1, and
will be defined more fully here.</p>
<section id="atom-specification">
<h3>ATOM SPECIFICATION<a class="headerlink" href="#atom-specification" title="Link to this heading"></a></h3>
<blockquote>
<div><p>There are three different but related ways of specifying an atom
or a group of atoms.</p>
</div></blockquote>
<p><strong>TYPE(SERIAL,S,L,TX,TY,TZ)</strong></p>
<blockquote>
<div><p>This specification defines one atom.
The various parts of the expression are :</p>
</div></blockquote>
<p><em>TYPE</em></p>
<blockquote>
<div><p>The atom type, defined in Chapter 1 in the section on form-factors.</p>
</div></blockquote>
<p><em>SERIAL</em></p>
<blockquote>
<div><p>The serial number, in the range 1-9999</p>
</div></blockquote>
<p><em>Checking of serial numbers</em></p>
<blockquote>
<div><p>Atoms of the same type are distinguished from one another by having
different serial numbers. However, at no stage is a check made to ensure
that there is not more than one atom in LIST 5 (atomic parameters) with
the same type and
serial number. If a routine is searching for an atom with a given type
and serial number, the first atom found will always be taken, and any
subsequent atoms with the same type and serial number will be ignored.</p>
<p>Serial numbers are considered to be different if they differ from
each other by more than 0.0005.</p>
</div></blockquote>
<p><em>S</em></p>
<blockquote>
<div><p>‘S’ specifies a symmetry operator provided
in the unit cell symmetry LIST (LIST 2 - see section <a class="reference internal" href="initial.html#list02"><span class="std std-ref">Input of the symmetry data  -  LIST 2</span></a>).
‘S’ may take any value between ‘-NSYM’ and
‘+NSYM’, except zero, where ‘NSYM’ is the
number of symmetry equivalent positions
provided in LIST 2.
if ‘S’ is less than zero, the coordinates
of the atom stored in LIST 5 are negated (i.e.
inverted through a centre of symmetry at
the origin) and then multiplied by the
operator specified by the absolute value of
‘S’ to generate the new atomic coordinates.
‘S’ may be less than zero even if the space
group is non-centrosymmetric ( <em>i.e.</em> introduce a false centre),
but must not be greater than ‘NSYM’.
The default value for ‘S’ is ‘1’, specifying the
first matrix in LIST 2, usually the unit matrix.</p>
</div></blockquote>
<p><em>L</em></p>
<blockquote>
<div><p>‘L’ specifies the non-primitive lattice translation
that is to be added after the coordinates have been
modified by the operations given by ‘S’.
‘L’ must not be greater than the number of allowed
non-primitive translations in the space group.
The translations provided by ‘L’ depend on
the lattice type and are given by :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">L</span><span class="o">=</span>    <span class="mi">1</span>             <span class="mi">2</span>                <span class="mi">3</span>                <span class="mi">4</span>

<span class="n">P</span>       <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
<span class="n">I</span>       <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>      <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="n">R</span>       <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>      <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span>      <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="n">F</span>       <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>        <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>      <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>      <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span>
<span class="n">A</span>       <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>        <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="n">B</span>       <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>      <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="n">C</span>       <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>      <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
</pre></div>
</div>
<p>the default value of ‘L’ is ‘1’, specifying no
non-primitve lattice translation.</p>
</div></blockquote>
<p><em>TX,TY,TZ</em></p>
<blockquote>
<div><p>Unit cell translation along the x,y and z directions.</p>
<p>The unit cell translations are added to the
coordinates after the ‘S’ and ‘L’ operations
have been performed.
The translations may be positive or
negative, but must refer to complete
unit cell shifts.
The default values for ‘TX’, ‘TY’ and ‘TZ’
are all zero, giving no unit cell translations.</p>
<p>The symmetry operations are applied in the order :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="mf">1.</span>  <span class="n">Centre</span> <span class="n">of</span> <span class="n">symmetry</span> <span class="k">if</span> <span class="s1">&#39;S&#39;</span> <span class="n">negative</span>
  <span class="mf">2.</span>  <span class="n">Symmetry</span> <span class="n">operator</span> <span class="s1">&#39;S&#39;</span>
  <span class="mf">3.</span>  <span class="n">Non</span><span class="o">-</span><span class="n">primitve</span> <span class="n">lattice</span> <span class="n">translation</span>
  <span class="mf">4.</span>  <span class="n">Whole</span> <span class="n">unit</span> <span class="n">cell</span> <span class="n">translations</span> <span class="s1">&#39;T(X)&#39;</span><span class="p">,</span> <span class="s1">&#39;T(Y)&#39;</span><span class="p">,</span> <span class="s1">&#39;T(Z)&#39;</span><span class="o">.</span>

<span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span>
       <span class="n">X</span><span class="s1">&#39;=  [R(s)](+X) + t(s) + L + T(X) + T(Y) + T(Z)</span>
<span class="ow">or</span>
       <span class="n">X</span><span class="s1">&#39;=  [R(s)](-X) + t(s) + L + T(X) + T(Y) + T(Z)</span>
</pre></div>
</div>
<p>The format given above is a complete atom definition.
For convenience the definition may sometimes be shortened.
The obligatory parts are the  TYPE  and  SERIAL.
The remaining parameters, S,  L,  TX,  TY, TZ, are optional.</p>
<p>An optional parameter taking its default value
may be omitted, though its place must be marked by its associated
comma. A series of trailing commas may be omitted.</p>
<p>The following are all equivalent :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TYPE</span><span class="p">(</span><span class="n">SERIAL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">TYPE</span><span class="p">(</span><span class="n">SERIAL</span><span class="p">,,,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">TYPE</span><span class="p">(</span><span class="n">SERIAL</span><span class="p">,</span><span class="mi">1</span><span class="p">,,,,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">TYPE</span><span class="p">(</span><span class="n">SERIAL</span><span class="p">,,,,,)</span>
</pre></div>
</div>
<p>The values of  S ,  L ,  TX ,  TY  and  TZ  are exactly those
output and used by the distance angles routines under the headings
S(I) ,  L ,  T(X) ,  T(Y)  and  T(Z)  respectively.
(See the section of the user guide on ‘results of refinement’).</p>
<p>When the symmetry operators are applied, the actual values
of  S  and  L  are checked to see that they are reasonable.
If the values found are not reasonable, an error message will
be output and the job terminated.</p>
<p>In some cases, the symmetry operators are accepted on input,
but not used by the routine. The description of the routine will state this.</p>
</div></blockquote>
<p><strong>UNTIL sequences</strong></p>
<blockquote>
<div><p>When a group of atoms lie sequentially in the atom parameter list,
there is an abbreviated way to refer to the group.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TYPE1</span><span class="p">(</span><span class="n">SERIAL1</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">TX</span><span class="p">,</span><span class="n">TY</span><span class="p">,</span><span class="n">TZ</span><span class="p">)</span>  <span class="n">UNTIL</span>  <span class="n">TYPE2</span><span class="p">(</span><span class="n">SERIAL2</span><span class="p">)</span>
</pre></div>
</div>
<p>This definition specifies all the
atoms in the current list starting with the atom TYPE1(SERIAL1)
The first atom in the specification must  occur before the second atom
in the current parameter list,
otherwise an error message will be output and the task aborted.
If symmetry operators are used, they must be given for the first atom
of the sequence, and will be appied to all  the atoms in the sequence.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Examples</span>

            <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">until</span> <span class="n">C</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">Six</span> <span class="n">atoms</span> <span class="n">lying</span> <span class="n">around</span> <span class="n">a</span> <span class="n">centre</span> <span class="n">of</span> <span class="n">symmetry</span><span class="p">:</span>

            <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">until</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>FIRST   AND   LAST</strong></p>
<blockquote>
<div><p>These specifications each define one atom.   FIRST  Refers to the
first atom stored in LIST 5 (the model parameters) or LIST 10
(Fourier peaks), and  LAST  refers to the last atom in the
list. If these are used as atom designators, no serial number may be given,
but symmetry operators may be. They may be used in until sequences.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span>
            <span class="n">LAST</span>
            <span class="n">FIRST</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">FIRST</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">C</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>  <span class="n">C</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">LAST</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>ALL</strong></p>
<blockquote>
<div><p>This specifies all atoms in the list, can take symmetry
operators or parameter names, but cannot be accompanied on the same line
by any other atom specifiers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span>
            <span class="n">ALL</span>
            <span class="n">ALL</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">ALL</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>RESIDUE</strong></p>
<blockquote>
<div><p>This specifies all atoms or parameters with the given residue number.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span>
            <span class="n">RESIDUE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">RESIDUE</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">X</span><span class="s1">&#39;s)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>PART</strong></p>
<blockquote>
<div><p>This specifies all atoms or parameters with the given part number.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span>
            <span class="n">PART</span><span class="p">(</span><span class="mi">3001</span><span class="p">)</span>
            <span class="n">PART</span><span class="p">(</span><span class="mi">3001</span><span class="p">,</span><span class="n">X</span><span class="s1">&#39;s)</span>
</pre></div>
</div>
<p>The part number is constructed from two values, the assembly number and
the group number.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PART</span> <span class="n">NO</span><span class="o">.</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">ASSEMBLY</span> <span class="n">NO</span><span class="o">.</span> <span class="o">+</span> <span class="n">GROUP</span> <span class="n">NO</span><span class="o">.</span>
</pre></div>
</div>
<p>The assembly number is normally zero, but a value
can be given to all atoms that are involved in a particular disordered
area of the structure. E.g. on a disordered methyl all the H atoms could
be placed in assembly number 1.</p>
<p>The group number within an assembly groups together those atoms which
are simultaneously occupied. E.g. on a disordered methyl, all the H atoms
approximately 109 degrees apart would be given the same group number.</p>
<p>The part and group numbers affect the default bonds that are determined
by CRYSTALS, and subsequently output in the CIF or summary file. Some
bonding rules are applied in the following order of priority:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">An</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">assembly</span> <span class="mi">0</span><span class="p">,</span> <span class="n">group</span> <span class="mi">0</span><span class="p">,</span> <span class="n">will</span> <span class="n">bond</span> <span class="n">to</span> <span class="nb">any</span> <span class="n">other</span> <span class="n">nearby</span> <span class="n">atom</span><span class="o">.</span>
<span class="mf">2.</span> <span class="n">Atoms</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">assembly</span><span class="p">,</span> <span class="n">but</span> <span class="k">with</span> <span class="n">different</span><span class="p">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span> <span class="n">group</span> <span class="n">numbers</span>
   <span class="n">will</span> <span class="ow">not</span> <span class="n">bond</span> <span class="n">to</span> <span class="n">each</span> <span class="n">other</span><span class="o">.</span>
<span class="mf">3.</span> <span class="n">Atoms</span> <span class="ow">in</span> <span class="n">different</span> <span class="n">assemblies</span> <span class="k">with</span> <span class="n">one</span> <span class="n">zero</span> <span class="n">group</span> <span class="n">number</span>
   <span class="n">will</span> <span class="ow">not</span> <span class="n">bond</span> <span class="n">to</span> <span class="n">each</span> <span class="n">other</span><span class="o">.</span>
<span class="mf">4.</span> <span class="n">Atoms</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">assembly</span> <span class="ow">and</span> <span class="n">group</span><span class="p">,</span> <span class="n">but</span> <span class="k">with</span> <span class="n">a</span> <span class="n">negative</span> <span class="n">group</span> <span class="n">number</span>
   <span class="n">will</span> <span class="ow">not</span> <span class="n">bond</span> <span class="n">to</span> <span class="n">symmetry</span> <span class="n">related</span> <span class="n">atoms</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">assembly</span> <span class="ow">and</span> <span class="n">group</span><span class="o">.</span>
<span class="mf">5.</span> <span class="n">All</span> <span class="n">remaining</span> <span class="n">close</span> <span class="n">contacts</span> <span class="n">will</span> <span class="n">be</span> <span class="n">bonded</span> <span class="n">together</span><span class="o">.</span>
</pre></div>
</div>
<p>Rule 3 may be ignored unless you’re trying to set up something very
special. Rule 4 is useful if you have a group disordered across a
symmetry element.</p>
<p>Finally, you can select all atoms in a given part of group by using the number 999 as a wild-card.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span>
            <span class="n">PART</span><span class="p">(</span><span class="mi">3999</span><span class="p">,</span><span class="n">X</span><span class="s1">&#39;s)</span>
<span class="n">selects</span> <span class="nb">all</span> <span class="n">atoms</span> <span class="ow">in</span> <span class="n">assembly</span> <span class="mf">3.</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>HPART</strong></p>
<blockquote>
<div><p>This specifies all hydrogen (or deuterium) atoms or parameters with the given part number.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span>
            <span class="n">HPART</span><span class="p">(</span><span class="mi">3001</span><span class="p">)</span>
            <span class="n">HPART</span><span class="p">(</span><span class="mi">3001</span><span class="p">,</span><span class="n">X</span><span class="s1">&#39;s)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>NHPART</strong></p>
<blockquote>
<div><p>This specifies all non-hydrogen (and deuterium) atoms or parameters with the given part number.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">examples</span>
            <span class="n">NHPART</span><span class="p">(</span><span class="mi">3001</span><span class="p">)</span>
            <span class="n">NHPART</span><span class="p">(</span><span class="mi">3001</span><span class="p">,</span><span class="n">X</span><span class="s1">&#39;s)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>TYPE</strong></p>
<blockquote>
<div><p>This enable all atoms or parameters on atoms of the given type to be
processed together.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">example</span>
<span class="o">/</span><span class="n">EDIT</span>
<span class="n">RESET</span> <span class="mi">9900</span> <span class="n">PART</span> <span class="n">TYPE</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This puts all the hydrogen atoms into PART(9900). Since all other
atoms are in PART(0) or a specified PART, the hydrogen will now be
treated independently.</p>
</div></blockquote>
</section>
<section id="atomic-parameter-specification">
<h3>ATOMIC PARAMETER SPECIFICATION<a class="headerlink" href="#atomic-parameter-specification" title="Link to this heading"></a></h3>
<blockquote>
<div><p>Atomic parameters have a NAME. Some directives permit the use of the
parameter name by itself, which implies that parameter for all atoms.
The parameter name may be combined with an atom specifier, in which case
only the parameter for that atom (or group in an UNTIL sequence) is
referenced. Symmetry operators may be used. The normal drop-out rules
apply.</p>
</div></blockquote>
<p><strong>Parameter NAMES</strong></p>
<blockquote>
<div><p>The following NAMES are recognised.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>      <span class="n">Y</span>      <span class="n">Z</span>      <span class="n">OCC</span>      <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>    <span class="n">SPARE</span>
<span class="n">U</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>  <span class="n">U</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>  <span class="n">U</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span>  <span class="n">U</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>    <span class="n">U</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>     <span class="n">U</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
<span class="n">X</span><span class="s1">&#39;S    U&#39;</span><span class="n">S</span>    <span class="n">UIJ</span><span class="s1">&#39;S  UII&#39;</span><span class="n">S</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Examples</span>
  <span class="n">X</span>            <span class="n">The</span> <span class="s1">&#39;x&#39;</span> <span class="n">coordinate</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">atoms</span>
  <span class="n">C</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>     <span class="n">The</span> <span class="s1">&#39;x&#39;</span> <span class="ow">and</span> <span class="s1">&#39;y&#39;</span> <span class="n">coordinates</span> <span class="k">for</span> <span class="n">atom</span> <span class="n">C</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
  <span class="n">FIRST</span><span class="p">(</span><span class="n">X</span><span class="s1">&#39;S)   The &#39;</span><span class="n">x</span><span class="s1">&#39;,&#39;</span><span class="n">y</span><span class="s1">&#39; and &#39;</span><span class="n">z</span><span class="s1">&#39; coordinates for the first atom</span>
  <span class="n">FIRST</span><span class="p">(</span><span class="sa">U</span><span class="s1">&#39;S) UNTIL C(23)</span>
               <span class="n">The</span> <span class="n">anisotropic</span> <span class="n">temperature</span> <span class="n">factors</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">atoms</span>
               <span class="n">up</span> <span class="n">to</span> <span class="n">C</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Temperature factor definitions</strong></p>
<p><em>Isotropic temperature factor</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">isotropic</span> <span class="n">temperature</span> <span class="n">factor</span> <span class="ow">is</span> <span class="n">defined</span> <span class="n">by</span><span class="p">:</span>

      <span class="n">T</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">iso</span><span class="p">]</span><span class="o">*</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                                      <span class="n">where</span> <span class="n">s</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">/</span><span class="k">lambda</span>
</pre></div>
</div>
</div></blockquote>
<p><em>Anisotropic Temperature Factor</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">anisotropic</span> <span class="n">temperature</span> <span class="n">factor</span> <span class="p">(</span><span class="n">adp</span><span class="p">)</span> <span class="ow">is</span> <span class="n">defined</span> <span class="n">by</span><span class="p">:</span>

 <span class="n">T</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">a</span><span class="s1">&#39;*a*u[11]</span>
                  <span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="sa">b</span><span class="s1">&#39;*b&#39;</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
                  <span class="o">+</span><span class="n">l</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="n">c</span><span class="s1">&#39;*c&#39;</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span>
              <span class="o">+</span><span class="mf">2.0</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="sa">b</span><span class="s1">&#39;*c&#39;</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
              <span class="o">+</span><span class="mf">2.0</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="n">a</span><span class="s1">&#39;*c&#39;</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
              <span class="o">+</span><span class="mf">2.0</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">a</span><span class="s1">&#39;*b&#39;</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span><span class="o">.</span>
                                 <span class="n">where</span> <span class="n">x</span><span class="s1">&#39; are the reciprocal</span>
                                 <span class="n">cell</span> <span class="n">parameters</span> <span class="ow">and</span> <span class="n">h</span><span class="p">,</span> <span class="n">k</span> <span class="ow">and</span>
                                 <span class="n">l</span> <span class="n">are</span> <span class="n">the</span> <span class="n">Miller</span> <span class="n">indices</span>
</pre></div>
</div>
</div></blockquote>
<p><em>Uequiv</em></p>
<blockquote>
<div><p>CRYSTALS contains two definitions od Uequiv. Both definitions are acceptable
to Acta. The arithmetic mean of the principle axes is often similar
to the refined value of Uiso. The geometric mean is more sensitive to
long or short axes, and so is more useful in publications. Ugeom is the
sphere with the same volume as the ellipsoid.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">(</span><span class="n">arith</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">U1</span><span class="o">+</span><span class="n">U2</span><span class="o">+</span><span class="n">U3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<span class="n">U</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>  <span class="o">=</span> <span class="p">(</span><span class="n">U1</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">U3</span><span class="p">)</span><span class="o">**</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
                              <span class="n">Where</span> <span class="n">Ui</span> <span class="n">are</span> <span class="n">the</span> <span class="n">principal</span> <span class="n">axes</span> <span class="n">of</span>
                              <span class="n">the</span> <span class="n">orthogonalised</span> <span class="n">tensor</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>CAUTION</strong></p>
<p>It should be noted that if a set of anisotropic atoms are input with
the
FLAG  key set to anything but 0, then the parameters will be
interpreted as Isotropic atoms, or special shapes.</p>
</div></blockquote>
<p><strong>Uequiv</strong></p>
<blockquote>
<div><p>Two expressions are available for the equivalent temperature factor
(the geometric or arithmetric mean of the principal components).
The Immediate Command ‘SET UEQUIV’ sets which definition will be used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ugeom</span>  <span class="o">=</span> <span class="p">(</span><span class="n">Ui</span> <span class="o">*</span> <span class="n">Uj</span> <span class="o">*</span> <span class="n">Uk</span><span class="p">)</span><span class="o">**</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span>

<span class="n">Uarith</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ui</span> <span class="o">+</span> <span class="n">Uj</span> <span class="o">+</span> <span class="n">Uk</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
                                 <span class="n">Where</span> <span class="n">Ui</span><span class="p">,</span> <span class="n">Uj</span> <span class="o">&amp;</span> <span class="n">Uk</span> <span class="n">are</span> <span class="n">the</span>
                                 <span class="n">principal</span> <span class="n">components</span> <span class="n">of</span> <span class="n">U</span>

<span class="n">Ugeom</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">radius</span> <span class="n">of</span> <span class="n">the</span> <span class="n">sphere</span> <span class="k">with</span> <span class="n">the</span> <span class="n">same</span> <span class="n">volume</span> <span class="k">as</span> <span class="n">the</span> <span class="n">adp</span>
<span class="n">ellipsoid</span><span class="p">,</span> <span class="ow">and</span> <span class="n">thus</span> <span class="n">gives</span> <span class="n">a</span> <span class="n">good</span> <span class="n">indication</span> <span class="n">of</span> <span class="n">the</span> <span class="n">quality</span> <span class="n">of</span> <span class="n">the</span>
<span class="n">ellipsoid</span><span class="o">.</span> <span class="n">Uarith</span> <span class="ow">is</span> <span class="n">often</span> <span class="n">closer</span> <span class="n">to</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">Uiso</span><span class="p">,</span> <span class="ow">and</span> <span class="n">so</span> <span class="ow">is</span>
<span class="n">useful</span> <span class="k">for</span> <span class="n">returning</span> <span class="n">to</span> <span class="n">an</span> <span class="n">isotropic</span> <span class="n">refinement</span><span class="o">.</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>The Special Shapes</strong></p>
<blockquote>
<div><p>The SPecial Shape keys are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span> <span class="n">serial</span> <span class="n">occ</span> <span class="n">FLAG</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="n">u</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>  <span class="n">u</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="n">u</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="n">u</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="n">u</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="n">u</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="n">spare</span>
                           <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>                               <span class="n">spare</span>
                           <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">SIZE</span>                          <span class="n">spare</span>
                           <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">SIZE</span>  <span class="n">DECLINAT</span> <span class="n">AZIMUTH</span>        <span class="n">spare</span>
</pre></div>
</div>
<p>The value of ‘FLAG’ is used on input of atoms to indicate what kind of
patameters will follow, and is used during calculations for the
interpretation of the parameters.</p>
</div></blockquote>
<p><em>FLAG interpretation</em></p>
<blockquote>
<div><p>The following table shows the interpretation of the FLAG parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FLAG</span>        <span class="n">meaning</span>          <span class="n">parameters</span>

<span class="s1">&#39;normal&#39;</span> <span class="n">types</span> <span class="n">of</span> <span class="n">atoms</span><span class="p">:</span>

 <span class="mi">0</span>          <span class="n">Aniso</span> <span class="n">ADP</span>        <span class="n">u</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>  <span class="n">u</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="n">u</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="n">u</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="n">u</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="n">u</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
 <span class="mi">1</span>          <span class="n">Iso</span> <span class="n">ADP</span>          <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>

<span class="n">New</span> <span class="s1">&#39;special&#39;</span> <span class="n">shapes</span><span class="p">:</span>

 <span class="mi">2</span>          <span class="n">Sphere</span>           <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">SIZE</span>
 <span class="mi">3</span>          <span class="n">Line</span>             <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">SIZE</span>  <span class="n">DECLINAT</span> <span class="n">AZIMUTH</span>
 <span class="mi">4</span>          <span class="n">Ring</span>             <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">SIZE</span>  <span class="n">DECLINAT</span> <span class="n">AZIMUTH</span>
</pre></div>
</div>
<p>The parameters have the following meaning for the new special shapes:</p>
</div></blockquote>
<p><em>Special U[iso]</em></p>
<blockquote>
<div><p>U[iso] is related to the ‘thickness’ of the line, annulus or shell.</p>
</div></blockquote>
<p><strong>Special SIZE</strong></p>
<blockquote>
<div><p>SIZE is the length of the line, or the radius of the annulus or shell.</p>
</div></blockquote>
<p><em>Special DECLINAT</em></p>
<blockquote>
<div><p>DECLINAT is the declination angle between the line axis or annulus normal and the
<em>z</em>
axis of the usual CRYSTALS orthogonal coordinate system, in
degrees/100.</p>
</div></blockquote>
<p><em>Special AZIMUTH</em></p>
<blockquote>
<div><p>AZIMUTH is the azimuthal angle between the projection of the
line axis or annulus normal onto the <em>x</em> - <em>y</em> plane and the <em>x</em>
axis of the usual CRYSTALS orthogonal coordinate system, in
degrees/100.</p>
<p>If either of these angles is input with a value greater than 5.0, it
is assumed that the user has forgotten to divide by 100, which is thus
done automatically.</p>
</div></blockquote>
</section>
<section id="overall-parameter-specification">
<h3>OVERALL PARAMETER SPECIFICATION<a class="headerlink" href="#overall-parameter-specification" title="Link to this heading"></a></h3>
<blockquote>
<div><p>Overall parameters are specified simply by their keys.
The following overall parameter keys may be given :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SCALE</span>      <span class="n">OU</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>      <span class="n">DU</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>      <span class="n">POLARITY</span>
<span class="n">ENANTIO</span>    <span class="n">EXTPARAM</span>
</pre></div>
</div>
</div></blockquote>
<p><em>SCALE</em></p>
<blockquote>
<div><p>This parameter defines the overall scale factor and has a default value
of unity.
It is the number by which /FC/ must be multiplied to put
it onto the scale of /FO/, i.e. /Fo/ = scale*/FC/.</p>
</div></blockquote>
<p><em>DU[ISO]</em></p>
<blockquote>
<div><p>This parameter is the dummy overall isotropic temperature factor and has
a default value of 0.05.</p>
<p>The dummy overall temperature factor is in no way related to the overall
temperature factor, and its use is explained in the input of LIST 12,
which comes in the section of the user guide on ‘structure factors’.</p>
</div></blockquote>
<p><em>OU[ISO]</em></p>
<blockquote>
<div><p>This parameter is the overall isotropic temperature factor and has a default
value of 0.05.</p>
</div></blockquote>
<p><em>POLARITY</em></p>
<blockquote>
<div><p>This is the Rogers <em>eta</em> parameter, and  is a  multiplier for the
imaginary part of the anomalous
scattering factor.
Setting the value to 1.0 (its default) has the effect of using the
imaginary part
of the anomalous scattering factor as given.
Changing the value to
-1.0 has the effect of changing the hand of the model. Setting the value
at zero has the effect of removing the contribution of f”. However, if
contributions from f” are not required, IT IS MORE EFFICIENT to set ANOMALOUS
= NO in LIST 23 (structure factor control, see section <a class="reference internal" href="sfls.html#list23"><span class="std std-ref">Structure factor calculation control list  -  LIST 23</span></a>). If you
need to use f”, remember not to
apply Friedel’s law (LIST 13, section <a class="reference internal" href="initial.html#list13"><span class="std std-ref">Input of the crystal and data collection details  -  LIST 13</span></a>) during data reduction
(section <a class="reference internal" href="reflectiondata.html#datareduc"><span class="std std-ref">Data Reduction - Lp</span></a>),
and to include anomalous scattering (LIST 3, section <a class="reference internal" href="initial.html#list03"><span class="std std-ref">Input of the atomic scattering factors  -  \LIST 3</span></a> and
LIST 23, section <a class="reference internal" href="sfls.html#list23"><span class="std std-ref">Structure factor calculation control list  -  LIST 23</span></a>). See D. Rogers, Acta Cryst (1981),
A37,734-741. <em>POLARITY</em>
<em>and</em> <em>ENANTIO</em> <em>should</em> <em>not</em> <em>be</em> <em>used</em> <em>simultaniously.</em></p>
</div></blockquote>
<p><em>ENANTIO</em></p>
<blockquote>
<div><p>This overall parameter is the fractional contribution of F(-h) to the observed
structure amplitude, and like the POLARITY parameter is sensitive to the
polarity of the structure. It is defined by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fo</span><span class="o">**</span><span class="mi">2</span> <span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">*</span> <span class="n">F</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<p>where x is the ENANTIOpole parameter. A value of 0.0 means the structure
stored in LIST 5 is of the correct hand. A value of 1.0 inverts the structure.
Its effect on the structure factor is switched on or off by the parameter
ENANTIO in LIST 23 (see section <a class="reference internal" href="sfls.html#list23"><span class="std std-ref">Structure factor calculation control list  -  LIST 23</span></a>). Computations are more efficient
when it is turned off.
If the enantiopole is used (or refined) then Friedel’s law must not be applied
(LIST 13, section <a class="reference internal" href="initial.html#list13"><span class="std std-ref">Input of the crystal and data collection details  -  LIST 13</span></a>) and anomaloue scattering must
be included (LIST 13 and LIST 23).
See Howard Flack, Acta Cryst, 1983, A39, 876-881. This parameter
is more robust than the POLARITY parameter.
See also section in Results.</p>
</div></blockquote>
<p><em>EXTPARAM</em></p>
<blockquote>
<div><p>This parameter is Larson’s extinction parameter , r*, (equation 22 in
A.C. Larson, Crystallographic Computing, 1970, 291-294, ed F.R.
Ahmed, Munksgaard, Copenhagen , but with V
replaced by the cell volume)
and has a default value of zero.</p>
<p>Note that many other programs use expression (4),
which cannot cope with Neutron data, and  gives a value for ‘g’
which is about 1,000,000 times smaller than ‘r*’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">~=</span> <span class="p">[(</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">mc</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">.</span> <span class="k">lambda</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">.</span> <span class="n">Tbar</span> <span class="p">]</span> <span class="o">.</span> <span class="n">r</span><span class="o">*</span>
</pre></div>
</div>
<p>Tbar is the absorption weighted mean path length, and is assumed to be
stored in
LIST 6 (section <a class="reference internal" href="reflectiondata.html#list06"><span class="std std-ref">Simple input of F or Fsq data - LIST 6</span></a>) with a key of  TBAR . If this key is
absent, a default value of 1.0
is used. If extinction is to be included in the model, the mosaic spread
should have been set in LIST 13 (section <a class="reference internal" href="initial.html#list13"><span class="std std-ref">Input of the crystal and data collection details  -  LIST 13</span></a>).</p>
</div></blockquote>
</section>
</section>
<section id="input-of-atoms-and-other-parameters-list-5">
<span id="list05"></span><span id="index-2"></span><span id="index-1"></span><h2>Input of atoms and other parameters  -  LIST 5<a class="headerlink" href="#input-of-atoms-and-other-parameters-list-5" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">LIST</span> <span class="mi">5</span>
<span class="n">OVERALL</span> <span class="n">SCALE</span><span class="o">=</span> <span class="n">DU</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span><span class="o">=</span> <span class="n">OU</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span><span class="o">=</span> <span class="n">POLARITY</span><span class="o">=</span> <span class="n">ENANTIO</span><span class="o">=</span> <span class="n">EXTPARAM</span><span class="o">=</span>
<span class="n">READ</span> <span class="n">NATOM</span><span class="o">=</span> <span class="n">NLAYER</span><span class="o">=</span> <span class="n">NELEMENT</span><span class="o">=</span> <span class="n">NBATCH</span><span class="o">=</span>
<span class="n">either</span> <span class="n">ATOM</span> <span class="n">TYPE</span><span class="o">=</span> <span class="n">SERIAL</span><span class="o">=</span> <span class="n">OCC</span><span class="o">=</span> <span class="n">FLAG</span><span class="o">=</span> <span class="n">X</span><span class="o">=</span> <span class="n">Y</span><span class="o">=</span> <span class="n">Z</span><span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">=</span> <span class="o">....</span><span class="n">U</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">=</span>
<span class="ow">or</span>     <span class="n">ATOM</span> <span class="n">TYPE</span><span class="o">=</span> <span class="n">SERIAL</span><span class="o">=</span> <span class="n">OCC</span><span class="o">=</span> <span class="n">FLAG</span><span class="o">=</span> <span class="n">X</span><span class="o">=</span> <span class="n">Y</span><span class="o">=</span> <span class="n">Z</span><span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>
<span class="n">INDEX</span> <span class="n">P</span><span class="o">=</span> <span class="n">Q</span><span class="o">=</span> <span class="n">R</span><span class="o">=</span> <span class="n">S</span><span class="o">=</span> <span class="n">ABSOLUTE</span><span class="o">=</span>
<span class="n">LAYERS</span> <span class="n">SCALE</span><span class="o">=</span>
<span class="n">ELEMENTS</span> <span class="n">SCALE</span><span class="o">=</span>
<span class="n">BATCH</span> <span class="n">SCALE</span><span class="o">=</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">LIST</span> <span class="mi">5</span>
<span class="n">OVERALL</span> <span class="n">SCALE</span><span class="o">=</span><span class="mf">0.123</span>
<span class="n">READ</span> <span class="n">NATOM</span><span class="o">=</span><span class="mi">2</span> <span class="n">NELEMENT</span><span class="o">=</span><span class="mi">2</span>
<span class="n">ATOM</span> <span class="n">PB</span> <span class="mi">1</span> <span class="n">FLAG</span><span class="o">=</span><span class="mi">0</span> <span class="mf">.25</span> <span class="mf">.25</span> <span class="mf">.25</span> <span class="mf">.03</span> <span class="mf">.03</span> <span class="mf">.03</span> <span class="mf">.0</span> <span class="mf">.0</span> <span class="mf">.0</span>
<span class="n">ATOM</span> <span class="n">C</span> <span class="mi">2</span>  <span class="n">X</span><span class="o">=</span> <span class="mf">.23</span> <span class="mf">.13</span> <span class="mf">.67</span>
<span class="n">ELEMENTS</span> <span class="mf">0.8</span> <span class="mf">0.2</span>
<span class="n">END</span>
</pre></div>
</div>
<section id="list-5">
<h3>\LIST 5<a class="headerlink" href="#list-5" title="Link to this heading"></a></h3>
<p><strong>OVERALL SCALE= DU[ISO]= OU[ISO]= POLARITY= ENANTIO= EXTPARAM=</strong></p>
<blockquote>
<div><p>This directive specifies various parameters that refer to the
structure as a whole.</p>
</div></blockquote>
<p><em>SCALE=</em></p>
<blockquote>
<div><p>The overall scale factor, default = 1.0</p>
</div></blockquote>
<p><em>DU[ISO]=</em></p>
<blockquote>
<div><p>The dummy overall isotropic temperature factor, default = 0.05.</p>
</div></blockquote>
<p><em>OU[ISO]=</em></p>
<blockquote>
<div><p>The overall isotropic temperature factor, default = 0.05.</p>
</div></blockquote>
<p><em>POLARITY=</em></p>
<blockquote>
<div><p>Rogers <em>eta</em> parameter (see above), default = 1.0.</p>
</div></blockquote>
<p><em>ENANTIO=</em></p>
<blockquote>
<div><p>Flack enantiopole parameter (see above), default = 0.0.</p>
</div></blockquote>
<p><em>EXTPARAM=</em></p>
<blockquote>
<div><p>Larson r* secondary extincion parameter, default = 0.0.</p>
</div></blockquote>
<p><strong>READ NATOM= NLAYER= NELEMENT= NBATCH=</strong></p>
<blockquote>
<div><p>This directive specifies the number of atoms, layer scale factors,
element scale factors, and batch scale factors that are to follow.</p>
</div></blockquote>
<p><em>NATOM=</em></p>
<blockquote>
<div><p>The number of atom directives to follow, default = 0.</p>
</div></blockquote>
<p><em>NLAYER=</em></p>
<blockquote>
<div><p>The number of layer scale factors to follow, default = 0.</p>
</div></blockquote>
<p><em>NELEMENT=</em></p>
<blockquote>
<div><p>The number of element scale factors to follow, default = 0.</p>
</div></blockquote>
<p><em>NBATCH=</em></p>
<blockquote>
<div><p>The number of batch scale factors to follow, default = 0.</p>
</div></blockquote>
<p><strong>ATOM TYPE= SERIAL= OCC= FLAG= X= Y= Z= U[11]= ..</strong></p>
<blockquote>
<div><p>The parameters for an atom, repeated NATOM times.</p>
</div></blockquote>
<p><em>TYPE=</em></p>
<blockquote>
<div><p>The atomic species, an entry for which should exist
in LIST 3 (see section <a class="reference internal" href="initial.html#list03"><span class="std std-ref">Input of the atomic scattering factors  -  \LIST 3</span></a>). There is no default value.</p>
</div></blockquote>
<p><em>SERIAL=</em></p>
<blockquote>
<div><p>The atoms serial number. There is no default value.</p>
</div></blockquote>
<p><em>OCC=</em></p>
<blockquote>
<div><p>This parameter defines the site occupancy <strong>EXCLUDING</strong> special position
effects (i.e. is the ‘chemical occupancy). The default is 1.0.
Special position  effects are computed by CRYSTALS and multiplied onto
this parameter.</p>
</div></blockquote>
<p><em>FLAG=</em></p>
<blockquote>
<div><p>This parameter specifies the type of temperature factor for the atom,
and if it is omitted a default value of 1 is assumed. <strong>NOTE</strong> that it
<strong>must</strong> be set to 0 for anisotropic atoms.</p>
</div></blockquote>
<p><em>X= Y= Z=</em></p>
<blockquote>
<div><p>These parameters specify the atomic coordinates for the atom, for which
there are no default values.</p>
</div></blockquote>
<p><em>U[11]= U[22]= U[33]= U[23]= U[13]= U[12]=</em></p>
<blockquote>
<div><p>These parameters have different interpretations depending upon the
value of FLAG</p>
<p>If FLAG=0</p>
<p>These parameters specify the anisotropic temperature factors for the atom
and if they are omitted default values of zero are assumed.
The order of the
cross terms is obtained by dropping 1,2,3 sequentially from [123].</p>
<p>If FLAG=1</p>
<p>The first parameter specifies the isotropic temperature factor, which
defaults to 0.05.</p>
<p>If FLAG=2,3 or 4, the six parameters represented by u[ij] have the
following imterpretation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KEY</span>   <span class="n">shape</span>      <span class="n">parameters</span>

 <span class="mi">2</span>    <span class="n">Sphere</span>     <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">SIZE</span>
 <span class="mi">3</span>    <span class="n">Line</span>       <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">SIZE</span>  <span class="n">DECLINAT</span> <span class="n">AZIMUTH</span>
 <span class="mi">4</span>    <span class="n">Ring</span>       <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">SIZE</span>  <span class="n">DECLINAT</span> <span class="n">AZIMUTH</span>
</pre></div>
</div>
<p>The parameters have the following meaning for the new special shapes:</p>
</div></blockquote>
<p><em>Special U[iso]</em></p>
<blockquote>
<div><p>U[iso] is related to the ‘thickness’ of the line, annulus or shell.</p>
</div></blockquote>
<p><strong>Special SIZE</strong></p>
<blockquote>
<div><p>SIZE is the length of the line, or the radius of the annulus or shell.</p>
</div></blockquote>
<p><em>Special DECLINAT</em></p>
<blockquote>
<div><p>DECLINAT is the declination angle between the line axis or annulus normal and the
<em>z</em>
axis of the usual CRYSTALS orthogonal coordinate system, in
degrees/100.</p>
</div></blockquote>
<p><em>Special AZIMUTH</em></p>
<blockquote>
<div><p>AZIMUTH is the azimuthal angle between the projection of the
line axis or annulus normal onto the <em>x</em> - <em>y</em> plane and the <em>x</em>
axis of the usual CRYSTALS orthogonal coordinate system, in
degrees/100.</p>
<p>If either of these angles is input with a value greater than 5.0, it
is assumed that the user has forgotten to divide by 100, which is thus
done automatically.</p>
</div></blockquote>
<p><strong>INDEX P= Q= R= S= ABSOLUTE=</strong></p>
<blockquote>
<div><p>This directive is used to input the constants that define an index
for layer scaling. The layer scale index for the reflection with indices
HKL  is computed from</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="n">l</span><span class="o">*</span><span class="n">r</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>and the absolute value is taken if the parameter  ABSOLUTE  = yes.</p>
</div></blockquote>
<p><em>P= Q= R=</em></p>
<blockquote>
<div><p>These parameters have default values of zero.</p>
</div></blockquote>
<p><em>S=</em></p>
<blockquote>
<div><p>This parameter has a default value of unity. The zeroth layer must have
an index of 1.</p>
</div></blockquote>
<p><em>ABSOLUTE=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NO</span>
<span class="n">YES</span>  <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>LAYERS SCALE=</strong></p>
<blockquote>
<div><p>This directive defines the layer scale factors, starting with the scale
for an index of 1.</p>
</div></blockquote>
<p><em>SCALE=</em></p>
<blockquote>
<div><p>This parameter gives the layer scale, and has a default value of 1.
It is repeated  NLAYER  times.</p>
</div></blockquote>
<p><strong>ELEMENTS SCALE=</strong></p>
<blockquote>
<div><p>This directive defines the scale factors for the elements of a twinned
structure. See the chapter on twinned structures.</p>
</div></blockquote>
<p><em>SCALE=</em></p>
<blockquote>
<div><p>This parameter gives the element scale factor, and has a default value
of 1. It is repeated  NELEMENT  times - the number of components
in the twin.</p>
</div></blockquote>
<p><strong>BATCH SCALE=</strong></p>
<blockquote>
<div><p>This directive defines the batch scale factors.</p>
</div></blockquote>
<p><em>SCALE=</em></p>
<blockquote>
<div><p>This parameter gives the batch scale factor, and has a default value of 1.
It is repeated  NBATCH  times. Remember to set appropriate keys in LIST
6</p>
</div></blockquote>
</section>
<section id="further-examples-of-parameter-input">
<h3>Further examples of parameter input<a class="headerlink" href="#further-examples-of-parameter-input" title="Link to this heading"></a></h3>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATOM</span> <span class="n">TYPE</span><span class="o">=</span><span class="n">C</span><span class="p">,</span><span class="n">SERIAL</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">OCC</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">X</span><span class="o">=</span><span class="mf">0.027</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="mf">0.384</span><span class="p">,</span><span class="n">Z</span><span class="o">=</span><span class="mf">0.725</span><span class="p">,</span>
<span class="n">CONT</span> <span class="n">U</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">=</span><span class="mf">0.075</span><span class="p">,</span><span class="n">U</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span><span class="o">=</span><span class="mf">0.048</span><span class="p">,</span><span class="n">U</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span><span class="o">=</span><span class="mf">.069</span>
<span class="n">CONT</span> <span class="n">U</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span><span class="o">=-</span><span class="mf">.007</span><span class="p">,</span><span class="n">U</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">=</span><span class="mf">.043</span><span class="p">,</span><span class="n">U</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">=-</span><span class="mf">.001</span>
<span class="n">ATOM</span> <span class="n">C</span> <span class="mi">5</span> <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span> <span class="mf">.108</span><span class="p">,</span><span class="mf">.365</span><span class="p">,</span><span class="mf">.815</span><span class="p">,</span><span class="mf">.074</span>
<span class="n">CONT</span> <span class="mf">.051</span> <span class="mf">.065</span> <span class="o">-</span><span class="mf">.015</span> <span class="mf">.048</span> <span class="o">-</span><span class="mf">.014</span>
<span class="n">ATOM</span> <span class="n">C</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mf">0.05</span> <span class="mf">0.149</span> <span class="mf">0.411</span> <span class="mf">0.651</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">ATOM</span> <span class="n">C</span> <span class="mi">1</span> <span class="n">X</span><span class="o">=</span><span class="mf">0.094</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="mf">0.343</span><span class="p">,</span><span class="n">Z</span><span class="o">=</span><span class="mf">0.890</span>
<span class="n">ATOM</span> <span class="n">C</span> <span class="mi">3</span> <span class="n">X</span><span class="o">=</span><span class="mf">0.050</span> <span class="mf">0.406</span> <span class="mf">0.648</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="printing-and-punching-list-5">
<h2>Printing and punching list 5<a class="headerlink" href="#printing-and-punching-list-5" title="Link to this heading"></a></h2>
<section id="print-5">
<h3>\PRINT 5<a class="headerlink" href="#print-5" title="Link to this heading"></a></h3>
<blockquote>
<div><p>Lists the current LIST 5 to the printer file.</p>
</div></blockquote>
</section>
<section id="punch-5-mode">
<h3>\PUNCH 5 mode<a class="headerlink" href="#punch-5-mode" title="Link to this heading"></a></h3>
<blockquote>
<div><p>Mode controls the format of the file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">-</span>  <span class="n">Punches</span> <span class="n">the</span> <span class="n">model</span> <span class="n">parameters</span> <span class="ow">in</span> <span class="n">CRYSTALS</span> <span class="nb">format</span><span class="o">.</span>
<span class="n">A</span> <span class="o">-</span>  <span class="n">Punches</span> <span class="n">the</span> <span class="n">model</span> <span class="n">parameters</span> <span class="ow">in</span> <span class="n">CRYSTALS</span> <span class="nb">format</span><span class="o">.</span>
<span class="n">B</span> <span class="o">-</span>  <span class="n">Punches</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">parameters</span> <span class="ow">in</span> <span class="n">XRAY</span> <span class="nb">format</span><span class="o">.</span>
<span class="n">C</span> <span class="o">-</span>  <span class="n">Punches</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">parameters</span> <span class="ow">in</span> <span class="n">SHELX</span> <span class="nb">format</span><span class="o">.</span>
<span class="n">E</span> <span class="o">-</span>  <span class="n">Punches</span> <span class="n">atomic</span> <span class="n">parameters</span> <span class="ow">and</span> <span class="n">esds</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">plain</span> <span class="nb">format</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="summary-display-of-list-5-display">
<h3>Summary display of LIST 5 - \DISPLAY<a class="headerlink" href="#summary-display-of-list-5-display" title="Link to this heading"></a></h3>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">DISPLAY</span> <span class="n">LEVEL</span><span class="o">=</span>
<span class="n">END</span>

\<span class="n">DISP</span> <span class="n">HIGH</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This allows the user to display a summary of the contents
of list 5.  The  output is sent to both monitor and listing channels, so
the contents of list 5 can be examined on-line during interactive work.
The output produced is more compact than that from PRINT 5, and various
levels of detail can be selected.
The command required is :-</p>
</div></blockquote>
</section>
<section id="display-level">
<h3>\DISPLAY    LEVEL=<a class="headerlink" href="#display-level" title="Link to this heading"></a></h3>
<blockquote>
<div><p>DISPLAY has one  optional  parameter.</p>
</div></blockquote>
<p><em>LEVEL</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOW</span>
<span class="n">MEDIUM</span>
<span class="n">HIGH</span>
</pre></div>
</div>
<p>The effects of this parameter are :-</p>
<p>LOW            The names of the atoms, overall parameters,
and any layer, batch, and element scales in list 5 are displayed.</p>
<p>MEDIUM         Each atom in list 5 is displayed with its type, serial,
occupancy, isotropic temperature factor ( if any ), and positional parameters.
The values of the overall parameters and of any layer, batch, and element
scales are displayed.</p>
<p>HIGH           All of the parameters of each atom in list 5 are
displayed. The values of the overall parameters, and of any layer, batch,
and element scale factors are displayed.</p>
</div></blockquote>
</section>
</section>
<section id="editing-structural-parameters-edit">
<span id="index-4"></span><span id="index-3"></span><h2>Editing structural parameters -  \EDIT<a class="headerlink" href="#editing-structural-parameters-edit" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> \<span class="n">EDIT</span> <span class="n">INPUTLIST</span><span class="o">=</span> <span class="n">OUTPUTLIST</span><span class="o">=</span>

 <span class="n">EXECUTE</span>
 <span class="n">SAVE</span>
 <span class="n">QUIT</span>
 <span class="n">LIST</span> <span class="n">LEVEL</span>
 <span class="n">MONITOR</span> <span class="n">LEVEL</span>
 <span class="n">END</span>

 <span class="n">ADD</span>  <span class="n">VALUE</span> <span class="n">PARAMETERS</span>  <span class="o">...</span>
 <span class="n">AFTER</span>  <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span>
 <span class="n">ANISO</span>  <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATIONS</span>  <span class="o">.</span>  <span class="o">.</span>
 <span class="n">ATOM</span> <span class="n">TYPE</span><span class="o">=</span> <span class="n">SERIAL</span><span class="o">=</span> <span class="n">OCC</span><span class="o">=</span> <span class="n">FLAG</span><span class="o">=</span> <span class="n">X</span><span class="o">=</span> <span class="n">Y</span><span class="o">=</span> <span class="n">Z</span><span class="o">=</span> <span class="n">U11</span><span class="o">=</span> <span class="o">..</span>
 <span class="n">CENTROID</span> <span class="n">Z</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span> <span class="o">...</span>
 <span class="n">CHANGE</span>  <span class="n">PARAMETER</span><span class="o">-</span><span class="n">SPECIFICATION</span> <span class="n">VALUE</span> <span class="o">...</span>
 <span class="n">COPYXYZ</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">PAIRS</span>
 <span class="n">COPYUIJ</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">PAIRS</span>
 <span class="n">CREATE</span> <span class="n">Z</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span>  <span class="o">...</span>
 <span class="n">DELETE</span>  <span class="n">ATOM</span> <span class="n">SPECIFICATIONS</span>  <span class="o">.</span>  <span class="o">.</span>
 <span class="n">DEORTHOGINAL</span>  <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span> <span class="o">.</span> <span class="o">.</span>
 <span class="n">DIVIDE</span>  <span class="n">VALUE</span>  <span class="n">PARAMETERS</span>  <span class="o">...</span>
 <span class="n">DSORT</span> <span class="n">TYPE1</span> <span class="n">TYPE2</span> <span class="o">...</span>
 <span class="n">INSERT</span> <span class="n">IDENTIFIER</span>
 <span class="n">KEEP</span>  <span class="n">Z</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATIONS</span> <span class="o">...</span>
 <span class="n">MOVE</span> <span class="n">Z</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span>  <span class="o">...</span>
 <span class="n">MULTIPLY</span>  <span class="n">VALUE</span>  <span class="n">PARAMETERS</span>  <span class="o">...</span>
 <span class="n">PERTURB</span> <span class="n">VALUE</span> <span class="n">PARAMETERS</span> <span class="o">...</span>
 <span class="n">REFORMAT</span>
 <span class="n">RENAME</span> <span class="n">ATOM1</span>  <span class="n">ATOM2</span>  <span class="p">(,</span> <span class="n">ATOM1</span>  <span class="n">ATOM2</span><span class="p">)</span> <span class="o">...</span>
 <span class="n">RESET</span> <span class="n">PARAMETER</span><span class="o">-</span><span class="n">NAME</span> <span class="n">VALUE</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">NAMES</span>
 <span class="n">ROTATE</span> <span class="n">ANGLE</span> <span class="n">ATOM</span> <span class="n">VECTOR</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span>
 <span class="n">ROTATE</span> <span class="n">ANGLE</span> <span class="n">ATOM1</span> <span class="n">ATOM2</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span>
 <span class="n">ROTATE</span> <span class="n">ANGLE</span> <span class="n">POINT</span> <span class="n">VECTOR</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span>
 <span class="n">SELECT</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">PARAMETER</span>  <span class="n">OPERATOR</span>  <span class="n">VALUE</span><span class="p">,</span> <span class="o">.</span> <span class="o">.</span>
 <span class="n">SHIFT</span>  <span class="n">V1</span><span class="p">,</span> <span class="n">V2</span><span class="p">,</span> <span class="n">V3</span>   <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span> <span class="o">.</span> <span class="o">.</span>
 <span class="n">SORT</span> <span class="n">KEYWORD</span>
 <span class="n">SORT</span> <span class="n">TYPE1</span> <span class="n">TYPE2</span> <span class="o">...</span>
  <span class="n">SPLIT</span> <span class="n">Z</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span> <span class="o">...</span>
 <span class="n">SUBTRACT</span>  <span class="n">VALUE</span>  <span class="n">PARAMETERS</span>  <span class="o">...</span>
 <span class="n">SWAP</span> <span class="n">ATOM</span><span class="o">-</span><span class="n">PAIRS</span>
 <span class="n">TRANSFORM</span>  <span class="n">R11</span><span class="p">,</span> <span class="n">R21</span><span class="p">,</span> <span class="n">R31</span><span class="p">,</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">R33</span>  <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span> <span class="o">.</span> <span class="o">.</span>
 <span class="n">TYPECHANGE</span> <span class="n">KEYWORD</span> <span class="n">OPERATOR</span> <span class="n">VALUE</span> <span class="n">NEW</span><span class="o">-</span><span class="n">ATOM</span><span class="o">-</span><span class="n">TYPE</span>
 <span class="n">UEQUIV</span>  <span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATIONS</span>  <span class="o">.</span>  <span class="o">.</span>

 <span class="n">LINE</span> <span class="n">NEWSERIAL</span> <span class="n">ATOMLIST</span>
 <span class="n">RING</span> <span class="n">NEWSERIAL</span> <span class="n">ATOMLIST</span>
<span class="n">SPHERE</span> <span class="n">NEWSERIAL</span> <span class="n">ATOMLIST</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LIST</span> <span class="n">LOW</span>
<span class="n">TYPECHANGE</span> <span class="n">TYPE</span> <span class="n">EQ</span> <span class="n">Q</span> <span class="n">C</span>
<span class="n">SELECT</span> <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">LT</span> <span class="mf">0.1</span>
<span class="n">ADD</span>  <span class="mf">0.25</span> <span class="n">X</span>
<span class="n">RENAME</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">CHANGE</span>  <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">OCC</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="mf">.5</span>
<span class="n">KEEP</span>  <span class="mi">1</span> <span class="n">FIRST</span> <span class="n">UNTIL</span> <span class="n">LAST</span>
<span class="n">L</span> <span class="n">L</span>
<span class="n">SPLIT</span> <span class="mi">100</span> <span class="n">C</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
<span class="n">DELETE</span>  <span class="n">C</span><span class="p">(</span><span class="mi">46</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">LAST</span>
<span class="n">RESET</span> <span class="n">OCC</span> <span class="mf">1.0</span> <span class="n">ALL</span>
</pre></div>
</div>
<p>This is a powerful crystallographic editor for
modifying a LIST 5 (the model parameters) or LIST 10 (Fourier peaks).
It offers the editing facilities frequently needed
for the management of atom parameters, including conditional operations
and arithmetic.</p>
<p>EDIT is a semi-interactive command, in that each directive is
computed as soon as its input is complete. Since CONTINUE can be used
to extend a directive over several lines, completion is indicated be
the start of a new directive, or the special directive EXECUTE.</p>
<p>After the terminating END, the resulting list is
output to the disc.
However if the list has not been changed, a new list will be created only
if the list type is being changed ( e.g. 10 to 5 ).
The current edited version of the list can be saved at
any time to protect against future editing mistakes ( the SAVE directive ).
It is also possible to abandon editing without creating a new list ( the QUIT
directive ).</p>
<p>When used in interactive mode, a new list is created even though errors may
have occured during command input unless the QUIT directive is used. In
online and batch modes no new list will be created if errors occured
during the edit. In this case an error message in generated.</p>
<p>Take care to note that some directives refer to atom or group of atoms,
others refer to one or more parameters, and two
(CHANGE  and  SELECT)will refer to either an atom specification
or a parameter specification.
Although atom definitions can include a series of symmetry operators,
the only directives that will use them are those
for which the subsequent description explicitly states that the
symmetry operators are used.
In all other cases, the symmetry information will be read in without any
error messages and ignored.
Those operations which require a single parameter type as argument
(ADD,  MULTIPLY  etc ) will fail if composite parameters ( “U’S”, etc )
are given.</p>
<section id="edit-inputlist-outputlist">
<h3>\EDIT INPUTLIST OUTPUTLIST<a class="headerlink" href="#edit-inputlist-outputlist" title="Link to this heading"></a></h3>
<p><em>INPUTLIST</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>OUTPUTLIST</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>EXECUTE</strong></p>
<blockquote>
<div><p>This directive which has no parameters does nothing to the edited list. It
is provided to allow the user to see the results of one operation (
initiated by the directive whose input is terminated by EXECUTE ) before
attempting the next.</p>
</div></blockquote>
<p><strong>SAVE</strong></p>
<blockquote>
<div><p>Forces the current atom list to be writen to disk.</p>
</div></blockquote>
<p><strong>QUIT</strong></p>
<blockquote>
<div><p>This directive will cause the edit to be abandoned without the creation
of a new list if it is followed by
END . If it is followed by any other directive it is ignored.</p>
</div></blockquote>
<p><strong>LIST LEVEL</strong></p>
<blockquote>
<div><p>This directive produces a list of the current edited list in the monitor
output stream and in the listing file. If KEEP has been used, the atoms
which will be kept are indicated.
The possible values for ‘level’ are :-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OFF</span>               <span class="n">No</span> <span class="n">listing</span> <span class="n">produced</span>
<span class="n">LOW</span>               <span class="n">Type</span> <span class="ow">and</span> <span class="n">serial</span> <span class="n">listed</span>
<span class="n">MEDIUM</span>            <span class="n">Type</span> <span class="p">,</span> <span class="n">serial</span> <span class="p">,</span> <span class="n">occ</span> <span class="p">,</span> <span class="n">u</span><span class="p">[</span><span class="n">iso</span><span class="p">]</span> <span class="p">,</span>
                  <span class="n">x</span> <span class="p">,</span> <span class="n">y</span> <span class="p">,</span> <span class="n">z</span> <span class="n">listed</span>
<span class="n">HIGH</span>              <span class="n">All</span> <span class="n">atomic</span> <span class="n">parameters</span> <span class="n">listed</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>MONITOR LEVEL</strong></p>
<blockquote>
<div><p>This directive controls the level of monitoring of editing operations. When
each operation is performed, the results can be monitored in the monitor
channel and in the listing file. Four levels of monitoring are provided. The
inital level and the default level used when no value is specified is
‘MEDIUM’. The possible values of the parameter ‘level’ are :-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OFF</span>          <span class="n">No</span> <span class="n">monitoring</span> <span class="n">occurs</span>
<span class="n">LOW</span>          <span class="n">Type</span> <span class="ow">and</span> <span class="n">serial</span> <span class="n">only</span> <span class="n">are</span> <span class="n">displayed</span>
<span class="n">MEDIUM</span>       <span class="n">Program</span> <span class="n">selects</span> <span class="n">level</span> <span class="n">of</span> <span class="n">display</span>   <span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="n">HIGH</span>         <span class="n">At</span> <span class="n">least</span> <span class="n">the</span> <span class="n">level</span> <span class="n">represented</span> <span class="n">by</span>
             <span class="s1">&#39;MEDIUM&#39;</span> <span class="n">listing</span> <span class="ow">is</span> <span class="n">displayed</span>
</pre></div>
</div>
<p>When the program selects a monitor level account is taken of the
amount of relevant information for the particular directive. Thus for
DELETE only ‘type’ and ‘serial’ need be displayed whereas for CHANGE
all parameter values are displayed.</p>
</div></blockquote>
<p><strong>END</strong></p>
<blockquote>
<div><p>This must be the last directive in the set of modification directives,
and writed the list to disk.</p>
</div></blockquote>
<p><strong>ADD  VALUE  PARAMETERS  …</strong></p>
<p><strong>AFTER  ATOM-SPECIFICATION  …</strong></p>
<blockquote>
<div><p>This defines the atom in the list after which atoms
that are  MOVEd  should be placed.
(See  MOVE  below).
If this directive is omitted, the default option places the first  MOVED
atom at the head of the list, and successive atoms after it.
Once one  AFTER  directive has been given, atoms are placed behind the
given atom in the order in which they are presented on  MOVE  directives.
If no atom specification is given on this directive, subsequent MOVEs will move
the atoms  to the  head of the list.</p>
</div></blockquote>
<p><strong>ANISO  ATOM SPECIFICATIONS  .  .</strong></p>
<blockquote>
<div><p>This directive causes all the specified atoms to be converted so that they
have anisotropic temperature factors.
If an atom is already anisotropic, no action is taken, and any symmetry
operators given are ignored.
If this directive is given with no arguments, all the atoms in the current
atomic parameter list are converted to anisotropic temperature factors.</p>
<p>Note that   the anisotropic temperature factor produced by this operation
is in fact still spherically symmetrical, and
that the s.f.l.s.
routines automatically ensure that when the temperature factor of an atom
is to be  refined, it is in the correct form.</p>
</div></blockquote>
<p><strong>ATOM TYPE SERIAL OCC FLAG X Y Z U11 ..</strong></p>
<blockquote>
<div><p>This directive causes the system to add an atom to the
end of the edited list. The format is the same as that used in \LIST 5 (see
section <a class="reference internal" href="#list05"><span class="std std-ref">Input of atoms and other parameters  -  LIST 5</span></a>).
Values must be provided for ‘type’ , ‘serial’ , ‘x’ , ‘y’ , and ‘z’ .
Default values are provided for the other parameters as in \LIST 5.
Example :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATOM</span> <span class="n">O</span> <span class="mi">1</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">0.3427</span> <span class="mf">.89004</span> <span class="mf">.09181</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>CENTROID Z ATOM-SPECIFICATION …</strong></p>
<blockquote>
<div><p>A new atom is created at the centroid of the specified atoms, and with
a pseudo adp representing the inertial tensor (ie the ‘shape’ of the
group). The atom TYPE is QC, and its serial Z.
The sequence Z ATOM-SPECIFICATIONS can be repeated.</p>
</div></blockquote>
<p><strong>CHANGE  ARG(1)  ARG(2)  ARG(3)  .</strong></p>
<blockquote>
<div><p>There are two possible formats for each ‘ARG(i)’ on this directive.
the first is :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PARAMETER</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="n">VALUE</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>If  ARG(i)  is of this form, the specified parameter or parameters
are changed to the value  VALUE(i) .
If  PARAMETER(i)  defines one or more atomic parameters, then the
symmetry operators found or inserted by default
are applied to the resulting set of atomic parameters.
For overall parameters,
no symmetry information can be provided.
The  VALUE  associated with this argument must always be present.</p>
<p>The second form of  ARG(i)  on this directive is :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ATOM</span><span class="o">-</span><span class="n">SPECIFICATION</span>
</pre></div>
</div>
<p>For this form of  ARG(i) , the symmetry operators given in the
atom specification or assumed by default are applied, but no
other atomic parameter is explicitly altered.
There is no  VALUE  associated with  ARG(i)  in this format.</p>
<p>The two different types of argument on this directive may be used
interchangeably :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CHANGE</span>  <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">OCC</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="mf">.5</span>
<span class="n">CONT</span>    <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">C</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">CONT</span>    <span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="n">X</span><span class="p">)</span> <span class="mf">.0179</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>COPYXYZ  ATOM-PAIRS  …</strong></p>
<blockquote>
<div><p>This directive COPIES the XYZ coordinates of the first atom into
the second atom.  The other parameters are left  unchanged.</p>
</div></blockquote>
<p><strong>COPYUIJ  ATOM-PAIRS  …</strong></p>
<blockquote>
<div><p>This directive COPIES the Uij coordinates of the first atom into
the second atom.    The other parameters are left  unchanged.</p>
</div></blockquote>
<p><strong>CREATE Z ATOM-SPECIFICATION  …</strong></p>
<blockquote>
<div><p>This directive applies the symmetry operators given or assumed by default
in the atom specification, and creates a set of new atoms from those given.
The new atoms are added at the end of the current list. The serial numbers
of the new atoms are given by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NEWSERIAL</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">+</span> <span class="n">OLDSERIAL</span>
</pre></div>
</div>
<p>The sequence Z ATOM-SPECIFICATIONS can be repeated.
When moving from a centrosymmetric to a non-centrosymmetric space group,
for example, atoms formerly related by the centre of symmetry can be
generated :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="mi">30</span> <span class="n">MO</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">C</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

<span class="n">Creates</span> <span class="n">atoms</span> <span class="n">MO</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="n">until</span> <span class="n">C</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>DELETE  ATOM SPECIFICATIONS  .  .</strong></p>
<blockquote>
<div><p>All the specified atoms are removed
from the current atomic parameter list.
Deleted atoms should not be referenced by subsequent directives.</p>
</div></blockquote>
<p><strong>DEORTHOGINAL  ATOM SPECIFICATION . .</strong></p>
<blockquote>
<div><p>This directive applies the matrix vector saved by a previous MOLAX SAVE
directive to the atoms given  in the atom specification. THEIR ORIGINAL
COORDIANATES x,y,z MUST be in the MOLAX coordinate (Angstrom) system
This directive does not create new atoms, but simply modifies
those already present. Symmetry operators are not permitted.</p>
</div></blockquote>
<p><strong>DIVIDE  VALUE  PARAMETERS  …</strong></p>
<blockquote>
<div><p>These directives causes the ‘value’ to be applied to the parameter.
‘PARAMETER(I)’ may be an overall parameter, or a single atomic
parameter of one  or more atoms, as defined above.
Any symmetry operators given with this directive will be ignored.
Note that the parameter SERIAL is numeric, and so can be arithmetically
modified.</p>
</div></blockquote>
<p><strong>DRENAME ATOM1 ATOM2</strong></p>
<blockquote>
<div><p>Used by SCRIPTS to avoid name clashes.</p>
</div></blockquote>
<p><strong>DSORT TYPE1 TYPE2 …</strong></p>
<p><strong>DSORT KEYWORD</strong></p>
<blockquote>
<div><p>This directive is exactly analagous to SORT, below, except that it sorts
into descending order.</p>
</div></blockquote>
<p><strong>INSERT IDENTIFIER=NAME</strong></p>
<blockquote>
<div><p>This directive inserts the value of the named identifier into the
parameter ‘SPARE’ in the atom list, replacing any previous value
(except ‘RESIDUE’ which uses the ‘RESIDUE’ paramter in the atom list).
SPARE is normally used to hold rho after Fourier maps.</p>
<p>Currently available values for NAME are</p>
<p>ELECTRON - This inserts the atomic electron count calculated
from the form factor</p>
<p>WEIGHT - This inserts the atomic weight from LIST 29 (see section <a class="reference internal" href="initial.html#list29"><span class="std std-ref">Input of the contents of the asymmetric unit  -  LIST 29</span></a>).</p>
<p>RESIDUE - This inserts a residue number into the ‘RESIDUE’ slot
of list 5 replacing any previous value, such that all connected atoms
have the same residue number and each molecule has a different residue number.</p>
<p>NCONN - This inserts the number of atoms connected to an atom, using
the list of bonds.</p>
<p>RELAX - This inserts an ID, based upon the bonding topology and atomic
types of the atoms. Atoms at topologically identical positions will be given
the same ID. (e.g. the terminal F’s in a CF3 group).</p>
</div></blockquote>
<p><strong>KEEP  Z ATOM-SPECIFICATIONS …</strong></p>
<blockquote>
<div><p>Only the atoms referenced in this directive will be kept in the list,
all the others will be lost, even though they can be referenced
right up until the final END.
The sequence Z ATOM-SPECIFICATIONS can be repeated.</p>
<p>Atoms that are  KEPT  are moved to the top of the list, and stored in the
order in which they are specified on  the KEEP  directive. Only one KEEP
directive may be given. Use CONTINUE if one line isn’t long enough for the
atom sequence.</p>
<p>The atom specifications may contain symmetry operators, which are used
to generate the coordinates of the atoms that are to be retained.
‘Z’ Is an optional parameter which defines the serial number
of the first atom in the specification immediately following it.
For each atom thereafter in the current atom specification, the serial
number is incremented by one to generate the output
serial number.
Atoms whose serial numbers are changed in this way must be referred to
in subsequent directives by their new serial numbers.
If ‘Z’ is not given, the atoms retain
their old serial numbers.</p>
<p>If an  UNTIL  sequence is used after a  KEEP  directive has
been given, it should be used with care, since the order of the new
parameter list is different from the input list.</p>
</div></blockquote>
<p><strong>MOVE Z ATOM-SPECIFICATION  …</strong></p>
<blockquote>
<div><p>This directive moves atoms about in the list and places them
in the position defined by the latest  AFTER  directive.
(See the previous directive).
This directive does not remove atoms from the list, but simply
reorders the list.
The sequence Z ATOM-SPECIFICATIONS can be repeated.</p>
<p>The atom specifications may contain symmetry operators, which are used
to generate the coordinates of the atoms that are to be moved.
‘Z’  is an optional parameter which defines the serial number
of the first atom in the specification immediately following it.
For each atom thereafter in the current atom specification, the serial
number is incremented by one to generate the output
serial number.
Atoms whose serial numbers are changed in this way must be referred to
in subsequent directives by their new serial numbers.
If no  ‘Z’ is given, the atoms retain
their old serial numbers.</p>
<p>If an  UNTIL  sequence is used after one or more  MOVE  directives have
been given, it should be used with care, since the order of the new
parameter list is different from the input list.</p>
</div></blockquote>
<p><strong>MULTIPLY  VALUE  PARAMETERS  …</strong></p>
<p><strong>PERTURB VALUE PARAMETERS …</strong></p>
<blockquote>
<div><p>This directive perturbs the specified parameters using a rnadom
number generator. The VALUE is the requested rms perturbation, in the
natural units of the parameters. The mean deviation applied should be
approximately zero, and the rms deviation applied should be
approximately that requested.</p>
</div></blockquote>
<p><strong>REFORMAT</strong></p>
<blockquote>
<div><p>This directive converts an old (non-FLAG) version of LIST 5 (see
section <a class="reference internal" href="#list05"><span class="std std-ref">Input of atoms and other parameters  -  LIST 5</span></a>) to the new format (extra parameters, old U[iso]
slot now used as a flag and u[11] used for u[iso]).</p>
</div></blockquote>
<p><strong>RENAME ATOM1  ATOM2  (, ATOM1  ATOM2) …</strong></p>
<blockquote>
<div><p>This directive requires pairs of atom specifications (optionally separated
by a comma). The TYPE and SERIAL of ‘atom1’ are changed to those of ‘atom2’.
Atom1 must exist in LIST 5, atom2 must NOT exist in LIST 5. An atom can be
renamed repeatedly. If atom1 contains symmetry operators, these are applied
to the coordinates of the renamed atom. An atom cannot be renamed to itself
in a single step.</p>
</div></blockquote>
<p><strong>RESET PARAMETER-NAME  VALUE ATOM LIST</strong></p>
<blockquote>
<div><p>This directive assigns the given value to the named parameter
for all the atoms in the atom list</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RESET</span> <span class="n">OCC</span> <span class="mf">1.0</span> <span class="n">ALL</span>
<span class="n">RESET</span> <span class="n">OCC</span> <span class="mf">.5</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">O</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">O</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">RESET</span> <span class="n">U</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="mf">.05</span> <span class="n">C</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">C</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>ROTATE</strong></p>
<blockquote>
<div><p>This directive rotates a group of atoms a certain number of degrees
around a specified vector. The rotation is carried out in orthogonal
space so preserves the geometry of the group.</p>
<p>There are three options available:
ROTATE D X Y Z VX VY VZ atom-specification</p>
<p>ROTATE D ATOM1 VX VY VZ atom-specification</p>
<p>ROTATE D ATOM1 ATOMS2   atom-specification</p>
<p>The first rotates the specified atoms, D degrees around the vector
VX,VY,VZ keeping point X,Y,Z fixed. (X,Y,Z and VX,VY,VZ are given in
crystal fractions).</p>
<p>The second notation uses ATOM1 instead of X,Y,Z to specify the fixed point.</p>
<p>The third notation uses ATOM1 to specify the fixed point and the vector
from ATOM1 to ATOM2 to rotate around.</p>
<p>The rotation is D degrees anti-clockwise, when the specified vector
is pointing towards you.</p>
<p>1) Rotate the hydrogens of a methyl group by sixty degrees.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">EDIT</span>
<span class="n">ROTATE</span> <span class="mi">60</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">H</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">H</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="n">H</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<span class="n">END</span>
</pre></div>
</div>
<p>2) Turn a phenyl ring through 30 degrees around its external connecting
bond, c(1) to c(20).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">EDIT</span>
<span class="n">ROTATE</span> <span class="mi">30</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">END</span>
</pre></div>
</div>
<p>3) Rotate a residue 90 degrees about the a-direction from its centroid, QC(1)
(see also CENTROID and INSERT RESIDUE directives)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">EDIT</span>
<span class="n">INSERT</span> <span class="n">RESIDUE</span>
<span class="n">CENTROID</span> <span class="mi">1</span> <span class="n">RESIDUE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ROTATE</span> <span class="mi">90</span> <span class="n">QC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="n">RESIDUE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">END</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>SELECT ATOM-PARAMETER  OPERATOR  VALUE, . .</strong></p>
<blockquote>
<div><p>This directive selects and retains atoms with parameters satisfying
the specified conditions.
Only atoms that satisfy ALL the selection criteria, whether these
are in the same or different directives, will be kept.
All other atoms will be deleted from the list.</p>
<p>The operators allowed are :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EQ</span>            <span class="n">equal</span>
<span class="n">NE</span>            <span class="ow">not</span> <span class="n">equal</span>
<span class="n">GT</span>            <span class="n">greater</span> <span class="n">than</span>
<span class="n">GE</span>            <span class="n">greater</span> <span class="n">than</span> <span class="ow">or</span> <span class="n">equal</span> <span class="n">to</span>
<span class="n">LT</span>            <span class="n">less</span> <span class="n">than</span>
<span class="n">LE</span>            <span class="n">less</span> <span class="n">than</span> <span class="ow">or</span> <span class="n">equal</span> <span class="n">to</span>
</pre></div>
</div>
<p>Examples of the  SELECT  directive are :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">SERIAL</span> <span class="n">LT</span> <span class="mi">50</span>
<span class="n">SELECT</span> <span class="n">OCC</span> <span class="n">GT</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">OCC</span> <span class="n">LT</span> <span class="mf">1.5</span>
<span class="n">SELECT</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">X</span><span class="p">)</span> <span class="n">LT</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">X</span><span class="p">)</span> <span class="n">GT</span> <span class="mf">0.</span>
<span class="n">SELECT</span> <span class="n">TYPE</span> <span class="n">NE</span> <span class="n">Q</span>
</pre></div>
</div>
<p>This example will only retain atoms with serial numbers less than 50
and occupancies between 0.5 and 1.5.
The  ‘X’  parameter of atom c(1) must also lie between 0.0 and
1.0 oterwise it will be rejected, and any atoms of type Q  will be deleted.</p>
</div></blockquote>
<p><strong>SHIFT  V1, V2, V3   ATOM-SPECIFICATION . .</strong></p>
<blockquote>
<div><p>This directive reads the three numbers of a shift vector, which must
be in the same coodrinate system as the atomic parameters,
and applies it to the parameters in the atom specification.
This directive does not create new atoms, but simply modifies
those already present.
Any symmetry operators given are applied before the translation.</p>
</div></blockquote>
<p><strong>SORT TYPE1 TYPE2 …</strong></p>
<p><strong>SORT KEYWORD</strong></p>
<blockquote>
<div><p>This directive has two formats, and is used to sort the atoms stored in
LIST 5 into a user-defined order.
The default action sorts the atoms  on their types and serial numbers.
The types are taken in the order found in LIST 5, and atoms of each
type are grouped together. In each group the atoms are
arranged by ascending serial number.
The order of the types of atoms may also be determined
by specifying them explicitly on the SORT directive,  or by a mixture of
these methods.</p>
<p>In the second format, a keyword corresponding to an atom parameter
name (as defined in LIST 5, see
section <a class="reference internal" href="#list05"><span class="std std-ref">Input of atoms and other parameters  -  LIST 5</span></a>) is given, and the whole list sorted on
increasing value of the specified parameter. Note that sorting on TYPE
will give results depending on the ‘collating sequence’ of the computer.
Fortunately, this generally leads to alphabetic sorting.</p>
<p>SORT sorts the whole list 5, and cancels any existing KEEP
directives.</p>
</div></blockquote>
<p><strong>SPLIT Z ATOM-SPECIFICATION …</strong></p>
<blockquote>
<div><p>Two new isotropic atoms are added to the end of the atom list for every
atom referenced in the atom-specification. These atoms lie on
of the principal axis of the original atoms anisotropic adp ellipsoid
and U[iso] set to U[meadian] of the original adp.</p>
<p>The original atoms are not deleted.
The sequence Z ATOM-SPECIFICATIONS can be repeated.
The new serial numbers are given by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NEWSERIAL</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span> <span class="n">OLDSERIAL</span> <span class="ow">and</span>
<span class="n">NEWSERIAL</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Z</span><span class="o">*</span> <span class="n">OLDSERIAL</span> <span class="o">+</span><span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>SUBTRACT  VALUE  PARAMETERS  …</strong></p>
<p><strong>SWAP  ATOM-PAIRS  …</strong></p>
<blockquote>
<div><p>This directive swaps the atomic coordinates (x’s and U’s) for the two
named atoms.  The occupation numbers, Residue and Parts are left
unchanged.</p>
</div></blockquote>
<p><strong>TRANSFORM  R11, R21, R31, … R33  ATOM SPECIFICATION . .</strong></p>
<blockquote>
<div><p>This directive reads the nine numbers of a transformation matrix, which must
be separated by commas or spaces, and applies the matrix to the atoms given
in the atom specification.
This directive does not create new atoms, but simply modifies
those already present.
Any symmetry operators given are applied before the rotation.</p>
</div></blockquote>
<p><strong>TYPECHANGE KEYWORD OPERATOR VALUE NEW-ATOM-TYPE</strong></p>
<blockquote>
<div><p>This directive conditionally changes the TYPES of atoms. If an atomic
parameter selected by the keyword (see sort above) satisfies the
conditions defined by the ‘operator’ and ‘value’ (see SELECT above),
then the TYPE of the atom is changed to ‘new-atom-type’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TYPECHANGE</span> <span class="n">OCC</span> <span class="n">GT</span> <span class="mf">1.2</span> <span class="n">O</span>
                        <span class="n">If</span> <span class="n">Occ</span> <span class="n">large</span><span class="p">,</span> <span class="n">convert</span> <span class="n">to</span> <span class="n">oxygen</span>
<span class="n">TYPECHANGE</span> <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">LE</span> <span class="mf">0.03</span> <span class="n">N</span>
                        <span class="n">If</span> <span class="n">Uiso</span> <span class="n">small</span><span class="p">,</span> <span class="n">convert</span> <span class="n">to</span> <span class="n">nitrogen</span>
<span class="n">TYPECHANGE</span> <span class="n">TYPE</span> <span class="n">EQ</span> <span class="n">Q</span> <span class="n">C</span>                              <span class="n">Convert</span> <span class="n">peaks</span> <span class="p">(</span><span class="nb">type</span> <span class="n">Q</span><span class="p">)</span> <span class="n">to</span> <span class="n">carbon</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>UEQUIV  ATOM SPECIFICATIONS  .  .</strong></p>
<blockquote>
<div><p>The specified atoms to be converted so that they
have isotropic temperature factors,
U(equiv), defined by the SET UEQUIV command.
IT IS NOT simply related to the
diagonal elements of U(aniso).
If an atom is already isotropic, no action is taken.
If this directive is given with no arguments, all the atoms in the current
atomic parameter list are converted to isotropic temperature factors.
Physically impossible values are not rejected.
Symmetry operators are ignored.</p>
<p>The following directives are used to convert atomic parameters into
the special shape parameters</p>
</div></blockquote>
<p><strong>SPHERE NEWSERIAL ATOMLIST</strong></p>
<blockquote>
<div><p>This creates a ‘shell’ shape from the specified atom list. The centre of
the shell is at the centre of gravity, the size is the mean distance of
the given atoms from the centre, and the occupancy is equal to  the sum of
the occupancies
of the atoms listed. U[iso] is the mean of the U[iso] or Ueqiv of the
listed atoms.
The atom TYPE is QS, with the given serial number. The
original atoms are not deleted, though they should be or their occupancy
set to zero. The atom type, QS, should be changed to something
appropriate.</p>
</div></blockquote>
<p><strong>RING NEWSERIAL ATOMLIST</strong></p>
<blockquote>
<div><p>This creates an ‘annulus’ shape from the specified atom list. The centre of
the ring is at the centre of gravity, the size is the mean distance of
the given atoms from the centre, and the occupancy is equal to the sum of
the occupancies
of the atoms listed. U[iso] is the mean of the U[iso] or Ueqiv of the
listed atoms.
The atom TYPE is QR, with the given serial number. The
original atoms are not deleted, though they should be or their occupancy
set to zero. The atom type, QS, should be changed to something
appropriate. The DECLINATION and AZIMUTH are computed from the
constituent atoms.</p>
</div></blockquote>
<p><strong>LINE NEWSERIAL ATOMLIST</strong></p>
<blockquote>
<div><p>This creates an ‘line’ shape from the specified atom list. The centre of
the line is at the centre of gravity, the size is twice the mean distance of
the given atoms from the centre, and the occupancy is equal to the sum of
the occupancies
of the atoms listed. U[iso] is the mean of the U[iso] or Ueqiv of the
listed atoms.
The atom TYPE is QL, with the given serial number. The
original atoms are not deleted, though they should be or their occupancy
set to zero. The atom type, QS, should be changed to something
appropriate. The DECLINATION and AZIMUTH are computed from the
constituent atoms.</p>
</div></blockquote>
</section>
</section>
<section id="reorganisation-of-lists-5-and-10-regroup">
<span id="index-6"></span><span id="index-5"></span><h2>Reorganisation of lists 5 and 10  -  \REGROUP<a class="headerlink" href="#reorganisation-of-lists-5-and-10-regroup" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGROUP</span> <span class="n">INPUTLIST</span><span class="o">=</span> <span class="n">OUTPUTLIST</span><span class="o">=</span>
<span class="n">SELECT</span> <span class="n">MOVE</span><span class="o">=</span> <span class="n">KEEP</span><span class="o">=</span> <span class="n">MONITOR</span><span class="o">=</span> <span class="n">SEQUENCE</span><span class="o">=</span> <span class="n">SYMMETRY</span><span class="o">=</span> <span class="n">TRANSLATION</span><span class="o">=</span> <span class="n">GROUP</span><span class="o">=</span>
<span class="n">END</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGROUP</span>
<span class="n">SELECT</span> <span class="n">MOVE</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span><span class="n">MONITOR</span><span class="o">=</span><span class="n">HIGH</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This routine offers a
way of re-ordering the atoms in LIST 5 (atomic parameters) or LIST 10
(Fourier peaks), so that
related atoms or peaks
form a sequential group in the list, and the coordinates put the atoms
as close together as possible.</p>
<p>THIS ROUTINE DOES NOT USE LIST 29 (atomic properties) to get bonding
distances, but uses a single overall distance.</p>
<p>In this routine, a set of distances is calculated about
each atom or peak in the list in turn.
For each atom or peak in the list below the current pivot, the
minimum contact distance is chosen, and if this is less than a user
specified maximum, the atom or peak is moved up the list to
a position directly below the pivot. ( The  MOVE  parameter).
When more than one atom or peak is moved, their relative order is
preserved as they are inserted behind the current pivot atom.
As well as reordering the list, the necessary symmetry operators are
applied to the positional and thermal parameters to bring the atom
or peak into the same part of the unit cell as the current pivot
atom. The result of this process is to bring related atoms together
in the list, and to place all the atoms in the same part of the unit cell.
Setting the GROUP parameter to YES causes the PART to be incremented
between isolated parts of the structure.</p>
<section id="regroup-inputlist-outputlist">
<h3>\REGROUP INPUTLIST= OUTPUTLIST=<a class="headerlink" href="#regroup-inputlist-outputlist" title="Link to this heading"></a></h3>
<p><em>INPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>OUTPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>SELECT MOVE= KEEP= MONITOR= SEQUENCE= SYMMETRY= TRANSLATION= GROUP=</strong></p>
<p><em>MOVE=</em></p>
<blockquote>
<div><p>This parameter has a default value of 2.0, and is the distance
below which atoms or peaks are considered to be bonded, and are thus
moved about the cell and relocated in LIST 5 (atomic parameters).</p>
<p>If the MOVE parameter is -ve, then a covalent radius used, and the
absolute value of MOVE is used as a TOLERANCE, such that bonds are formed
if D &lt; COV1+COV2+TOLERANCE.</p>
</div></blockquote>
<p><em>KEEP=</em></p>
<blockquote>
<div><p>This is the maximum number of atoms that the final output list can
contain. If this parameter is omitted, all the atoms are output.
If MOVE is used to move the atoms around, it is unwise to use the  KEEP
parameter,since some of the original input atoms may find their way
to the bottom of the list and be eliminated. (The default value is
1000000).</p>
</div></blockquote>
<p><em>MONITOR=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOW</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span>
<span class="n">HIGH</span>
</pre></div>
</div>
<p>If  MONITOR  is  HIGH, then each
pivot atom and its associated moved atoms are listed, as well as any
deleted atoms. If MONITOR is LOW,
the moved atoms are not listed.</p>
</div></blockquote>
<p><em>SEQUENCE</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NO</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span>
<span class="n">YES</span>
<span class="n">EXHYD</span>
</pre></div>
</div>
<p>If  SEQUENCE  is  YES, the outputlist is resquenced as described above.</p>
<p>If  SEQUENCE  is  NO, the serial numbers of the atoms are not
changed from the  original list.</p>
<p>If SEQUECE is EXHYD the hydrogen atoms are excluded from the
renumbering.</p>
</div></blockquote>
<p><em>SYMMETRY=</em></p>
<blockquote>
<div><p>This parameter controls the use of symmetry information in the calculation of
contacts, and can take three values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SPACEGROUP</span>  <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="o">.</span> <span class="n">The</span> <span class="n">full</span> <span class="n">spacegroup</span> <span class="n">symmetry</span> <span class="ow">is</span> <span class="n">used</span> <span class="ow">in</span>
                              <span class="nb">all</span> <span class="n">computations</span>
<span class="n">PATTERSON</span><span class="o">.</span>     <span class="n">A</span> <span class="n">centre</span> <span class="n">of</span> <span class="n">symmetry</span> <span class="ow">in</span> <span class="n">introduced</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">translational</span>
               <span class="n">parts</span> <span class="n">of</span> <span class="n">the</span> <span class="n">symmetry</span> <span class="n">operators</span> <span class="n">are</span> <span class="n">dropped</span><span class="o">.</span>
<span class="n">NONE</span><span class="o">.</span>          <span class="n">Only</span> <span class="n">the</span> <span class="n">identity</span> <span class="n">operator</span> <span class="ow">is</span> <span class="n">used</span><span class="o">.</span>
</pre></div>
</div>
</div></blockquote>
<p><em>TRANSLATION=</em></p>
<blockquote>
<div><p>This parameter controls the application of cell translations in the
calculation of contacts, and can take the values YES or NO</p>
</div></blockquote>
<p><em>GROUP</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NO</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span>
<span class="n">YES</span>
</pre></div>
</div>
<p>If  GROUP  is  YES, the PART parameter for each atom is set.</p>
</div></blockquote>
</section>
</section>
<section id="repositioning-of-atoms-collect">
<span id="index-8"></span><span id="index-7"></span><h2>Repositioning of atoms  -  \COLLECT<a class="headerlink" href="#repositioning-of-atoms-collect" title="Link to this heading"></a></h2>
<p>This routine changes the atom
coordinates so as to form a ‘molecule’ using the covalent radii given in
LIST 29 (atomic properties - see section <a class="reference internal" href="initial.html#list29"><span class="std std-ref">Input of the contents of the asymmetric unit  -  LIST 29</span></a>). The atom TYPE, SERIAL
and order in LIST 5 (atomic parameters - see section <a class="reference internal" href="#list05"><span class="std std-ref">Input of atoms and other parameters  -  LIST 5</span></a>) is not changed.</p>
<section id="collect-inputlist-outputlist">
<h3>\COLLECT INPUTLIST= OUTPUTLIST=<a class="headerlink" href="#collect-inputlist-outputlist" title="Link to this heading"></a></h3>
<p><em>INPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>OUTPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>SELECT MONITOR= TOLERANCE= TYPE= SYMMETRY= TRANSLATION=</strong></p>
<p><em>MONITOR=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOW</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span>
<span class="n">HIGH</span>
</pre></div>
</div>
<p>If  MONITOR  is  HIGH, then each
pivot atom and its associated moved atoms are listed, as well as any
deleted atoms. If MONITOR is LOW,
only deleted atoms are listed.</p>
</div></blockquote>
<p><em>TOLERANCE=</em></p>
<blockquote>
<div><p>The tolerance is added to the sum of the co-valent radii
taken from LIST 29 (atomic properties - see section <a class="reference internal" href="initial.html#list29"><span class="std std-ref">Input of the contents of the asymmetric unit  -  LIST 29</span></a>) to give a
value used for determining inter-atomic bonds.
The default is 0.2 A.</p>
</div></blockquote>
<p><em>TYPE=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALL</span>
<span class="n">PEAKS</span>
<span class="n">ATOMS</span>
</pre></div>
</div>
<p>If TYPE equals ALL, then the coodinates of all atoms and Q-peaks
are liable to be
modified by the symmetry operators in order to assemble a single fragment.</p>
<p>If TYPE equals PEAKS, then only the peaks are moved to bring them as close
as possible to existing atoms.</p>
<p>If TYPE equald ATOMS, only non-Q atoms are modified</p>
</div></blockquote>
<p><em>SYMMETRY=</em></p>
<blockquote>
<div><p>This parameter controls the use of symmetry information in the calculation of
contacts, and can take three values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SPACEGROUP</span>  <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="o">.</span> <span class="n">The</span> <span class="n">full</span> <span class="n">spacegroup</span> <span class="n">symmetry</span> <span class="ow">is</span> <span class="n">used</span> <span class="ow">in</span>
                              <span class="nb">all</span> <span class="n">computations</span>
<span class="n">PATTERSON</span><span class="o">.</span>     <span class="n">A</span> <span class="n">centre</span> <span class="n">of</span> <span class="n">symmetry</span> <span class="ow">in</span> <span class="n">introduced</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">translational</span>
               <span class="n">parts</span> <span class="n">of</span> <span class="n">the</span> <span class="n">symmetry</span> <span class="n">operators</span> <span class="n">are</span> <span class="n">dropped</span><span class="o">.</span>
<span class="n">NONE</span><span class="o">.</span>          <span class="n">Only</span> <span class="n">the</span> <span class="n">identity</span> <span class="n">operator</span> <span class="ow">is</span> <span class="n">used</span><span class="o">.</span>
</pre></div>
</div>
</div></blockquote>
<p><em>TRANSLATION=</em></p>
<blockquote>
<div><p>This parameter controls the application of cell translations in the
calculation of contacts, and can take the values YES or NO</p>
</div></blockquote>
</section>
</section>
<section id="shifting-the-molecule-to-a-permitted-alternative-origin-origin">
<span id="index-10"></span><span id="index-9"></span><h2>Shifting the molecule to a permitted alternative origin - \ORIGIN<a class="headerlink" href="#shifting-the-molecule-to-a-permitted-alternative-origin-origin" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">ORIGIN</span> <span class="n">INPUTLIST</span><span class="o">=</span> <span class="n">OUTPUTLIST</span><span class="o">=</span> <span class="n">MODE</span><span class="o">=</span>
<span class="n">END</span>
</pre></div>
</div>
<p>Attempt to move the structure to the centre of the unit cell
using the permitted origin shifts.</p>
<section id="origin-inputlist-outputlist-mode">
<h3>\ORIGIN INPUTLIST= OUTPUTLIST= MODE=<a class="headerlink" href="#origin-inputlist-outputlist-mode" title="Link to this heading"></a></h3>
<p><em>INPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>OUTPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>MODE=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CENTROID</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="o">.</span>
<span class="n">FIRST</span>
</pre></div>
</div>
<p>CENTROID tries to move the centroid of LIST 5 as close to .5 .5 .5
as is permitted by the permitted origin shifts.  Other connected atoms follow
the centroid.</p>
<p>FIRST  As above excpet that the first atom in LIST 5 is the
target atom.  This may be a user-computed partial centroid.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">edit</span>
<span class="n">cent</span> <span class="mi">100</span> <span class="n">residue</span> <span class="mi">3</span>
<span class="n">move</span> <span class="n">qc</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">end</span>
\<span class="n">origin</span> <span class="n">mode</span><span class="o">=</span><span class="n">first</span>
</pre></div>
</div>
<p>Currently (April 2011) the code only processes primitive triclinic,
monoclinic and orthorhombic cells, using the tables in Direct Methods in
Crystallography, Giacovazzo, Academic press, 1980, pp 74 and 76.</p>
</div></blockquote>
</section>
</section>
<section id="conversion-of-temperature-factors-convert">
<span id="index-12"></span><span id="index-11"></span><h2>Conversion of temperature factors - \CONVERT<a class="headerlink" href="#conversion-of-temperature-factors-convert" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">CONVERT</span> <span class="n">INPUTLIST</span><span class="o">=</span> <span class="n">OUTPUTLIST</span><span class="o">=</span> <span class="n">CROSSTERMS</span><span class="o">=</span>
<span class="n">END</span>

\<span class="n">CONVERT</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This routine will convert the temperature factors of a set of atoms
into the correct form when their temperature factor, t, is given by :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">T</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">B</span><span class="p">[</span><span class="n">iso</span><span class="p">]</span><span class="o">*</span><span class="n">S</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>     <span class="n">where</span> <span class="n">s</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">/</span><span class="k">lambda</span><span class="o">.</span>

<span class="ow">or</span> <span class="k">for</span> <span class="n">an</span> <span class="n">anisotropic</span> <span class="n">atom</span> <span class="p">:</span>

      <span class="n">T</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">+</span> <span class="n">l</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span>
          <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">l</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span>
</pre></div>
</div>
<p>The cross terms stored in the original LIST 5 (the model parameters)
may either be  B[IJ]  or 2*B[IJ] .
(The correct form of the temperature factor, in terms of u[ii]’s
and u[ij]’s, is given in the section on the input of LIST 5).
After conversion, the atoms are output to the disc as a new LIST 5.
Remember that if U[ISO] is non-zero, (its default at atom input is 0.05)
the U[IJ] are ignored and so will not be converted.</p>
<section id="convert-inputlist-outputlist-crossterms">
<h3>\CONVERT INPUTLIST= OUTPUTLIST= CROSSTERMS=<a class="headerlink" href="#convert-inputlist-outputlist-crossterms" title="Link to this heading"></a></h3>
<blockquote>
<div><p>This is the command which initiates the routine
to convert the temperature factors.</p>
</div></blockquote>
<p><em>INPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>OUTPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>CROSSTERMS=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="n">IJ</span><span class="p">]</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="o">.</span>
<span class="mi">2</span><span class="n">B</span><span class="p">[</span><span class="n">IJ</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="hydrogen-placing-hydrogens">
<span id="index-14"></span><span id="index-13"></span><h2>Hydrogen placing - \HYDROGENS<a class="headerlink" href="#hydrogen-placing-hydrogens" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">HYDROGENS</span> <span class="n">INPUTLIST</span><span class="o">=</span> <span class="n">OUTPUTLIST</span><span class="o">=</span>
<span class="n">DISTANCE</span>  <span class="n">D</span>
<span class="n">SERIAL</span>    <span class="n">N</span>
<span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>    <span class="n">U</span>
<span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>    <span class="n">NEXT</span>   <span class="n">MULT</span>
<span class="n">AFTER</span>     <span class="n">TYPE</span><span class="p">(</span><span class="n">SERIAL</span><span class="p">)</span>
<span class="n">PHENYL</span>    <span class="n">X</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">H33</span>       <span class="n">X</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H23</span>       <span class="n">X</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H13</span>       <span class="n">X</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H22</span>       <span class="n">X</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H12</span>       <span class="n">X</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H11</span>       <span class="n">X</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">HBOND</span>     <span class="n">DONOR</span> <span class="n">ACCEPTOR</span>
<span class="n">END</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">HYDROGENS</span>
<span class="n">DISTANCE</span>  <span class="mf">1.09</span>
<span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>    <span class="n">NEXT</span>   <span class="mf">1.2</span>
<span class="n">H33</span>     <span class="n">C</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">H22</span>     <span class="n">C</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This routine computes the coordinates of hydrogen atoms bonded to a
target atom. The hybridisation of the target atom and the identifiers of
atoms bonded to it must be given.</p>
<section id="hydrogens-inputlist-outputlist">
<h3>\HYDROGENS INPUTLIST= OUTPUTLIST=<a class="headerlink" href="#hydrogens-inputlist-outputlist" title="Link to this heading"></a></h3>
<p><em>INPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>OUTPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>DISTANCE  D</strong></p>
<blockquote>
<div><p>This sets the central atom-hydrogen atom distance to
‘D’ angstroms. The default value is 1.0.
The current value of ‘D’ remains in force until another ‘DISTANCE’
directive is given.</p>
</div></blockquote>
<p><strong>SERIAL  N</strong></p>
<blockquote>
<div><p>This sets the serial number of the next hydrogen atom
to be added to LIST 5 (atomic parameters) to ‘N’.
The default value is 1.
Subsequent hydrogen atoms will have the serial numbers ‘N+1’, ‘N+2’, etc.,
until the next ‘SERIAL’ directive is input.</p>
</div></blockquote>
<p><strong>U[ISO]    U</strong></p>
<blockquote>
<div><p>This directive sets the isotropic temperature factor
of each hydrogen atom
to ‘U’ angstroms squared,
and remains in force until another ‘U[ISO]’
directive is given.
If no values is given for U, the next definition is used.</p>
</div></blockquote>
<p><strong>U[ISO]    NEXT   MULT</strong></p>
<blockquote>
<div><p>This is an alternatine form of the preceding directive. It sets the
isotropic temperature factor  of each hydrogen atom
to ‘MULT’ times the equivalent temperature factor of the atom it is
bonded to.  The default value is 1.2.
The directive remains in force until another ‘U[ISO]’
directive is given.</p>
</div></blockquote>
<p><strong>AFTER   TYPE(SERIAL)</strong></p>
<blockquote>
<div><p>The hydrogen atoms generated by the placing routines
are inserted in the new LIST 5 (atomic parameters) after the atom
‘TYPE(SERIAL)’.
This directive must appear immediately after the directive that generated
the hydrogen atom coordinates, and applies only to that group of
hydrogen atoms.
If no ‘AFTER’ directive is
given, the new hydrogen atoms are added at the end of the
current LIST 5 (atomic parameters).</p>
</div></blockquote>
<p><strong>PHENYL  X R(1) R(2) R(3) R(4) R(5)</strong></p>
<blockquote>
<div><p>This generates the coordinates of  the five hydrogen atoms
of a phenyl group. The first atom specified must be
the atom that bonds the phenyl group
to the rest of the structure, and the other atoms must be in the order
of connectivity.</p>
</div></blockquote>
<p><strong>H33  X R(1) R(2)</strong></p>
<blockquote>
<div><p>This geneates the hydrogen atoms of a methyl
group.
The methyl carbon is the first atom specified, and
the hydrogen atoms are generated so that one of them is trans
with respect to the third atom specified, R(2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">H</span>
 \
<span class="n">H</span><span class="o">-</span><span class="n">X</span><span class="o">-</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
 <span class="o">/</span>
<span class="n">H</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>H23  X R(1) R(2)</strong></p>
<blockquote>
<div><p>This generates the coordinates of two hydrogen atoms on an sp3 atom X.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">H</span>   <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 \ <span class="o">/</span>
  <span class="n">X</span>
 <span class="o">/</span> \
<span class="n">H</span>   <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>H13  X R(1) R(2) R(3)</strong></p>
<blockquote>
<div><p>This generates the coordinates of one hydrogen atom on an sp3 atom X.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">/</span>
<span class="n">H</span><span class="o">-</span> <span class="n">X</span><span class="o">-</span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    \
     <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>H22  X R(1) R(2)</strong></p>
<blockquote>
<div><p>This generates the coordinates of two hydrogen atoms on an sp2  atom X</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">H</span>        <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
 \      <span class="o">/</span>
  <span class="n">X</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
 <span class="o">/</span>
<span class="n">H</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>H12  X R(1) R(2)</strong></p>
<blockquote>
<div><p>This generates the coordinates of one hydrogen atom on an sp2 atom X.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">H</span>
   \
    <span class="n">X</span><span class="o">=</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   <span class="o">/</span>
<span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>H11  X  R</strong></p>
<blockquote>
<div><p>This generates the coordinates of the single
hydrogen atom bonded to an SP hybridised atom.</p>
</div></blockquote>
<p><strong>HBOND X  R</strong></p>
<blockquote>
<div><p>This generates a single H atom ‘DISTANCE’ angstroms from the donor
in the direction of the acceptor. X is the donor, R the acceptor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">-</span><span class="n">H</span><span class="o">....</span><span class="n">R</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Place</span> <span class="n">Hydrogen</span> <span class="n">atoms</span> <span class="n">on</span> <span class="n">the</span> <span class="n">following</span> <span class="n">fragment</span><span class="p">:</span>

     <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>          <span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
         \        <span class="o">/</span>
          <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                  \
                   <span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="n">Br</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    \<span class="n">HYDROGENS</span>
     <span class="n">DISTANCE</span> <span class="mf">0.99</span>
     <span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>   <span class="mf">0.06</span>
     <span class="n">H33</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
     <span class="n">AFTER</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
     <span class="n">H12</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
     <span class="n">AFTER</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
     <span class="n">H23</span> <span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">Br</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
     <span class="n">AFTER</span> <span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
     <span class="n">H33</span> <span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
     <span class="n">END</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="perhydrogenation-perhydro">
<span id="index-16"></span><span id="index-15"></span><h2>Perhydrogenation - \PERHYDRO<a class="headerlink" href="#perhydrogenation-perhydro" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">PERHYDRO</span> <span class="n">INPUTLIST</span><span class="o">=</span> <span class="n">OUTPUTLIST</span><span class="o">=</span>
<span class="n">DISTANCE</span>  <span class="n">D</span>
<span class="n">SERIAL</span>    <span class="n">N</span>
<span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>    <span class="n">U</span>
<span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span>    <span class="n">NEXT</span>   <span class="n">MULT</span>
<span class="n">ACTION</span>    <span class="n">MODE</span>
<span class="n">TYPE</span>      <span class="n">C</span> <span class="ow">or</span> <span class="n">N</span>
<span class="n">END</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">PERHYDRO</span>
<span class="n">U</span><span class="p">[</span><span class="n">ISO</span><span class="p">]</span> <span class="n">NEXT</span> <span class="mf">1.0</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This command scans the atomic coordinates for carbon atoms, attempts
to assign their hybridisation state (on the basis of bond lengths) and
then generates \HYDROGEN commands to create any necessary hydrogen atoms.
Existing Hydrogen atoms are not replaced by this routine.</p>
<p>The generated commands may be processed internally by CRYSTALS without
the user needing to see them, or they may be sent to the external files for
later use. This is the default mode. If no new hydrogen atoms are
generated, no new external files are created.</p>
<p>The external files are called DELH.DAT and PERH.DAT, with DELH
containing an entry for every atom created by PERH.  Executing DELH and
PERH will delete existing named atoms, and recreate them geometrically.</p>
<section id="perhydro-inputlist-outputlist">
<h3>\PERHYDRO INPUTLIST= OUTPUTLIST=<a class="headerlink" href="#perhydro-inputlist-outputlist" title="Link to this heading"></a></h3>
<p><em>INPUTLIST=</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><em>OUTPUTLIST</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="p">,</span> <span class="n">the</span> <span class="n">atomic</span> <span class="n">coordinates</span>
<span class="mi">10</span>                    <span class="n">the</span> <span class="n">Fourier</span> <span class="n">peaks</span> <span class="n">search</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>DISTANCE  D</strong></p>
<blockquote>
<div><p>This sets the central atom-hydrogen atom distance to
‘D’ angstroms. The default value is 1.0.
The current value of ‘D’ remains in force until another ‘DISTANCE’
directive is given.</p>
</div></blockquote>
<p><strong>SERIAL  N</strong></p>
<blockquote>
<div><p>This sets the serial number of the next hydrogen atom
to be added to LIST 5 to ‘N’.
The default value is 1.
Subsequent hydrogen atoms will have the serial numbers ‘N+1’, ‘N+2’, etc.,
until the next ‘SERIAL’ directive is input.</p>
</div></blockquote>
<p><strong>U[ISO]    U</strong></p>
<blockquote>
<div><p>This directive sets the isotropic temperature factor
associated with each hydrogen atom
to ‘U’ angstroms squared.
The default value is 0.05.
The directive remains in force until another ‘U[ISO]’
directive is given.</p>
</div></blockquote>
<p><strong>U[ISO]    NEXT   MULT</strong></p>
<blockquote>
<div><p>This is an alternatine form of the preceding directive. It sets the
isotropic temperature factor  associated with each hydrogen atom
to ‘MULT’ times the equivalent temperature factor of the atom it is
bonded to.  The default value is 1.2.
The directive remains in force until another ‘U[ISO]’
directive is given.</p>
</div></blockquote>
<p><strong>ACTION    MODE</strong></p>
<p><em>MODE</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NORMAL</span>
<span class="n">PUNCH</span>
<span class="n">BOTH</span>     <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="o">.</span>
</pre></div>
</div>
<p>NORMAL causes internal commands to be generated and executed. PUNCH causes
output to the PUNCH file only. BOTH forces both actions.</p>
</div></blockquote>
<p><strong>TYPE    MODE</strong></p>
<p><em>MODE</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span>   <span class="o">-</span>  <span class="n">Default</span> <span class="n">value</span><span class="o">.</span>
<span class="n">N</span>
</pre></div>
</div>
<p>C enables the program to place hydrogen atoms on carbon atoms.</p>
<p>N enables the program to place hydrogen atoms on nitrogen.</p>
<p>It is advisable to perform placement on C before N, since the
hybridisation states of C are more clearly defined.</p>
</div></blockquote>
</section>
</section>
<section id="hydrogen-re-numbering-hname">
<span id="index-18"></span><span id="index-17"></span><h2>Hydrogen re-numbering - \HNAME<a class="headerlink" href="#hydrogen-re-numbering-hname" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">HNAME</span> <span class="n">INPUTLIST</span><span class="o">=</span> <span class="n">OUTPUTLIST</span><span class="o">=</span>
<span class="n">END</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">HNAME</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This command automatically renumbers hydrogen atoms so that their
serial numbers are related to the bonded non-hydrogen atom.</p>
</section>
<section id="regularisation-of-atomic-groups-regularise">
<span id="index-20"></span><span id="index-19"></span><h2>Regularisation of atomic groups - \REGULARISE<a class="headerlink" href="#regularisation-of-atomic-groups-regularise" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGULARISE</span>    <span class="n">MODE</span>
<span class="n">COMPARE</span>
<span class="n">KEEP</span>
<span class="n">REPLACE</span>
<span class="n">AUGMENT</span>
<span class="n">METHOD</span> <span class="n">NUMBER</span>
<span class="n">GROUP</span> <span class="n">NUMBER</span>
<span class="n">TARGET</span> <span class="n">Atom</span> <span class="n">Specifications</span>
<span class="n">IDEAL</span>  <span class="n">Atom</span> <span class="n">Specifications</span>
<span class="n">RENAME</span> <span class="n">offset</span> <span class="n">number</span>
<span class="n">CAMERON</span>
<span class="n">MAP</span> <span class="n">Atom</span> <span class="n">Specifications</span>
<span class="n">ONTO</span> <span class="n">Atom</span> <span class="n">Specifications</span>
<span class="n">SYSTEM</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">alpha</span> <span class="n">beta</span> <span class="n">gamma</span>
<span class="n">ATOM</span>    <span class="n">x</span>    <span class="n">y</span>    <span class="n">z</span>
<span class="n">CP</span><span class="o">-</span><span class="n">RING</span> <span class="n">x</span>
<span class="n">HEXAGON</span> <span class="n">x</span>
<span class="n">OCTAHEDRON</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span>
<span class="n">PHENYL</span>
<span class="n">SQP</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span>
<span class="n">SQUARE</span> <span class="n">x</span> <span class="n">y</span>
<span class="n">TBP</span> <span class="n">x</span> <span class="n">z</span>
<span class="n">TETRAHEDRON</span> <span class="n">x</span>
<span class="n">END</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGULARISE</span> <span class="n">REPLACE</span>
<span class="n">GROUP</span> <span class="mi">6</span>
<span class="n">TARGET</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">C</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">PHENYL</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This routine calculates a fit between the
coordinates of a group of atoms in LIST 5 (atomic parameters) and another
group.
The calculated fitting matrix may be used to compare the geometry of two
groups, or it may be applied to transform the new coordinates which will
then replace the existing group in LIST 5 (D. J. Watkin, Act Cryst
(1980). A36,975).</p>
<p>In this section, the group of atoms in LIST 5 to whose coordinates the
fit is made is referred to as the ‘TARGET atoms’, and the group to be fitted
onto that group is referred to as the ‘IDEAL atoms’.</p>
<p>The source of the ‘IDEAL atoms’ can be the LIST 5,
a pre-stored idealised geometry,  or values read in from the directives.
Those directives that refer to LIST 5 use the usual CRYSTALS formats for
atom specifications. Once a transformation has been found, this can be
used as the basis for naming one fragment based on the names of
another.</p>
<section id="input-for-regularise">
<h3>Input for REGULARISE<a class="headerlink" href="#input-for-regularise" title="Link to this heading"></a></h3>
<blockquote>
<div><p>The input to REGULARISE must define the groups to be fitted together,
the method used for fitting , and the use to be made of the results.
The user must ensure that corresponding atoms
are specified in the same positions of the ‘TARGET’ and ‘IDEAL’ group
definitions, so the program knows which pairs of atoms are to be
matched.
It is not necessary to have co-ordinates of every atom
in the TARGET fragment. The inclusion of atom specifications
for which coordinates do not exist in the parameter list indicates
that the procedure must generate coordinates for these atoms.
This allows the user to give a type and serial to new atoms
created by the procedure.
Any ‘atoms’ without coordinates are not included in the fitting
process.</p>
<p>The maximum number of atom  IDENTIFIERS permitted on an TARGET or
IDEAL directive is about 250. Note that an UNTIL sequence only
counts as two identifiers.
The number of implied atoms permitted is very large.</p>
<p>The ‘IDEAL’ group may be given in various ways.
For calculations
on a single structure,  it may be extracted from the stored data
in the same way as the ‘TARGET’ group.  In this case however, all the atoms
must previously exist.
Alternatively, explicit co-ordinates may be  given in
a system defined  by the user,   or a predefined group may be used.
In any case all the positional parameters of
the atoms in the  ‘IDEAL’ group will be known before the
calculation begins. Finally, various pre-defined geometrical groups are
available.</p>
</div></blockquote>
</section>
<section id="output-from-regularise">
<h3>Output from REGULARISE<a class="headerlink" href="#output-from-regularise" title="Link to this heading"></a></h3>
<blockquote>
<div><p>The output from REGULARISE  includes the fragment centroids, their
sums and differences and the
transformation fitting the IDEAL onto the TARGET.</p>
</div></blockquote>
</section>
<section id="method-of-calculation">
<h3>Method of calculation<a class="headerlink" href="#method-of-calculation" title="Link to this heading"></a></h3>
<blockquote>
<div><p>The centroid of each fragment is moved to the origin.
The atomic
coordinates are converted to an orthogonal system and rotated  to an
‘inertial tensor’ system (to help condition the L.S. matrix).</p>
<p>The fitting calculation is either constrained to be a pure rotation-
inversion, or is a free linear transformation (rotation-diltion).
If requested, the pure rotation component of the calculated
rotation-dilation matrix is extracted.</p>
<p>The calculated  matrix is applied to the co-ordinated of the
‘IDEAL’ group, which is then converted back to crystal fractions,
for comparison with the TARGET.</p>
</div></blockquote>
<p><strong>WARNING</strong></p>
<blockquote>
<div><p>The  3 by 3  transformation  matrices  generated  at  various
stages  may  well  be  singular,  especially if  no rotation  is
defined about one of the axes.  To combat possible problems with
matrix inversion, a Moore-Penrose type matrix inverter is used.
Even so, the user should be aware that there may be no unique solution
to his problem. For example, when a planar fragment is fitted to an
almost planar fragment one fit may involve inversion of the non-planar
fragment. Inversion can be prevented by using Method 3.
Note also that if almost planar groups are being fitted, the dilation
factor perpendicular to the plane may be very large, and thus have an
undesirable effect if applied to atoms far from the plane.</p>
</div></blockquote>
</section>
<section id="regularise-mode">
<h3>\REGULARISE    MODE<a class="headerlink" href="#regularise-mode" title="Link to this heading"></a></h3>
<blockquote>
<div><p>MODE is an  optional  parameter.</p>
</div></blockquote>
<p><em>MODE</em></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COMPARE</span>      <span class="o">-</span>      <span class="n">Default</span> <span class="n">value</span>
<span class="n">KEEP</span>
<span class="n">REPLACE</span>
<span class="n">AUGMENT</span>
</pre></div>
</div>
<p>The effects are :-</p>
<p>COMPARE        The specified groups are only compared. The
translations and rotations necessary to match the
groups will be calculated but not applied.</p>
<p>KEEP           The specified groups will be compared and the
calculated transformations applied. The TARGET atoms are
kept, and atoms  whose parameters have been
calculated will be stored at the end of the new LIST 5.
NOTE. If KEEP is given as a keyword, it can be followed by an offset
to be used for the new serial numbers</p>
<p>REPLACE        The specified groups will be compared and the
calculated transformations applied. The new atoms whose parameters
have been calculated will
be placed at the end of LIST 5 and the old atoms deleted form the list.</p>
<p>AUGMENT        The specified groups will be compared and the
calculated transformations applied. The TARGET atoms which actually
exist in LIST 5 are retained unaltered.
Parameters that have been  calculated for dummy atoms (represented by a
name only in the TARGET list) will be placed at the end of the new LIST 5.</p>
<p>For REPLACE and KEEP the ‘IDEAL’ coordinates define the geometry to
be preserved, i.e. the model, and the ‘TARGET’ coordinates specify where,
in what orientation and with what atom identifiers the model is to be placed.
That is, the TARGET structure is replaced by the IDEAL.</p>
</div></blockquote>
<p><strong>KEEP  Z</strong></p>
<p><strong>COMPARE</strong></p>
<p><strong>REPLACE</strong></p>
<p><strong>AUGMENT</strong></p>
<blockquote>
<div><p>These 4 directives override the option specified by the MODE parameter of
the REGULARISE command. The next group calculated will be treated
in the specified mode. See the description of MODE for
details. If the mode is KEEP, an offset Z can be given to be added to
ther SERIAL of kept atoms (default 0) otherwise there are no parameters.</p>
</div></blockquote>
<p><strong>METHOD NUMBER</strong></p>
<blockquote>
<div><p>This directive selects the method for matching the
groups by giving its number from the
following list:-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span>     <span class="n">Method</span>
<span class="o">------</span>     <span class="o">------</span>
 <span class="mi">1</span>        <span class="n">Rotation</span>  <span class="n">component</span> <span class="n">of</span>  <span class="n">rotation</span><span class="o">-</span><span class="n">dilation</span>
          <span class="n">matrix</span> <span class="n">applied</span><span class="o">.</span> <span class="p">(</span> <span class="n">default</span> <span class="p">)</span>
 <span class="mi">2</span>        <span class="n">Rotation</span><span class="o">-</span><span class="n">dilation</span>  <span class="n">matrix</span>  <span class="n">calculated</span> <span class="ow">and</span>
          <span class="n">applied</span><span class="o">.</span>
 <span class="mi">3</span>        <span class="n">Pure</span>  <span class="n">rotation</span> <span class="n">matrix</span>  <span class="n">calculated</span>  <span class="n">by</span> <span class="n">the</span>
          <span class="n">Kabsch</span> <span class="n">method</span> <span class="ow">and</span> <span class="n">applied</span><span class="o">.</span> <span class="n">This</span> <span class="n">algorithm</span>
          <span class="n">preserves</span> <span class="n">chirality</span><span class="o">.</span>
 <span class="mi">4</span>        <span class="n">Enable</span> <span class="n">improper</span> <span class="n">rotation</span> <span class="ow">in</span> <span class="n">Kabsch</span> <span class="n">method</span>
 <span class="mi">5</span>        <span class="n">Use</span> <span class="n">identity</span> <span class="n">matrix</span> <span class="k">as</span> <span class="n">rotation</span> <span class="n">component</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>GROUP NUMBER</strong></p>
<blockquote>
<div><p>This directive specifies the number of atoms in the groups to be matched.
It should be the first directive for each group of atoms. The appearance
of a second or subsequent GROUP directive in the input
initiates the calculation for the previous group.</p>
</div></blockquote>
<p><strong>TARGET Atom Specifications</strong></p>
<blockquote>
<div><p>This directive is used to specify the ‘TARGET’ group of atoms. The directive
will carry a series of atom specifications which will define the positions
of the ‘TARGET’ atoms and the names of any atoms to be created by the
routine. Atoms which exist in LIST 5 and atoms to be created can appear in
any order in the TARGET group , although the order should be such that
corresponding pairs of atoms appear at the same relative positions in the
‘TARGET’ and ‘IDEAL’ groups.</p>
</div></blockquote>
<p><strong>IDEAL Atom Specifications</strong></p>
<blockquote>
<div><p>This directive is used to specify a group of ‘IDEAL’ atoms to be taken
from the stored LIST 5. Every atom on this directive must exist.</p>
</div></blockquote>
<p><strong>SYSTEM a b c alpha beta gamma</strong></p>
<blockquote>
<div><p>This directive is will change the co-ordinate system used to interpret any
subsequent ATOM directives.</p>
<p>The initial co-ordinate system has orthogonal axes of unit length and is
equivalent to :-</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SYSTEM</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>  <span class="mf">1.0</span>  <span class="mf">90.0</span>  <span class="mf">90.0</span>  <span class="mf">90.0</span>
</pre></div>
</div>
<p>Values must be given for a’, b’, and c’, the angles default to 90.0.</p>
</div></blockquote>
<p><strong>ATOM    x    y    z</strong></p>
<blockquote>
<div><p>This directive allows the cordinates of a single atom to be specified,
in fractional co-ordinates in the current co-ordintate system. It must be
followed by three decimal numbers which will be the X, Y, and Z coordinates
of the atom.</p>
</div></blockquote>
<p><strong>RENAME offset number</strong></p>
<blockquote>
<div><p>This directive can only be used after previous directives have been
used to match one group onto another (REGULARISE COMPARE),
and enables the use of the MAP
and ONTO directives. The MAP list of atoms is transformed by the
existing transformation matrix (which may have been computed from only a
few specified atoms). Each atom is then compared with the ONTO list,
and the TYPE and SERIAL of the MAP atom used to generate a TYPE and
SERIAL for the closest ONTO atom.</p>
</div></blockquote>
<p><em>OFFSET</em></p>
<blockquote>
<div><p>The serial numbers of the atoms in the group being re-named are
related to those of the master group by an increment of ‘OFFSET’. The
default value is 100</p>
</div></blockquote>
<p><em>NUMBER</em></p>
<blockquote>
<div><p>If the number of atoms supplied on the following MAP and ONTO
directives does not match NUMBER, a warning is printed.</p>
</div></blockquote>
<p><strong>CAMERON</strong></p>
<blockquote>
<div><p>This matches atoms as in RENUMBER, but only creates CAMERON files
with atoms transformed into the common coordinate system.</p>
</div></blockquote>
<p><strong>MAP  Atom Specifications</strong></p>
<blockquote>
<div><p>This specifies the atoms whose TYPE and SERIAL are to be propogated
into the ONTO atoms. The atoms can be in any order.</p>
</div></blockquote>
<p><strong>ONTO  Atom Specifications</strong></p>
<blockquote>
<div><p>This specifies the atoms to be renamed. The atoms may be in any order
and have any TYPE, but there must be EXACTLY as many as on the MAP
directive. The atoms can have any TYPE, but must have unique SERIAL
numbers.</p>
</div></blockquote>
<p><strong>HEXAGON X</strong></p>
<blockquote>
<div><p>The ‘IDEAL’ group is a regular hexagon with
a side of length ‘X’. The default for x is 1.0.</p>
</div></blockquote>
<p><strong>PHENYL</strong></p>
<blockquote>
<div><p>The same as HEXAGON with a fixed side of 1.39.</p>
</div></blockquote>
<p><strong>CP-RING X</strong></p>
<blockquote>
<div><p>The ‘IDEAL’ group is a regular pentagon with
a side of length ‘X’. The default for x is 1.4.</p>
</div></blockquote>
<p><strong>SQUARE X Y</strong></p>
<blockquote>
<div><p>The ‘IDEAL’ group is a rectangle with atoms
at (x,0,0) , (0,y,0) , (-x,0,0) , (0,-y,0) . The parameters
X and Y specify the size of the group to be used.</p>
</div></blockquote>
<p><strong>OCTAHEDRON X Y Z</strong></p>
<blockquote>
<div><p>The ‘IDEAL’ group is an octahedron with
atoms at (0,0,0) , (-x,0,0) , (0,y,0) , (x,0,0) , (0,-y,0) ,
(0,0,z) , (0,0,-z).
The parameters X, Y and Z specify the size of the octahedron.
‘z’ defaults to ‘y’ defaults to ‘x’
defaults to ‘1.0’</p>
</div></blockquote>
<p><strong>SQP X Y Z</strong></p>
<blockquote>
<div><p>The ‘IDEAL’ group is a square pyramid with
atoms at (0,0,0) , (x,0,0) , (0,y,0) , (-x,0,0) , (0,-y,0) ,
(0,0,z).
The parameters X, Y and Z specify the size of the octahedron.
‘z’ defaults to ‘y’ defaults to ‘x’
defaults to ‘1.0’</p>
</div></blockquote>
<p><strong>TBP X Z</strong></p>
<blockquote>
<div><p>The ‘IDEAL’ group is a trigonal bipyramid with
atoms at (0,0,0) , (x,0,0) , (-x/2,0.86603x,0), (-x/2,-0.86603x,0) ,
(0,0,z) , (0,0,-z) . The parameters X and Z specify the scale in the
xy plane  and z directions.</p>
</div></blockquote>
<p><strong>TETRAHEDRON X</strong></p>
<blockquote>
<div><p>The ‘IDEAL’ group is a regular tetrahedron with
an atom at the centre.
‘x’ is the distance in Angstrom from the
centre to an apex and defaults to ‘1.0’</p>
</div></blockquote>
<p><strong>ORIGIN</strong></p>
<blockquote>
<div><p>This directive is not yet implemented.</p>
</div></blockquote>
</section>
<section id="uses-of-regularise">
<h3>Uses of \REGULARISE<a class="headerlink" href="#uses-of-regularise" title="Link to this heading"></a></h3>
<p><strong>1 - Extending a fragment to a complete molecule</strong></p>
<blockquote>
<div><p>Three atoms of a phenyl group ( C(1), C(2) C((6)) have been located.
Fill in the missing  atoms from a non-dilated idealised phenyl group.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGULARISE</span> <span class="n">AUGMENT</span>
<span class="n">GROUP</span> <span class="mi">6</span>
<span class="n">METHOD</span> <span class="mi">1</span>
\ <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="ow">and</span> <span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">yet</span> <span class="n">exist</span><span class="o">.</span>
<span class="n">TARGET</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">PHENYL</span>
<span class="n">END</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>2 - Forcing a regular shape on a group of atoms</strong></p>
<blockquote>
<div><p>A group of atoms is approximately  octahedral.
Replace them by a (posibly dilated) regular octahedron.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGULARISE</span> <span class="n">REPLACE</span>
<span class="n">GROUP</span> <span class="mi">7</span>
<span class="n">METHOD</span> <span class="mi">2</span>
<span class="n">TARGET</span> <span class="n">CO</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">N</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">N</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">N</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">N</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="n">N</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">OCTAHEDRON</span>
<span class="n">END</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>3 - Checking for an additional symmetry element</strong></p>
<blockquote>
<div><p>Determine whether the two molecules in an asymmetric unit are
related  by a  symmetry operation not  expected for the space  group.
The matrix relating the molecules and the translation required  to
make their centroids  coincide should display any additional
(approximate)  symmetry  present. Remember that if one molecule is
the enantiomer of the other, Method 3 will lead to an unsatisfactory
fitting unless  one molecule is inverted, (by using the operator -1 in
the atom specifications e.g. FIRST(-1) UNTIL C(23). This can be done
even if the space group is non-centrosymmetric ).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGULARISE</span> <span class="n">COMPARE</span>
<span class="n">GROUP</span> <span class="mi">16</span>
<span class="n">TARGET</span> <span class="n">C</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">N</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
<span class="n">IDEAL</span>  <span class="n">C</span><span class="p">(</span><span class="mi">201</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">N</span><span class="p">(</span><span class="mi">202</span><span class="p">)</span>
<span class="n">END</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>4 - Renaming a group of atoms</strong></p>
<blockquote>
<div><p>A second group of atoms is given new TYPES and SERIAL numbers
so that the atom names are related to  a previously named group.</p>
<p>In the example, the user has identified two sets of four non-coplanar
atoms in each
group e.g. C(1) with Q(103), C(3) with  Q(99) etc. The transformation
is then used to map the whole of the first group (C(1) until O(25)) onto
the second group (Q(96) until Q(120)). Both of these groups must contain
the same number of atoms, but they may be in any order. Atom Q(103) will
be renamed to C(101), atom Q(100) to C(107) etc. Once all the atoms
have been renamed, the list could be sorted based on the serial numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGULARISE</span>
<span class="n">GROUP</span> <span class="mi">4</span>
<span class="n">IDEAL</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">TARGET</span> <span class="n">Q</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span> <span class="n">Q</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">116</span><span class="p">)</span> <span class="n">Q</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">RENAME</span> <span class="mi">100</span>
<span class="n">MAP</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">O</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ONTO</span> <span class="n">Q</span><span class="p">(</span><span class="mi">96</span><span class="p">)</span> <span class="n">UNTIL</span> <span class="n">Q</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
<span class="n">END</span>
\<span class="n">EDIT</span>
<span class="n">SORT</span> <span class="n">SERIAL</span>
<span class="n">END</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>5 - Viewing matched molecules in CAMERON</strong></p>
<blockquote>
<div><p>This does the mapping as RENAME, but doesn’t
rename the atoms, just outputs CAMERON input files showing the two molecules
superimposed. Use as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">REGULARISE</span>
<span class="n">group</span> <span class="mi">16</span>
<span class="n">target</span> <span class="n">C</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">until</span> <span class="n">C</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
<span class="n">ideal</span>  <span class="n">C</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="n">until</span> <span class="n">C</span><span class="p">(</span><span class="mi">76</span><span class="p">)</span>
<span class="n">cameron</span>
<span class="nb">map</span>    <span class="n">C</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span> <span class="n">until</span> <span class="n">C</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="n">onto</span>   <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">until</span> <span class="n">C</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span>
<span class="n">end</span>
</pre></div>
</div>
<p>This produces a cameron.ini, regular.l5i and regular.oby which may be viewed
by choosing Graphics-&gt;Special-&gt;Cameron (use existing…) from the menu.
Then type “obey regular.oby” in Cameron to colour the molecules nicely.
The TARGET and IDEAL are used to obtain the mapping. The atoms in MAP and ONTO
are just the ones you want to be included.
Don’t read the atoms back into CRYSTALS when closing CAMERON - they’re in
orthogonal coordinates.</p>
</div></blockquote>
<p><strong>- Comparing two structures</strong></p>
<blockquote>
<div><p>The SYSTEM and ATOM directives enable one to compare one structure with
atoms from a second structure. However, since the second structure is
not part of the main model, CRYSTALS knows nothing about the
connectivity.  Using the KEEP z directive, the second strcuture can be
added to the DSC file, enabling a complete calculation to be performed.</p>
<p>In the following example, O(16) is in a quite distinctly different
position in the two structures, so place holder Q(16) is used during the
first mapping. The input coordinates are added to the DSC file with
SERIAL numbers off-set by 400.</p>
<p>In the second calculation O(16) of the original structure is compared
with Q(416) of the input structure.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">regular</span> <span class="n">keep</span>
<span class="n">keep</span> <span class="mi">400</span>
<span class="n">group</span> <span class="mi">7</span>
<span class="n">old</span> <span class="n">mo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">o</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">o</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="n">o</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="n">o</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="n">o</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="n">q</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="n">system</span> <span class="mf">8.4830</span> <span class="mf">10.1870</span> <span class="mf">11.0340</span> <span class="mf">105.260</span> <span class="mf">95.290</span> <span class="mf">95.100</span> <span class="mf">909.60</span>
<span class="n">atom</span> <span class="mf">0.1570</span> <span class="mf">0.5269</span> <span class="mf">0.2514</span>
<span class="n">atom</span> <span class="mf">0.1356</span> <span class="mf">0.5975</span> <span class="mf">0.1278</span>
<span class="n">atom</span> <span class="o">-</span><span class="mf">0.0296</span> <span class="mf">0.4567</span> <span class="mf">0.2632</span>
<span class="n">atom</span> <span class="mf">0.2258</span> <span class="mf">0.3448</span> <span class="mf">0.1750</span>
<span class="n">atom</span> <span class="mf">0.1693</span> <span class="mf">0.6928</span> <span class="mf">0.3850</span>
<span class="n">atom</span> <span class="mf">0.4211</span> <span class="mf">0.5669</span> <span class="mf">0.2567</span>
<span class="n">atom</span> <span class="mf">0.7960</span> <span class="mf">0.1904</span> <span class="mf">0.1727</span>


\<span class="n">regular</span> <span class="n">compare</span>
<span class="n">group</span> <span class="mi">7</span>
<span class="n">old</span> <span class="n">mo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">o</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">until</span> <span class="n">o</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="n">new</span> <span class="n">mo</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span> <span class="n">until</span> <span class="n">q</span><span class="p">(</span><span class="mi">416</span><span class="p">)</span>
<span class="n">end</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="map-two-atomic-groups-together-match">
<span id="index-22"></span><span id="index-21"></span><h2>Map two atomic groups together - \MATCH<a class="headerlink" href="#map-two-atomic-groups-together-match" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">MATCH</span>
<span class="n">MAP</span> <span class="n">Atom</span> <span class="n">Specifications</span>
<span class="n">ONTO</span> <span class="n">Atom</span> <span class="n">Specifications</span>
<span class="n">RENAME</span> <span class="n">n</span>
<span class="n">EQUALATOM</span>
<span class="n">METHOD</span>
<span class="n">END</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">MATCH</span>
<span class="n">METHOD</span> <span class="mi">3</span>
<span class="n">MAP</span> <span class="n">RESIDUE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ONTO</span> <span class="n">RESIDUE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">RENAME</span> <span class="mi">100</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This routine  uses the mapping routines in REGULARISE to compare
two residues.  Unlike REGULARISE itself, the user does not have
to list the atoms in any special order - the routine attempts to make
pairwise assigments. Initially this is done via a topographical search,
and refined by minimising cartesian residuals whenever degeneracy is
found.</p>
<p><strong>MAP</strong></p>
<p>The following list of atoms is the ideal fragment with ideal atom
types and numbers</p>
<p><strong>ONTO</strong></p>
<p>The following list of atoms is the fragment ot be compared with the
ideal.  There must be the same number of atoms in both fragments, but
not necessarily in the same order. Inclusion of any Q atoms sets the
EQUALATOM flag, ie the atom types are ignored.</p>
<p><strong>EQUALATOM</strong></p>
<p>If this parameter is included, the atom types in the “ONTO” list are
ignored - they can even be Q atoms</p>
<p><strong>METHOD</strong></p>
<p>One of the METHODS available in REGULARISE</p>
<p>The default is method 4.</p>
<p><strong>RENAME  n</strong></p>
<p>If the mapping is succerssful, atoms in the ONTO list are given the
same type as the corresponding atom in the MAP list, and the same SERIAL
plus “n”.</p>
<p><strong>OUTPUT LIST= PUNCH=</strong></p>
<p>lIST takes the values OFF, LOW, MEDIUM, HIGH.</p>
<p>unch takes the values OFF, RESULTS</p>
<p>Results creates an ASCII file that could be processed by EXCEL or
other spreadsheet.
The fields are tab-deliminated, and have the following attributes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CSD_CIF_BAZHAM01</span>  <span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="n">Asymmetric</span>  <span class="p">(</span><span class="n">potential</span> <span class="n">internal</span> <span class="n">symmetry</span><span class="p">)</span>
<span class="p">:</span><span class="n">Centroids</span>   <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span><span class="n">A</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span><span class="n">B</span>
<span class="p">:</span><span class="n">Axes</span> <span class="n">of</span> <span class="n">Inertia</span>   <span class="p">(</span><span class="n">long</span><span class="p">,</span> <span class="n">medium</span><span class="p">,</span> <span class="n">short</span><span class="p">)</span><span class="n">A</span> <span class="ow">and</span> <span class="p">(</span><span class="n">long</span><span class="p">,</span> <span class="n">medium</span><span class="p">,</span> <span class="n">short</span><span class="p">)</span><span class="n">B</span>
<span class="p">:</span><span class="n">Sum</span> <span class="n">dev</span> <span class="n">sq</span>  <span class="n">After</span> <span class="n">matching</span><span class="p">,</span> <span class="n">Sum</span><span class="p">(</span><span class="n">delta_x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">y</span> <span class="ow">and</span> <span class="n">z</span><span class="o">.</span>  <span class="n">Sum</span> <span class="n">Separation</span><span class="o">^</span><span class="mi">2</span>
<span class="p">:</span><span class="n">RMS</span> <span class="n">dev</span>  <span class="n">As</span> <span class="n">above</span><span class="p">,</span> <span class="n">but</span> <span class="n">root</span> <span class="n">mean</span> <span class="n">square</span> <span class="n">deviation</span> <span class="n">rather</span> <span class="n">than</span> <span class="n">sums</span>
<span class="p">:</span><span class="n">RMS</span> <span class="n">bond</span> <span class="ow">and</span> <span class="n">tors</span> <span class="n">dev</span>  <span class="n">RMS</span> <span class="n">differences</span> <span class="n">of</span> <span class="n">equivalent</span> <span class="n">bond</span> <span class="n">lengths</span> <span class="ow">and</span> <span class="n">torsion</span> <span class="n">angles</span>
<span class="p">:</span><span class="n">Min</span> <span class="ow">and</span> <span class="n">Max</span> <span class="n">bond</span> <span class="n">dev</span>  <span class="n">Minimum</span> <span class="ow">and</span> <span class="n">maximum</span> <span class="n">bond</span> <span class="n">length</span> <span class="n">differences</span><span class="o">.</span>
<span class="p">:</span><span class="n">Min</span> <span class="ow">and</span> <span class="n">Max</span> <span class="n">tors</span> <span class="n">dev</span>   <span class="n">Minimum</span> <span class="ow">and</span> <span class="n">maximum</span> <span class="n">torsion</span> <span class="n">angle</span> <span class="n">differences</span><span class="o">.</span>
<span class="p">:</span><span class="n">Mean</span> <span class="o">&amp;</span> <span class="n">delta</span> <span class="n">Centroids</span>  <span class="n">Mean</span><span class="p">(</span><span class="n">xA</span><span class="p">,</span><span class="n">xB</span><span class="p">),</span> <span class="p">(</span><span class="n">yA</span><span class="p">,</span><span class="n">yB</span><span class="p">),</span> <span class="p">(</span><span class="n">zA</span><span class="p">,</span><span class="n">zB</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xA</span><span class="o">-</span><span class="n">xB</span><span class="p">),</span> <span class="p">(</span><span class="n">yA</span><span class="o">-</span><span class="n">yB</span><span class="p">),</span> <span class="p">(</span><span class="n">zA</span><span class="o">-</span><span class="n">zB</span><span class="p">)</span>
<span class="p">:</span><span class="n">Transformation</span>   <span class="p">(</span><span class="mi">3</span><span class="n">x3</span><span class="p">)</span> <span class="n">transformation</span> <span class="n">matrix</span>
<span class="p">:</span><span class="n">Det</span> <span class="ow">and</span> <span class="n">trace</span>   <span class="n">Determinant</span> <span class="ow">and</span> <span class="n">trace</span> <span class="n">of</span> <span class="n">matrix</span>
<span class="p">:</span><span class="n">Closeness</span> <span class="n">to</span> <span class="n">ideal</span> <span class="n">rotation</span>  <span class="n">RMS</span> <span class="n">of</span> <span class="n">the</span> <span class="n">deviations</span> <span class="n">of</span> <span class="n">matrix</span> <span class="n">elements</span> <span class="kn">from</span> <span class="nn">integers</span>
<span class="p">:</span><span class="n">Closeness</span> <span class="n">to</span> <span class="n">group</span> <span class="n">operator</span>  <span class="n">RMS</span> <span class="n">of</span> <span class="n">the</span> <span class="n">deviations</span> <span class="n">of</span> <span class="n">translations</span> <span class="kn">from</span> <span class="nn">integers</span>
<span class="p">:</span><span class="n">Combined</span> <span class="n">measure</span> <span class="n">of</span> <span class="n">closeness</span>
<span class="p">:</span><span class="n">Rworst</span> <span class="o">&amp;</span> <span class="n">Raverage</span>  <span class="n">Worst</span> <span class="ow">and</span> <span class="n">Average</span> <span class="k">for</span> <span class="n">to</span> <span class="n">an</span> <span class="n">operator</span><span class="p">,</span> <span class="n">operator</span> <span class="n">identifier</span>
<span class="p">:</span><span class="n">Symmetry</span>  <span class="n">Local</span> <span class="n">point</span> <span class="n">group</span> <span class="n">relating</span> <span class="n">molecules</span><span class="o">.</span>
<span class="p">:</span><span class="n">Pseudo</span>  <span class="n">Pseudo</span> <span class="n">point</span> <span class="n">group</span>  <span class="n">relating</span> <span class="n">molecules</span><span class="o">.</span>
<span class="p">:</span><span class="n">Operator</span>  <span class="n">Pseudo</span> <span class="n">symmetry</span> <span class="n">operator</span><span class="o">.</span>
<span class="p">:</span><span class="n">No_Atoms</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">atoms</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">molecule</span><span class="o">.</span>
<span class="p">:</span><span class="n">S</span><span class="o">.</span><span class="n">G</span><span class="o">.</span>  <span class="n">Original</span> <span class="n">space</span> <span class="n">group</span><span class="o">.</span>
<span class="p">:</span><span class="n">Cell</span>  <span class="n">Original</span> <span class="n">unit</span> <span class="n">cell</span> <span class="n">parameters</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>Comparing lots of Z’=2 structures</strong></p>
<p>If one has a single cif file containing many Z’=2 structures, the whole
file can be processed structure-by-structure automatically, with
automatic matching of the structures. See
Structure matching: measures of similarity and pseudosymmetry.
A.  Collins, R. I.  Cooper and D. J.  Watkin.
Journal of Applied Crystallography 2006;39(6):842-849.</p>
<p>To do this, extract the structures from the CSD saving the results to
a single file using the operation ‘Import CIF file’ from the drop-down
menu ‘X-ray Data’.  Before starting,
ensure that a file titled “cifproc.dat” is in the same folder as the
composite cif file and that it says:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">edit</span>
<span class="n">mon</span> <span class="n">off</span>
<span class="nb">list</span> <span class="n">off</span>
<span class="n">insert</span> <span class="n">resi</span>
<span class="n">sel</span> <span class="nb">type</span> <span class="n">ne</span> <span class="n">h</span>
<span class="n">end</span>
<span class="o">/</span><span class="n">match</span>
<span class="n">output</span> <span class="n">punch</span><span class="o">=</span><span class="n">results</span>
<span class="nb">map</span> <span class="n">resi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">onto</span> <span class="n">resi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">end</span>
<span class="o">/</span><span class="n">purge</span>
<span class="n">end</span>
</pre></div>
</div>
<p><strong>Output from MATCH</strong></p>
<p>If the output is set to PUNCH=RESULTS, a summary of the result of
each matching operation is copied to the Punch file (Usually BFILE.PCH)
All the information for each match is appended to a single line. The
items are “tab deliminated” to facilitate reading them into
spreadsheets. The keywords are preceeded by a “:” so that an editor can
be used to break the line as necessary.</p>
<p>Description of output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CSD_CIF_AANHOX01</span>
<span class="p">:</span><span class="n">Centroids</span>    <span class="p">(</span><span class="n">the</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">and</span> <span class="n">z</span> <span class="n">coordinates</span> <span class="n">of</span> <span class="n">both</span> <span class="n">centroids</span><span class="p">)</span>
<span class="p">:</span><span class="n">Axes</span> <span class="n">of</span> <span class="n">Inertia</span>    <span class="p">(</span><span class="n">the</span> <span class="n">three</span> <span class="n">axes</span> <span class="n">of</span> <span class="n">inertia</span> <span class="n">of</span> <span class="n">both</span> <span class="n">molecules</span><span class="p">)</span>
<span class="p">:</span><span class="n">Sum</span> <span class="n">dev</span> <span class="n">sq</span>   <span class="p">(</span><span class="nb">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="n">squares</span> <span class="n">of</span> <span class="n">the</span> <span class="n">deviations</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="ow">and</span> <span class="n">delta</span><span class="o">-</span><span class="n">d</span><span class="p">)</span>
<span class="p">:</span><span class="n">RMS</span> <span class="n">dev</span>   <span class="p">(</span><span class="n">rms</span> <span class="n">deviations</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="ow">and</span> <span class="n">delta</span><span class="o">-</span><span class="n">d</span><span class="p">)</span>
<span class="p">:</span><span class="n">RMS</span> <span class="n">bond</span> <span class="ow">and</span> <span class="n">tors</span> <span class="n">dev</span>
<span class="p">:</span><span class="n">Min</span> <span class="ow">and</span> <span class="n">Max</span> <span class="n">bond</span> <span class="n">dev</span>
<span class="p">:</span><span class="n">Min</span> <span class="ow">and</span> <span class="n">Max</span> <span class="n">tors</span> <span class="n">dev</span>
<span class="p">:</span><span class="n">Sum</span> <span class="o">&amp;</span> <span class="n">delta</span> <span class="n">Centroids</span>
<span class="p">:</span><span class="n">Transformation</span>    <span class="p">(</span><span class="n">matrix</span> <span class="n">transforming</span> <span class="n">one</span> <span class="n">molecule</span> <span class="n">to</span> <span class="n">the</span> <span class="n">other</span><span class="p">)</span>
<span class="p">:</span><span class="n">Det</span> <span class="ow">and</span> <span class="n">trace</span>     <span class="p">(</span><span class="n">of</span> <span class="n">the</span> <span class="n">matrix</span> <span class="o">-</span> <span class="o">-</span><span class="n">ve</span> <span class="n">indicates</span> <span class="n">inversion</span><span class="p">)</span>
<span class="p">:</span><span class="n">Closeness</span> <span class="n">to</span> <span class="n">ideal</span> <span class="n">rotation</span>
<span class="p">:</span><span class="n">Closeness</span> <span class="n">to</span> <span class="n">group</span> <span class="n">operator</span>
<span class="p">:</span><span class="n">Combined</span> <span class="n">measure</span> <span class="n">of</span> <span class="n">closeness</span>
<span class="p">:</span><span class="n">Rworst</span> <span class="o">&amp;</span> <span class="n">Raverage</span>
<span class="p">:</span><span class="n">Symmetry</span>
<span class="p">:</span><span class="n">Pseudo</span>
<span class="p">:</span><span class="n">Operator</span>
<span class="p">:</span><span class="n">No_Atoms</span>
<span class="p">:</span><span class="n">S</span><span class="o">.</span><span class="n">G</span><span class="o">.</span>
<span class="p">:</span><span class="n">Cell</span>
</pre></div>
</div>
<p>Example of output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CSD_CIF_AANHOX01</span>
<span class="p">:</span><span class="n">Centroids</span>       <span class="mf">0.9169</span> <span class="mf">0.6281</span> <span class="mf">0.3346</span> <span class="mf">1.0255</span> <span class="mf">0.8741</span> <span class="mf">0.8117</span>
<span class="p">:</span><span class="n">Axes</span> <span class="n">of</span> <span class="n">Inertia</span> <span class="mf">59.3690</span> <span class="mf">10.0284</span> <span class="mf">0.1392</span> <span class="mf">59.1659</span> <span class="mf">10.1380</span> <span class="mf">0.0762</span>
<span class="p">:</span><span class="n">Sum</span> <span class="n">dev</span> <span class="n">sq</span>      <span class="mf">0.0014</span> <span class="mf">0.0014</span> <span class="mf">0.0726</span> <span class="mf">0.0754</span>
<span class="p">:</span><span class="n">RMS</span> <span class="n">dev</span>         <span class="mf">0.0115</span> <span class="mf">0.0114</span> <span class="mf">0.0812</span> <span class="mf">0.0828</span>
<span class="p">:</span><span class="n">RMS</span> <span class="n">bond</span> <span class="ow">and</span> <span class="n">tors</span> <span class="n">dev</span> <span class="mf">0.0040</span> <span class="mf">2.3978</span>
<span class="p">:</span><span class="n">Min</span> <span class="ow">and</span> <span class="n">Max</span> <span class="n">bond</span> <span class="n">dev</span>  <span class="mf">0.0003</span> <span class="mf">0.0094</span>
<span class="p">:</span><span class="n">Min</span> <span class="ow">and</span> <span class="n">Max</span> <span class="n">tors</span> <span class="n">dev</span>  <span class="mf">0.2952</span> <span class="mf">6.1112</span>
<span class="p">:</span><span class="n">Sum</span> <span class="o">&amp;</span> <span class="n">delta</span> <span class="n">Centroids</span> <span class="mf">0.9712</span> <span class="mf">0.7511</span> <span class="mf">0.5731</span> <span class="mf">0.1086</span> <span class="mf">0.2461</span> <span class="mf">0.4771</span>
<span class="p">:</span><span class="n">Transformation</span> <span class="mf">0.9662</span> <span class="mf">0.1296</span> <span class="o">-</span><span class="mf">0.071</span> <span class="o">-</span><span class="mf">0.237</span> <span class="mf">0.961</span> <span class="mf">0.146</span> <span class="o">-</span><span class="mf">0.476</span> <span class="mf">0.292</span> <span class="o">-</span><span class="mf">0.960</span>
<span class="p">:</span><span class="n">Det</span> <span class="ow">and</span> <span class="n">trace</span> <span class="o">-</span><span class="mf">1.0000</span> <span class="mf">0.9679</span>
<span class="p">:</span><span class="n">Closeness</span> <span class="n">to</span> <span class="n">ideal</span> <span class="n">rotation</span> <span class="mf">0.21507</span>
<span class="p">:</span><span class="n">Closeness</span> <span class="n">to</span> <span class="n">group</span> <span class="n">operator</span> <span class="mf">0.21567</span>
<span class="p">:</span><span class="n">Combined</span> <span class="n">measure</span> <span class="n">of</span> <span class="n">closeness</span> <span class="mf">0.21522</span>
<span class="p">:</span><span class="n">Rworst</span> <span class="o">&amp;</span> <span class="n">Raverage</span> <span class="mf">0.203432098</span> <span class="mf">0.186725736</span> <span class="mi">10</span>
<span class="p">:</span><span class="n">Symmetry</span> <span class="n">m</span>
<span class="p">:</span><span class="n">Pseudo</span> <span class="n">m</span>
<span class="p">:</span><span class="n">Operator</span> <span class="mf">0.11</span><span class="o">+</span><span class="n">X</span> <span class="mf">0.25</span><span class="o">+</span><span class="n">Y</span> <span class="mf">1.15</span><span class="o">-</span><span class="n">Z</span>
<span class="p">:</span><span class="n">No_Atoms</span> <span class="mi">11</span>
<span class="p">:</span><span class="n">S</span><span class="o">.</span><span class="n">G</span><span class="o">.</span> <span class="n">P</span> <span class="n">N</span> <span class="n">A</span> <span class="mi">21</span>
<span class="p">:</span><span class="n">Cell</span> <span class="mf">7.5570</span> <span class="mf">11.4580</span> <span class="mf">17.6020</span> <span class="mf">90.0000</span> <span class="mf">90.0000</span> <span class="mf">90.0000</span>
</pre></div>
</div>
</section>
<section id="calculation-of-interatomic-bonds-bondcalc">
<span id="list41"></span><span id="index-24"></span><span id="index-23"></span><h2>Calculation of interatomic bonds - \BONDCALC<a class="headerlink" href="#calculation-of-interatomic-bonds-bondcalc" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">BONDCALC</span>
 <span class="n">END</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">BONDCALC</span> <span class="n">FORCE</span>
<span class="n">END</span>
</pre></div>
</div>
<p>This routine calculates a list of unique bonds between
atoms in LIST 5 including bonds to symmetry related atoms.
The bonds are stored in LIST 41.</p>
<section id="id1">
<h3>Method of calculation<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<blockquote>
<div><p>The BONDCALC routine uses the atomic positions from LIST 5 (the
model parameters, see <a class="reference internal" href="#list05"><span class="std std-ref">Input of atoms and other parameters  -  LIST 5</span></a>) (together
with cell (LIST 1, see <a class="reference internal" href="initial.html#list01"><span class="std std-ref">Input of the cell parameters  -  LIST 1</span></a>) and spacegroup information
(LIST 2, see <a class="reference internal" href="initial.html#list02"><span class="std std-ref">Input of the symmetry data  -  LIST 2</span></a>),
the covalent radii from LIST 29 (atomic properties, see <a class="reference internal" href="initial.html#list29"><span class="std std-ref">Input of the contents of the asymmetric unit  -  LIST 29</span></a>), and any
additional bonding information in LIST 40 to calculate a list of bonds.
The algorithm and tolerances used depend upon settings in LIST 40.</p>
<p>LIST 41 is only updated by \BONDCALC if there has been a change
to LISTS 5 or 40 OR if \BONDCALC FORCE is issued.</p>
</div></blockquote>
</section>
</section>
<section id="bonding-information-list-40">
<span id="list40"></span><span id="index-25"></span><h2>Bonding information - \LIST 40<a class="headerlink" href="#bonding-information-list-40" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">LIST</span> <span class="mi">40</span>
<span class="n">DEFAULTS</span> <span class="n">TOLTYPE</span><span class="o">=</span> <span class="n">TOLERANCE</span><span class="o">=</span> <span class="n">MAXBONDS</span><span class="o">=</span> <span class="n">NOSYMMETRY</span><span class="o">=</span> <span class="n">SIGCHANGE</span><span class="o">=</span>
<span class="n">READ</span> <span class="n">NELEMENTS</span><span class="o">=</span> <span class="n">NPAIRS</span><span class="o">=</span> <span class="n">NMAKE</span><span class="o">=</span> <span class="n">NBREAK</span><span class="o">=</span>
<span class="n">ELEMENT</span> <span class="n">TYPE</span><span class="o">=</span> <span class="n">RADIUS</span><span class="o">=</span> <span class="n">MAXBONDS</span><span class="o">=</span>
<span class="n">PAIR</span> <span class="n">TYPE1</span><span class="o">=</span> <span class="n">TYPE2</span><span class="o">=</span> <span class="n">MIN</span><span class="o">=</span> <span class="n">MAX</span><span class="o">=</span> <span class="n">BONDTYPE</span><span class="o">=</span>
<span class="n">MAKE</span> <span class="n">TYPE</span><span class="o">=</span> <span class="n">SERIAL</span><span class="o">=</span> <span class="n">S</span><span class="o">=</span> <span class="n">L</span><span class="o">=</span> <span class="n">TX</span><span class="o">=</span> <span class="n">TY</span><span class="o">=</span> <span class="n">TZ</span><span class="o">=</span>
     <span class="n">TYPE2</span><span class="o">=</span> <span class="n">SERIAL2</span><span class="o">=</span> <span class="n">S2</span><span class="o">=</span> <span class="n">L2</span><span class="o">=</span> <span class="n">TX2</span><span class="o">=</span> <span class="n">TY2</span><span class="o">=</span> <span class="n">TZ2</span><span class="o">=</span> <span class="n">BONDTYPE</span><span class="o">=</span>
<span class="n">BREAK</span> <span class="n">TYPE</span><span class="o">=</span> <span class="n">SERIAL</span><span class="o">=</span> <span class="n">S</span><span class="o">=</span> <span class="n">L</span><span class="o">=</span> <span class="n">TX</span><span class="o">=</span> <span class="n">TY</span><span class="o">=</span> <span class="n">TZ</span><span class="o">=</span>
      <span class="n">TYPE2</span><span class="o">=</span> <span class="n">SERIAL2</span><span class="o">=</span> <span class="n">S2</span><span class="o">=</span> <span class="n">L2</span><span class="o">=</span> <span class="n">TX2</span><span class="o">=</span> <span class="n">TY2</span><span class="o">=</span> <span class="n">TZ2</span><span class="o">=</span>
<span class="n">END</span>
</pre></div>
</div>
<p><strong>DEFAULTS TOLTYPE= TOLERANCE= MAXBONDS= NOSYMMETRY= SIGCHANGE=</strong></p>
<p>This directive may only appear once. It affects the algorithm used
to update LIST 41.</p>
<p><em>TOLTYPE=</em></p>
<p>A value of 1 (default) causes \BONDCALC to use as a threshold for
bonding, the sum of the covalent radii * the tolerance given.
A value of 0 causes \BONDCALC to use the sum of the covalent radii + the
tolerance given (in Angstroms), as a threshold.</p>
<p><em>TOLERANCE=</em></p>
<p>The tolerance to be used in the \BONDCALC calculation as a threshold
for bonds. Exact use depends on the value of the TOLTYPE keyword above.</p>
<p><em>MAXBONDS=</em></p>
<p>Specifies the maximum number of bonds that may be formed to an atom. The
BONDCALC calculation proceeds through the list of atoms searching for bonds,
according to the TOLERANCE criteria. If more than MAXBONDS bonds are found,
the best MAXBONDS will be kept. Best bonds are those where the sum of the
covalent radii is closest to the actual bond length. (Where a PAIR
directive has been used, the best are the closest to the mean of the min and
max values  on the PAIR directive.)
Note well: The calculation proceeds through the list of atoms, so bonds
are formed from atoms near the top of the list to those lower down. While
atoms lower down will still only form at most MAXBONDS bonds, they are
less likely to be the ‘best’ bonds since they are formed from atoms higher
up the list. E.g. You have an H right at the end of the list, and you
set MAXBONDS=1 for H (see ELEMENT). If the first atom forms a bond to that
H, then no more bonds can be formed to that H even if they are better.
If the H were at the top of the list it would get the choice of which bonds
to pick. This is fairly unimportant stuff, it is rare that there will
be ambiguities over whether something is bonded or not. The default value
of MAXBONDS is therefore 15.</p>
<p><em>NOSYMMETRY=</em></p>
<p>0 (default) searches for all symmetry related bonds.
1 ignores symmetry, will not find bonds across operators, may speed
up bond bond calculation slightly.</p>
<p><em>SIGCHANGE=</em></p>
<p>Number of angstroms that any atom in LIST 5 must move during refinement
for it to be considered a significant change resulting in a recalculation
of bonding.</p>
<p><strong>READ NELEMENTS= NPAIRS= NMAKE= NBREAK=</strong></p>
<p>Specify the number of ELEMENT, PAIR, MAKE and BREAK directives that are
to follow.</p>
<p><strong>ELEMENT TYPE= RADIUS= MAXBONDS=</strong></p>
<p>Override the covalent radius in L29 and the MAXBONDS value on the DEFAULTS
directive for a specific element.</p>
<p><em>TYPE=</em></p>
<p>The element type. E.g. C</p>
<p><em>RADIUS=</em></p>
<p>The covalent radius to use for this element.</p>
<p><em>MAXBONDS=</em></p>
<p>The maximum number of bonds to this element.</p>
<p>DPAIR TYPE1= TYPE2= MIN= MAX= BONDTYPE=
Override the covalent based calculation altogether.</p>
<p><em>TYPE1=</em></p>
<p>An element type, e.g. C</p>
<p><em>TYPE2=</em></p>
<p>An element type, e.g. O</p>
<p><em>MIN=</em></p>
<p>The minimum length of a bond.</p>
<p><em>MAX=</em></p>
<p>The maximum length of a bond.</p>
<p><em>BONDTYPE=</em></p>
<p>The bondtype to be assigned to this bond. BONDCALC will eventually have a
go at bond type assignment, if you are forced to add in extra PAIR
commands then there is not much chance that the assignment will be correct
so it can be specified here. Use 0 for unknown.</p>
<p>More than one pair of the same elements can be used at once:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span>
  <span class="n">PAIR</span> <span class="n">C</span> <span class="n">O</span> <span class="mf">1.0</span> <span class="mf">1.2</span> <span class="n">BONDTYPE</span><span class="o">=</span><span class="mi">2</span>
  <span class="n">PAIR</span> <span class="n">C</span> <span class="n">O</span> <span class="mf">1.2</span> <span class="mf">1.4</span> <span class="n">BONDTYPE</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p><strong>MAKE TYPE= SERIAL= S= L= TX= TY= TZ= TYPE2= SERIAL2= S2= L2= TX2= TY2= TZ2= BONDTYPE=</strong></p>
<p>Makes a bond between two atoms (possibly symmetry related).</p>
<p><em>TYPE= TYPE2=</em></p>
<p>An element type, e.g. C.</p>
<p><em>SERIAL= SERIAL2=</em></p>
<p>The serial number of the atom. (From List 5, atomic parameters).</p>
<p><em>S= S2=</em></p>
<p>The number of the symmetry matrix used from List 2 (list of space group
symmetry operators, see section <a class="reference internal" href="initial.html#list02"><span class="std std-ref">Input of the symmetry data  -  LIST 2</span></a>) (default, unity = 1).
Negative indicates centre of symmetry applied aswell.</p>
<p><em>L= L2=</em></p>
<p>The number of the non-primitive lattice translation from List 2. (default =1,
see section <a class="reference internal" href="initial.html#list02"><span class="std std-ref">Input of the symmetry data  -  LIST 2</span></a>)</p>
<p><em>TX= TY= TZ= TX2= TY2= TZ2=</em></p>
<p>Translations from asymmetric unit co-ordinates.</p>
<p><em>BONDTYPE=</em></p>
<p>The bondtype to be assigned to this bond. BONDCALC will eventually have a
go at bond type assignment, if you are forced to add in extra MAKE
commands then there is not much chance that the assignment will be correct
so it can be specified here. Use 0 for unknown.</p>
<p><strong>BREAK TYPE= SERIAL= S= L= TX= TY= TZ= TYPE2= SERIAL2= S2= L2= TX2= TY2= TZ2=</strong></p>
<p>As for MAKE, but without the BONDTYPE keyword.</p>
</section>
<section id="bonding-information-bonding">
<span id="index-26"></span><h2>Bonding information - \BONDING<a class="headerlink" href="#bonding-information-bonding" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">BONDING</span> <span class="n">ACTION</span>
<span class="n">DEFAULTS</span> <span class="n">TOLTYPE</span><span class="o">=</span> <span class="n">TOLERANCE</span><span class="o">=</span> <span class="n">MAXBONDS</span><span class="o">=</span> <span class="n">NOSYMMETRY</span><span class="o">=</span> <span class="n">SIGCHANGE</span><span class="o">=</span>
<span class="n">ELEMENT</span> <span class="n">TYPE</span><span class="o">=</span> <span class="n">RADIUS</span><span class="o">=</span> <span class="n">MAXBONDS</span><span class="o">=</span>
<span class="n">PAIR</span> <span class="n">TYPE1</span><span class="o">=</span> <span class="n">TYPE2</span><span class="o">=</span> <span class="n">MIN</span><span class="o">=</span> <span class="n">MAX</span><span class="o">=</span> <span class="n">BONDTYPE</span><span class="o">=</span>
<span class="n">MAKE</span>  <span class="n">atom</span><span class="o">-</span><span class="n">specification</span> <span class="n">TO</span> <span class="n">atom</span><span class="o">-</span><span class="n">specification</span> <span class="n">bondtype</span>
<span class="n">BREAK</span> <span class="n">atom</span><span class="o">-</span><span class="n">specification</span> <span class="n">TO</span> <span class="n">atom</span><span class="o">-</span><span class="n">specification</span>
<span class="n">END</span>
</pre></div>
</div>
<p>THis is a more user-friendly alternative to inputting a LIST 40.
Directive syntax is like \LIST 40 with the following exceptions:</p>
<ol class="arabic simple">
<li><p>ACTION. This can take two values:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">REPLACE</span> <span class="p">(</span><span class="n">Default</span><span class="p">,</span> <span class="ow">and</span> <span class="n">replace</span> <span class="n">previous</span> <span class="n">LIST</span> <span class="mi">40</span> <span class="k">with</span> <span class="n">a</span> <span class="n">new</span> <span class="n">on</span><span class="p">)</span>
<span class="n">EXTEND</span>  <span class="p">(</span><span class="n">adds</span> <span class="n">new</span> <span class="n">commands</span> <span class="n">to</span> <span class="n">end</span> <span class="n">of</span> <span class="n">existing</span> <span class="n">LIST</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The MAKE and BREAK directives look like this:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MAKE</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">TO</span> <span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="mi">8</span>
<span class="n">BREAK</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">TO</span> <span class="n">H</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<p>Symmetry may be specified in the standard CRYSTALS way, the numbers
in parenthesis are serial,S,L,Tx,Ty,Tz (see above) the list may be
truncated when the rest are default values: (serial,1,1,0,0,0):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MAKE</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="n">TO</span> <span class="n">C</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="mi">4</span>
</pre></div>
</div>
<p>3) The READ directive need not be given. This makes it easier to edit
text files containing the command as you don’t have to remember to alter
the values on the READ directive.</p>
<p>3) The command may be given as \BONDING EXTEND, in which case it takes
any directives given and adds them to the existing LIST 40.</p>
</section>
<section id="printing-of-list-40">
<h2>Printing of LIST 40<a class="headerlink" href="#printing-of-list-40" title="Link to this heading"></a></h2>
<p>LIST 40 may be listed with either</p>
<section id="print-40">
<h3>\PRINT 40<a class="headerlink" href="#print-40" title="Link to this heading"></a></h3>
<blockquote>
<div><p>or</p>
</div></blockquote>
</section>
<section id="summary-40">
<h3>\SUMMARY 40<a class="headerlink" href="#summary-40" title="Link to this heading"></a></h3>
<blockquote>
<div><p>LIST 40 may be punched with</p>
</div></blockquote>
</section>
<section id="punch-40">
<h3>\PUNCH 40<a class="headerlink" href="#punch-40" title="Link to this heading"></a></h3>
<blockquote>
<div><p>which will produce a standard List 40 in CRYSTALS format, or</p>
</div></blockquote>
</section>
<section id="punch-40-b">
<h3>\PUNCH 40 B<a class="headerlink" href="#punch-40-b" title="Link to this heading"></a></h3>
<blockquote>
<div><p>which will produce a \BONDING command which is easier to edit.</p>
</div></blockquote>
</section>
</section>
<section id="creating-a-null-list-40">
<h2>Creating a null LIST 40<a class="headerlink" href="#creating-a-null-list-40" title="Link to this heading"></a></h2>
<p>A null LIST 40, containing no extra information, may be created with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">LIST</span> <span class="mi">40</span>
<span class="n">END</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">BONDING</span>
<span class="n">END</span>
</pre></div>
</div>
</section>
<section id="printing-of-list-41">
<h2>Printing of LIST 41<a class="headerlink" href="#printing-of-list-41" title="Link to this heading"></a></h2>
<p>LIST 41 may be listed with either</p>
<section id="print-41">
<h3>\PRINT 41<a class="headerlink" href="#print-41" title="Link to this heading"></a></h3>
<blockquote>
<div><p>or</p>
</div></blockquote>
</section>
<section id="summary-41">
<h3>\SUMMARY 41<a class="headerlink" href="#summary-41" title="Link to this heading"></a></h3>
<blockquote>
<div><p>Issuing \BONDCALC when there is no LIST 40 will cause a null list 40
to be created.</p>
</div></blockquote>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reflectiondata.html" class="btn btn-neutral float-left" title="Reflection Data Input" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sfls.html" class="btn btn-neutral float-right" title="Structure Factors And Least Squares" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Richard Cooper, David Watkin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>