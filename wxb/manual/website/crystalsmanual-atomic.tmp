<!-- XTLVAR title="Atomic And Structural Parameters" -->
<!-- XTLVAR comment="Atomic And Structural Parameters" -->
<!-- XTLVAR cvssource="manual/crystals.man" -->
<H1>Crystals Manual</H1>
<H2>Chapter 6: Atomic And Structural Parameters</H2>
<DL><DT>
<DD><A HREF="crystalsmanual-atomic.html#atomic.scope">6.1: Scope of the atomic and structural parameters Section</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.atomspec">6.2: Specifications of atoms and other parameters</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.atominput">6.3: Input of atoms and other parameters  -  LIST 5</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.print5">6.4: Printing and punching list 5</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.edit5">6.5: Editing structural parameters -  \EDIT</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.regroup">6.6: Reorganisation of lists 5 and 10  -  \REGROUP</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.collect">6.7: Repositioning of atoms  -  \COLLECT</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.origin">6.8: Shifting the molecule to a permitted alternative origin - \ORIGIN</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.convert">6.9: Conversion of temperature factors - \CONVERT</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.hplace">6.10: Hydrogen placing - \HYDROGENS</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.perhydro">6.11: Perhydrogenation - \PERHYDRO</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.hnumber">6.12: Hydrogen re-numbering - \HNAME</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.regularise">6.13: Regularisation of atomic groups - \REGULARISE</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.MATCH">6.14: Map two atomic groups together - \MATCH</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.bondcalc">6.15: Calculation of interatomic bonds - \BONDCALC</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.list40">6.16: Bonding information - \LIST 40</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.bonding">6.17: Bonding information - \BONDING</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.print40">6.18: Printing of LIST 40</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.null list 40">6.19: Creating a null LIST 40</A><br>
<DD><A HREF="crystalsmanual-atomic.html#atomic.print41">6.20: Printing of LIST 41</A><br>
</DL>

<A NAME="atomparams"> </A>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.scope">6.1: Scope of the atomic and structural parameters Section</A></H3></CENTER>

<BR>
<P> The areas covered are:
<BR>

<pre>
 Specifications of atoms and other parameters
 Input of atoms and other parameters              - \LIST 5
 Re-order the atom list                           - \REGROUP
 Collect atoms together by symmetry               - \COLLECT
 Move the structure into the cell                 - \ORIGIN
 Modification of lists 5 and 10 on the disc       - \EDIT
 Applying permitted origin shifts                 - \ORIGIN
 Conversion of temperature factors                - \CONVERT
 Hydrogen placing                                 - \HYDROGENS
 Per-hydrogenation                                - \PERHYDRO
 Re-numbering hydrogen atoms                      - \HNAME
 Regularisation of groups in LIST 5               - \REGULARISE
</pre><p><BR>
<BR>
<A NAME="Atom name syntax"> </A>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.atomspec">6.2: Specifications of atoms and other parameters</A></H3></CENTER>

<P>There is a consistent syntax thoughout CRYSTALS for refering to atoms
 and atomic parameters. This was referred to briefly in Chapter 1, and
 will be defined more fully here.
<BR>&nbsp;<BR>
<div class="instruction"><strong><u>ATOM SPECIFICATION</u></strong><br>
<P>There are three different but related ways of specifying an atom
 or a group of atoms.
<div class="directive"><strong><i>TYPE(SERIAL,S,L,TX,TY,TZ)</i></strong>
<P>This specification defines one atom.
 The various parts of the expression are :
<div class="parameter"><i>TYPE</i>
 The atom type, defined in Chapter 1 in the section on form-factors.
</div>
<div class="parameter"><i>SERIAL</i>
 The serial number, in the range 1-9999
</div>
<div class="parameter"><i>Checking of serial numbers</i>
<P>Atoms of the same type are distinguished from one another by having
 different serial numbers. However, at no stage is a check made to ensure
 that there is not more than one atom in LIST 5 (atomic parameters) with 
 the same type and
 serial number. If a routine is searching for an atom with a given type
 and serial number, the first atom found will always be taken, and any
 subsequent atoms with the same type and serial number will be ignored.
<P>Serial numbers are considered to be different if they differ from
 each other by more than 0.0005.

</div>
<div class="parameter"><i>S</i>
 'S' specifies a symmetry operator provided
 in the unit cell symmetry LIST (LIST 2 - see section !elabel!LIST02!).
 'S' may take any value between '-NSYM' and
 '+NSYM', except zero, where 'NSYM' is the
 number of symmetry equivalent positions
 provided in LIST 2.
 if 'S' is less than zero, the coordinates
 of the atom stored in LIST 5 are negated (i.e.
 inverted through a centre of symmetry at
 the origin) and then multiplied by the
 operator specified by the absolute value of
 'S' to generate the new atomic coordinates.
 'S' may be less than zero even if the space
 group is non-centrosymmetric ( <i>i.e.</i> introduce a false centre),
 but must not be greater than 'NSYM'.
 The default value for 'S' is '1', specifying the
 first matrix in LIST 2, usually the unit matrix.

</div>
<div class="parameter"><i>L</i>
 'L' specifies the non-primitive lattice translation
 that is to be added after the coordinates have been
 modified by the operations given by 'S'.
 'L' must not be greater than the number of allowed
 non-primitive translations in the space group.
 The translations provided by 'L' depend on
 the lattice type and are given by :

<pre>
          L=    1             2                3                4

      P       0,0,0
      I       0,0,0      1/2,1/2,1/2
      R       0,0,0      1/3,2/3,2/3      2/3,1/3,1/3
      F       0,0,0        0,1/2,1/2      1/2, 0 ,1/2      1/2,1/2,0
      A       0,0,0        0,1/2,1/2
      B       0,0,0      1/2, 0 ,1/2
      C       0,0,0      1/2,1/2, 0
</pre><p><BR>
        the default value of 'L' is '1', specifying no
        non-primitve lattice translation.

</div>
<div class="parameter"><i>TX,TY,TZ</i>
 Unit cell translation along the x,y and z directions.
<BR>
 The unit cell translations are added to the
 coordinates after the 'S' and 'L' operations
 have been performed.
 The translations may be positive or
 negative, but must refer to complete
 unit cell shifts.
 The default values for 'TX', 'TY' and 'TZ'
 are all zero, giving no unit cell translations.
<BR>
 The symmetry operations are applied in the order :

<pre>
      1.  Centre of symmetry if 'S' negative
      2.  Symmetry operator 'S'
      3.  Non-primitve lattice translation
      4.  Whole unit cell translations 'T(X)', 'T(Y)', 'T(Z)'.

    i.e.
           X'=  [R(s)](+X) + t(s) + L + T(X) + T(Y) + T(Z)
    or
           X'=  [R(s)](-X) + t(s) + L + T(X) + T(Y) + T(Z)
</pre><p><BR>
<P>The format given above is a complete atom definition.
 For convenience the definition may sometimes be shortened.
 The obligatory parts are the  TYPE  and  SERIAL.
 The remaining parameters, S,  L,  TX,  TY, TZ, are optional.
<P>An optional parameter taking its default value
 may be omitted, though its place must be marked by its associated
 comma. A series of trailing commas may be omitted.
<P>The following are all equivalent :

<pre>
      TYPE(SERIAL,1,1,0,0,0)
      TYPE(SERIAL,,,0,0,0)
      TYPE(SERIAL,1,,,,0)
      TYPE(SERIAL,,,,,)
</pre><p><BR>
<P>The values of  S ,  L ,  TX ,  TY  and  TZ  are exactly those
 output and used by the distance angles routines under the headings
  S(I) ,  L ,  T(X) ,  T(Y)  and  T(Z)  respectively.
 (See the section of the user guide on 'results of refinement').
<P>When the symmetry operators are applied, the actual values
 of  S  and  L  are checked to see that they are reasonable.
 If the values found are not reasonable, an error message will
 be output and the job terminated.
<P>In some cases, the symmetry operators are accepted on input,
 but not used by the routine. The description of the routine will state this.
<BR>
</div>
</div>
<div class="directive"><strong><i>UNTIL sequences</i></strong>
 When a group of atoms lie sequentially in the atom parameter list,
 there is an abbreviated way to refer to the group.
<pre>
      TYPE1(SERIAL1,S,L,TX,TY,TZ)  UNTIL  TYPE2(SERIAL2)
</pre><p><BR>
<P>This definition specifies all the
 atoms in the current list starting with the atom TYPE1(SERIAL1)
 The first atom in the specification must  occur before the second atom
 in the current parameter list,
 otherwise an error message will be output and the task aborted.
 If symmetry operators are used, they must be given for the first atom
 of the sequence, and will be appied to all  the atoms in the sequence.
<BR>
<pre>
      Examples

                  C(1) until C(6)

      Six atoms lying around a centre of symmetry:

                  C(1) until C(3) C(1,-1) UNTIL C(3)
</pre><p><BR>
</div>
<div class="directive"><strong><i>FIRST   AND   LAST</i></strong>
<P>These specifications each define one atom.   FIRST  Refers to the
 first atom stored in LIST 5 (the model parameters) or LIST 10
 (Fourier peaks), and  LAST  refers to the last atom in the
 list. If these are used as atom designators, no serial number may be given,
 but symmetry operators may be. They may be used in until sequences.

<pre>
      examples
                  LAST
                  FIRST(x)
                  FIRST(-1) UNTIL C(16)  C(23) UNTIL LAST
</pre><p><BR>
</div>
<div class="directive"><strong><i>ALL</i></strong>
<P>This specifies all atoms in the list, can take symmetry
 operators or parameter names, but cannot be accompanied on the same line
 by any other atom specifiers.

<pre>
      examples
                  ALL
                  ALL(x)
                  ALL(-1)
</pre><p><BR>
</div>
<div class="directive"><strong><i>RESIDUE</i></strong>
<P>This specifies all atoms or parameters with the given residue number.

<pre>
      examples
                  RESIDUE(3)
                  RESIDUE(3,X's)
</pre><p><BR>
</div>
<div class="directive"><strong><i>PART</i></strong>
<P>This specifies all atoms or parameters with the given part number.

<pre>
      examples
                  PART(3001)
                  PART(3001,X's)
</pre><p><BR>
The part number is constructed from two values, the assembly number and
the group number.
<pre>
    PART NO. = 1000 * ASSEMBLY NO. + GROUP NO.
</pre><p><BR>
<BR>
The assembly number is normally zero, but a value
can be given to all atoms that are involved in a particular disordered
area of the structure. E.g. on a disordered methyl all the H atoms could
be placed in assembly number 1.
<BR>
The group number within an assembly groups together those atoms which
are simultaneously occupied. E.g. on a disordered methyl, all the H atoms
approximately 109 degrees apart would be given the same group number.
<BR>
The part and group numbers affect the default bonds that are determined
by CRYSTALS, and subsequently output in the CIF or summary file. Some
bonding rules are applied in the following order of priority:
<pre>
1. An atom in assembly 0, group 0, will bond to any other nearby atom.
2. Atoms in the same assembly, but with different, non-zero group numbers
   will not bond to each other.
3. Atoms in different assemblies with one zero group number
   will not bond to each other.
4. Atoms in the same assembly and group, but with a negative group number
   will not bond to symmetry related atoms in the same assembly and group.
5. All remaining close contacts will be bonded together.
</pre><p><BR>
Rule 3 may be ignored unless you're trying to set up something very
special. Rule 4 is useful if you have a group disordered across a
symmetry element.
<BR>
Finally, you can select all atoms in a given part of group by using the number 999 as a wild-card.

<pre>
      examples
                  PART(3999,X's)
      selects all atoms in assembly 3.
</pre><p><BR>
<BR>
</div>
<div class="directive"><strong><i>HPART</i></strong>
<P>This specifies all hydrogen (or deuterium) atoms or parameters with the given part number.

<pre>
      examples
                  HPART(3001)
                  HPART(3001,X's)
</pre><p><BR>
</div>
<div class="directive"><strong><i>NHPART</i></strong>
<P>This specifies all non-hydrogen (and deuterium) atoms or parameters with the given part number.

<pre>
      examples
                  NHPART(3001)
                  NHPART(3001,X's)
</pre><p><BR>
</div>
<div class="directive"><strong><i>TYPE</i></strong>
<P>This enable all atoms or parameters on atoms of the given type to be 
processed together.
<pre>
      example
      /EDIT
      RESET 9900 PART TYPE(H)
      END
</pre><p><BR>
<P>This puts all the hydrogen atoms into PART(9900). Since all other 
atoms are in PART(0) or a specified PART, the hydrogen will now be 
treated independently.
<BR>

<BR>&nbsp;<BR>
</div>
</div>
<div class="instruction"><strong><u>ATOMIC PARAMETER SPECIFICATION</u></strong><br>
<P>Atomic parameters have a NAME. Some directives permit the use of the
 parameter name by itself, which implies that parameter for all atoms.
 The parameter name may be combined with an atom specifier, in which case
 only the parameter for that atom (or group in an UNTIL sequence) is
 referenced. Symmetry operators may be used. The normal drop-out rules
 apply.
<div class="directive"><strong><i>Parameter NAMES</i></strong>
<P>The following NAMES are recognised.

<pre>
      X      Y      Z      OCC      U[ISO]    SPARE
      U[11]  U[22]  U[33]  U[23]    U[13]     U[12]
      X'S    U'S    UIJ'S  UII'S
</pre><p><BR>

<pre>
      Examples
        X            The 'x' coordinate for all atoms
        C(9,X,Y)     The 'x' and 'y' coordinates for atom C(9)
        FIRST(X'S)   The 'x','y' and 'z' coordinates for the first atom
        FIRST(U'S) UNTIL C(23)
                     The anisotropic temperature factors for all atoms
                     up to C(23).
</pre><p><BR>
</div>
<div class="directive"><strong><i>Temperature factor definitions</i></strong>
<div class="parameter"><i>Isotropic temperature factor</i>
<pre>
 The isotropic temperature factor is defined by:

       T = exp(-8*pi*pi*U[iso]*s**2)
                                       where s = sin(theta)/lambda
</pre><p><BR>
</div>
<div class="parameter"><i>Anisotropic Temperature Factor</i>
<pre>
      The anisotropic temperature factor (adp) is defined by:

       T = exp(-2*pi*pi*(h*h*a'*a*u[11]
                        +k*k*b'*b'*u[22]
                        +l*l*c'*c'*u[33]
                    +2.0*k*l*b'*c'*u[23]
                    +2.0*h*l*a'*c'*u[13]
                    +2.0*h*k*a'*b'*u[12])).
                                       where x' are the reciprocal
                                       cell parameters and h, k and
                                       l are the Miller indices
</div>
<div class="parameter"></pre><p><i>Uequiv</i>
<P>CRYSTALS contains two definitions od Uequiv. Both definitions are acceptable
 to Acta. The arithmetic mean of the principle axes is often similar
 to the refined value of Uiso. The geometric mean is more sensitive to
 long or short axes, and so is more useful in publications. Ugeom is the
 sphere with the same volume as the ellipsoid.
<pre>
      U(arith) = (U1+U2+U3)/3
      U(geom)  = (U1*U2*U3)**1/3
                                    Where Ui are the principal axes of
                                    the orthogonalised tensor.
</pre><p><BR>
<BR>&nbsp;<BR>
 <strong>CAUTION</strong>
<P>It should be noted that if a set of anisotropic atoms are input with
 the
  FLAG  key set to anything but 0, then the parameters will be
interpreted as Isotropic atoms, or special shapes.
<BR>&nbsp;<BR>
</div>
</div>
<div class="directive"><strong><i>Uequiv</i></strong>
      Two expressions are available for the equivalent temperature factor
 (the geometric or arithmetric mean of the principal components).
 The Immediate Command 'SET UEQUIV' sets which definition will be used.


<pre>
      Ugeom  = (Ui * Uj * Uk)**1/3

      Uarith = (Ui + Uj + Uk)/3
                                       Where Ui, Uj & Uk are the
                                       principal components of U

      Ugeom is the radius of the sphere with the same volume as the adp
      ellipsoid, and thus gives a good indication of the quality of the
      ellipsoid. Uarith is often closer to the value of Uiso, and so is
      useful for returning to an isotropic refinement.
</pre><p><BR>
</div>
<div class="directive"><strong><i>The Special Shapes</i></strong>
<P>
 The SPecial Shape keys are

<pre>

      type serial occ FLAG x y z u[11]  u[22] u[33] u[23] u[13] u[12] spare
                                 U[ISO]                               spare
                                 U[ISO] SIZE                          spare
                                 U[ISO] SIZE  DECLINAT AZIMUTH        spare

</pre><p><BR>

The value of 'FLAG' is used on input of atoms to indicate what kind of
patameters will follow, and is used during calculations for the
interpretation of the parameters.

<div class="parameter"><i>FLAG interpretation</i>
The following table shows the interpretation of the FLAG parameter.
<pre>

FLAG        meaning          parameters

'normal' types of atoms:

 0          Aniso ADP        u[11]  u[22] u[33] u[23] u[13] u[12]
 1          Iso ADP          U[ISO]

New 'special' shapes:

 2          Sphere           U[ISO] SIZE
 3          Line             U[ISO] SIZE  DECLINAT AZIMUTH
 4          Ring             U[ISO] SIZE  DECLINAT AZIMUTH

</pre><p><BR>

<P>The parameters have the following meaning for the new special shapes:
</div>
<div class="parameter"><i>Special U[iso]</i>
U[iso] is related to the 'thickness' of the line, annulus or shell.
</div>
</div>
<div class="directive"><strong><i>Special SIZE</i></strong>
SIZE is the length of the line, or the radius of the annulus or shell.
<div class="parameter"><i>Special DECLINAT</i>
DECLINAT is the declination angle between the line axis or annulus normal and the
  <i>z</i>
axis of the usual CRYSTALS orthogonal coordinate system, in
degrees/100.
</div>
<div class="parameter"><i>Special AZIMUTH</i>
AZIMUTH is the azimuthal angle between the projection of the
line axis or annulus normal onto the <i>x</i> - <i>y</i> plane and the <i>x</i>
axis of the usual CRYSTALS orthogonal coordinate system, in
degrees/100.

<P>If either of these angles is input with a value greater than 5.0, it
is assumed that the user has forgotten to divide by 100, which is thus
done automatically.
<BR>
<BR>&nbsp;<BR>
</div>
</div>
</div>
<div class="instruction"><strong><u>OVERALL PARAMETER SPECIFICATION</u></strong><br>
<P>Overall parameters are specified simply by their keys.
 The following overall parameter keys may be given :

<pre>
      SCALE      OU[ISO]      DU[ISO]      POLARITY
      ENANTIO    EXTPARAM
</pre><p><BR>
<div class="parameter"><i>SCALE</i>
 This parameter defines the overall scale factor and has a default value
 of unity.
 It is the number by which /FC/ must be multiplied to put
 it onto the scale of /FO/, i.e. /Fo/ = scale*/FC/.
</div>
<div class="parameter"><i>DU[ISO]</i>
 This parameter is the dummy overall isotropic temperature factor and has
 a default value of 0.05.
<P>The dummy overall temperature factor is in no way related to the overall
 temperature factor, and its use is explained in the input of LIST 12,
 which comes in the section of the user guide on 'structure factors'.
</div>
<div class="parameter"><i>OU[ISO]</i>
 This parameter is the overall isotropic temperature factor and has a default
 value of 0.05.
</div>
<div class="parameter"><i>POLARITY</i>
 This is the Rogers <i>eta</i> parameter, and  is a  multiplier for the
 imaginary part of the anomalous
 scattering factor.
 Setting the value to 1.0 (its default) has the effect of using the
 imaginary part
 of the anomalous scattering factor as given.
 Changing the value to
 -1.0 has the effect of changing the hand of the model. Setting the value
 at zero has the effect of removing the contribution of f". However, if
 contributions from f" are not required, IT IS MORE EFFICIENT to set ANOMALOUS
 = NO in LIST 23 (structure factor control, see section !elabel!LIST23!). If you 
 need to use f", remember not to
 apply Friedel's law (LIST 13, section !elabel!LIST13!) during data reduction
 (section !elabel!DATAREDUC!),
 and to include anomalous scattering (LIST 3, section !elabel!LIST03! and
 LIST 23, section !elabel!LIST23!). See D. Rogers, Acta Cryst (1981), 
 A37,734-741. <i>POLARITY</i>
 <i>and</i> <i>ENANTIO</i> <i>should</i> <i>not</i> <i>be</i> <i>used</i> <i>simultaniously.</i>
</div>
<div class="parameter"><i>ENANTIO</i>
 This overall parameter is the fractional contribution of F(-h) to the observed
 structure amplitude, and like the POLARITY parameter is sensitive to the
 polarity of the structure. It is defined by
<pre>
       Fo**2 =(1-x)* F(h)**2 + x*F(-h)**2
</pre><p><BR>
 where x is the ENANTIOpole parameter. A value of 0.0 means the structure
 stored in LIST 5 is of the correct hand. A value of 1.0 inverts the structure.
 Its effect on the structure factor is switched on or off by the parameter
 ENANTIO in LIST 23 (see section !elabel!LIST23!). Computations are more efficient 
 when it is turned off.
 If the enantiopole is used (or refined) then Friedel's law must not be applied
 (LIST 13, section !elabel!LIST13!) and anomaloue scattering must 
 be included (LIST 13 and LIST 23).
 See Howard Flack, Acta Cryst, 1983, A39, 876-881. This parameter
 is more robust than the POLARITY parameter.
 See also section in Results.
</div>
<div class="parameter"><i>EXTPARAM</i>
 This parameter is Larson's extinction parameter , r*, (equation 22 in
   A.C. Larson, Crystallographic Computing, 1970, 291-294, ed F.R.
 Ahmed, Munksgaard, Copenhagen , but with V
 replaced by the cell volume)
 and has a default value of zero.
<P>Note that many other programs use expression (4),
  which cannot cope with Neutron data, and  gives a value for 'g'
  which is about 1,000,000 times smaller than 'r*'.

<pre>
       g ~= [(e**2/mc**2)**2 . lambda**3/V**2 . Tbar ] . r*
</pre><p><BR>
 Tbar is the absorption weighted mean path length, and is assumed to be
 stored in
 LIST 6 (section !elabel!LIST06!) with a key of  TBAR . If this key is 
 absent, a default value of 1.0
 is used. If extinction is to be included in the model, the mosaic spread
 should have been set in LIST 13 (section !elabel!LIST13!).



<A NAME="LIST 5"> </A>
<A NAME="Input of atoms and other parameters"> </A>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.atominput">6.3: Input of atoms and other parameters  -  LIST 5</A></H3></CENTER>
<A NAME="LIST05"> </A>


<pre>
 \LIST 5
 OVERALL SCALE= DU[ISO]= OU[ISO]= POLARITY= ENANTIO= EXTPARAM=
 READ NATOM= NLAYER= NELEMENT= NBATCH=
 either ATOM TYPE= SERIAL= OCC= FLAG= X= Y= Z= U[11]= ....U[12]=
 or     ATOM TYPE= SERIAL= OCC= FLAG= X= Y= Z= U[ISO]
 INDEX P= Q= R= S= ABSOLUTE=
 LAYERS SCALE=
 ELEMENTS SCALE=
 BATCH SCALE=

</pre><p><BR>

<pre>
 \LIST 5
 OVERALL SCALE=0.123
 READ NATOM=2 NELEMENT=2
 ATOM PB 1 FLAG=0 .25 .25 .25 .03 .03 .03 .0 .0 .0
 ATOM C 2  X= .23 .13 .67
 ELEMENTS 0.8 0.2
 END

</pre><p><BR>
<div class="instruction"><strong><u>\LIST 5</u></strong><br>
<div class="directive"><strong><i>OVERALL SCALE= DU[ISO]= OU[ISO]= POLARITY= ENANTIO= EXTPARAM=</i></strong>
<P>This directive specifies various parameters that refer to the
 structure as a whole.
<div class="parameter"><i>SCALE=</i>
 The overall scale factor, default = 1.0
</div>
<div class="parameter"><i>DU[ISO]=</i>
 The dummy overall isotropic temperature factor, default = 0.05.
</div>
<div class="parameter"><i>OU[ISO]=</i>
 The overall isotropic temperature factor, default = 0.05.
</div>
<div class="parameter"><i>POLARITY=</i>
 Rogers <i>eta</i> parameter (see above), default = 1.0.
</div>
<div class="parameter"><i>ENANTIO=</i>
 Flack enantiopole parameter (see above), default = 0.0.
</div>
<div class="parameter"><i>EXTPARAM=</i>
 Larson r* secondary extincion parameter, default = 0.0.
</div>
</div>
<div class="directive"><strong><i>READ NATOM= NLAYER= NELEMENT= NBATCH=</i></strong>
<P>This directive specifies the number of atoms, layer scale factors,
 element scale factors, and batch scale factors that are to follow.
<div class="parameter"><i>NATOM=</i>
 The number of atom directives to follow, default = 0.
</div>
<div class="parameter"><i>NLAYER=</i>
 The number of layer scale factors to follow, default = 0.
</div>
<div class="parameter"><i>NELEMENT=</i>
 The number of element scale factors to follow, default = 0.
</div>
<div class="parameter"><i>NBATCH=</i>
 The number of batch scale factors to follow, default = 0.
</div>
</div>
<div class="directive"><strong><i>ATOM TYPE= SERIAL= OCC= FLAG= X= Y= Z= U[11]= ..</i></strong>
<P>The parameters for an atom, repeated NATOM times.
<div class="parameter"><i>TYPE=</i>
 The atomic species, an entry for which should exist
 in LIST 3 (see section !elabel!LIST03!). There is no default value.
</div>
<div class="parameter"><i>SERIAL=</i>
 The atoms serial number. There is no default value.
</div>
<div class="parameter"><i>OCC=</i>
 This parameter defines the site occupancy <strong>EXCLUDING</strong> special position
 effects (i.e. is the 'chemical occupancy). The default is 1.0.
 Special position  effects are computed by CRYSTALS and multiplied onto
 this parameter.
</div>
<div class="parameter"><i>FLAG=</i>
 This parameter specifies the type of temperature factor for the atom,
 and if it is omitted a default value of 1 is assumed. <strong>NOTE</strong> that it
 <strong>must</strong> be set to 0 for anisotropic atoms.
</div>
<div class="parameter"><i>X= Y= Z=</i>
 These parameters specify the atomic coordinates for the atom, for which
 there are no default values.
</div>
<div class="parameter"><i>U[11]= U[22]= U[33]= U[23]= U[13]= U[12]=</i>
 These parameters have different interpretations depending upon the
value of FLAG
<P>
 If FLAG=0
<P> These parameters specify the anisotropic temperature factors for the atom
 and if they are omitted default values of zero are assumed.
 The order of the
 cross terms is obtained by dropping 1,2,3 sequentially from [123].
<P>
 If FLAG=1
<P> The first parameter specifies the isotropic temperature factor, which
 defaults to 0.05.
<P>
  If FLAG=2,3 or 4, the six parameters represented by u[ij] have the
following imterpretation:
<BR>
<pre>
KEY   shape      parameters

 2    Sphere     U[ISO] SIZE
 3    Line       U[ISO] SIZE  DECLINAT AZIMUTH
 4    Ring       U[ISO] SIZE  DECLINAT AZIMUTH

</pre><p><BR>

<P>The parameters have the following meaning for the new special shapes:
</div>
<div class="parameter"><i>Special U[iso]</i>
U[iso] is related to the 'thickness' of the line, annulus or shell.
</div>
</div>
<div class="directive"><strong><i>Special SIZE</i></strong>
SIZE is the length of the line, or the radius of the annulus or shell.
<div class="parameter"><i>Special DECLINAT</i>
DECLINAT is the declination angle between the line axis or annulus normal and the
  <i>z</i>
axis of the usual CRYSTALS orthogonal coordinate system, in
degrees/100.
</div>
<div class="parameter"><i>Special AZIMUTH</i>
AZIMUTH is the azimuthal angle between the projection of the
line axis or annulus normal onto the <i>x</i> - <i>y</i> plane and the <i>x</i>
axis of the usual CRYSTALS orthogonal coordinate system, in
degrees/100.

<P>If either of these angles is input with a value greater than 5.0, it
is assumed that the user has forgotten to divide by 100, which is thus
done automatically.
<BR>
</div>
</div>
<div class="directive"><strong><i>INDEX P= Q= R= S= ABSOLUTE=</i></strong>
<P>This directive is used to input the constants that define an index
 for layer scaling. The layer scale index for the reflection with indices
  HKL  is computed from

<pre>
      index = (h*p + k*q + l*r + s)
</pre><p><BR>
 and the absolute value is taken if the parameter  ABSOLUTE  = yes.
<div class="parameter"><i>P= Q= R=</i>
 These parameters have default values of zero.
</div>
<div class="parameter"><i>S=</i>
 This parameter has a default value of unity. The zeroth layer must have
 an index of 1.
</div>
<div class="parameter"><i>ABSOLUTE=</i>

<pre>
      NO
      YES  -  Default value
</pre><p><BR>
</div>
</div>
<div class="directive"><strong><i>LAYERS SCALE=</i></strong>
<P>This directive defines the layer scale factors, starting with the scale
 for an index of 1.
<div class="parameter"><i>SCALE=</i>
 This parameter gives the layer scale, and has a default value of 1.
 It is repeated  NLAYER  times.
</div>
</div>
<div class="directive"><strong><i>ELEMENTS SCALE=</i></strong>
<P>This directive defines the scale factors for the elements of a twinned
 structure. See the chapter on twinned structures.
<div class="parameter"><i>SCALE=</i>
 This parameter gives the element scale factor, and has a default value
 of 1. It is repeated  NELEMENT  times - the number of components
 in the twin.
</div>
</div>
<div class="directive"><strong><i>BATCH SCALE=</i></strong>
<P>This directive defines the batch scale factors.
<div class="parameter"><i>SCALE=</i>
 This parameter gives the batch scale factor, and has a default value of 1.
 It is repeated  NBATCH  times. Remember to set appropriate keys in LIST
 6
<BR>&nbsp;<BR>
</div>
</div>
</div>
<div class="instruction"><strong><u>Further examples of parameter input</u></strong><br>

<pre>
 ATOM TYPE=C,SERIAL=4,OCC=1,U[ISO]=0,X=0.027,Y=0.384,Z=0.725,
 CONT U[11]=0.075,U[22]=0.048,U[33]=.069
 CONT U[23]=-.007,U[13]=.043,U[12]=-.001
 ATOM C 5 U[ISO]=0.0 .108,.365,.815,.074
 CONT .051 .065 -.015 .048 -.014
 ATOM C 2 1 0.05 0.149 0.411 0.651 0 0 0 0 0 0
 ATOM C 1 X=0.094,Y=0.343,Z=0.890
 ATOM C 3 X=0.050 0.406 0.648
</pre><p><BR>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.print5">6.4: Printing and punching list 5</A></H3></CENTER>

<div class="instruction"><strong><u>\PRINT 5</u></strong><br>
 Lists the current LIST 5 to the printer file.
</div>
<div class="instruction"><strong><u>\PUNCH 5 mode</u></strong><br>
 Mode controls the format of the file.
<pre>
        -  Punches the model parameters in CRYSTALS format.
      A -  Punches the model parameters in CRYSTALS format.
      B -  Punches the atomic parameters in XRAY format.
      C -  Punches the atomic parameters in SHELX format.
      E -  Punches atomic parameters and esds in a plain format
</pre><p><BR>&nbsp;<BR>
</div>
<div class="instruction"><strong><u>Summary display of LIST 5 - \DISPLAY</u></strong><br>

<pre>
 \DISPLAY LEVEL=
 END

 \DISP HIGH
 END
</pre><p><BR>
<P>This allows the user to display a summary of the contents
 of list 5.  The  output is sent to both monitor and listing channels, so
 the contents of list 5 can be examined on-line during interactive work.
 The output produced is more compact than that from PRINT 5, and various
 levels of detail can be selected.
 The command required is :-
</div>
<div class="instruction"><strong><u>\DISPLAY    LEVEL=</u></strong><br>
<P>DISPLAY has one  optional  parameter.

<div class="parameter"><i>LEVEL</i>
<pre>
      LOW
      MEDIUM
      HIGH
</pre><p><BR>
<P>The effects of this parameter are :-
<P>LOW            The names of the atoms, overall parameters,
 and any layer, batch, and element scales in list 5 are displayed.
<P>MEDIUM         Each atom in list 5 is displayed with its type, serial,
 occupancy, isotropic temperature factor ( if any ), and positional parameters.
 The values of the overall parameters and of any layer, batch, and element
 scales are displayed.
<P>HIGH           All of the parameters of each atom in list 5 are
 displayed. The values of the overall parameters, and of any layer, batch,
 and element scale factors are displayed.
<BR>
<BR>&nbsp;<BR>
<A NAME="EDIT"> </A>
<A NAME="Editing structural parameters"> </A>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.edit5">6.5: Editing structural parameters -  \EDIT</A></H3></CENTER>

<pre>
 \EDIT INPUTLIST= OUTPUTLIST=
 
 EXECUTE
 SAVE
 QUIT
 LIST LEVEL
 MONITOR LEVEL
 END

 ADD  VALUE PARAMETERS  ...
 AFTER  ATOM-SPECIFICATION
 ANISO  ATOM-SPECIFICATIONS  .  .
 ATOM TYPE= SERIAL= OCC= FLAG= X= Y= Z= U11= ..
 CENTROID Z ATOM-SPECIFICATION ...
 CHANGE  PARAMETER-SPECIFICATION VALUE ...
 COPYXYZ ATOM-PAIRS
 COPYUIJ ATOM-PAIRS
 CREATE Z ATOM-SPECIFICATION  ...
 DELETE  ATOM SPECIFICATIONS  .  .
 DEORTHOGINAL  ATOM-SPECIFICATION . .
 DIVIDE  VALUE  PARAMETERS  ...
 DSORT TYPE1 TYPE2 ...
 INSERT IDENTIFIER
 KEEP  Z ATOM-SPECIFICATIONS ...
 MOVE Z ATOM-SPECIFICATION  ...
 MULTIPLY  VALUE  PARAMETERS  ...
 PERTURB VALUE PARAMETERS ...
 REFORMAT
 RENAME ATOM1  ATOM2  (, ATOM1  ATOM2) ...
 RESET PARAMETER-NAME VALUE ATOM-NAMES
 ROTATE ANGLE ATOM VECTOR ATOM-SPECIFICATION
 ROTATE ANGLE ATOM1 ATOM2 ATOM-SPECIFICATION
 ROTATE ANGLE POINT VECTOR ATOM-SPECIFICATION
 SELECT ATOM-PARAMETER  OPERATOR  VALUE, . .
 SHIFT  V1, V2, V3   ATOM-SPECIFICATION . .
 SORT KEYWORD
 SORT TYPE1 TYPE2 ...
  SPLIT Z ATOM-SPECIFICATION ...
 SUBTRACT  VALUE  PARAMETERS  ...
 SWAP ATOM-PAIRS
 TRANSFORM  R11, R21, R31, . . . R33  ATOM-SPECIFICATION . .
 TYPECHANGE KEYWORD OPERATOR VALUE NEW-ATOM-TYPE
 UEQUIV  ATOM-SPECIFICATIONS  .  .

 LINE NEWSERIAL ATOMLIST
 RING NEWSERIAL ATOMLIST
SPHERE NEWSERIAL ATOMLIST
</pre><p><BR>

<pre>
 LIST LOW
 TYPECHANGE TYPE EQ Q C
 SELECT U[ISO] LT 0.1
 ADD  0.25 X
 RENAME C(1) S(1)
 CHANGE  S(1,OCC) UNTIL O(1) .5
 KEEP  1 FIRST UNTIL LAST
 L L
 SPLIT 100 C(45)
 DELETE  C(46) UNTIL LAST
 RESET OCC 1.0 ALL
</pre><p><BR>
<BR>&nbsp;<BR>

<P>This is a powerful crystallographic editor for
 modifying a LIST 5 (the model parameters) or LIST 10 (Fourier peaks).
 It offers the editing facilities frequently needed
 for the management of atom parameters, including conditional operations
 and arithmetic.
<BR>
<P>EDIT is a semi-interactive command, in that each directive is
 computed as soon as its input is complete. Since CONTINUE can be used
 to extend a directive over several lines, completion is indicated be
 the start of a new directive, or the special directive EXECUTE.
<P>After the terminating END, the resulting list is
 output to the disc.
 However if the list has not been changed, a new list will be created only
 if the list type is being changed ( e.g. 10 to 5 ).
 The current edited version of the list can be saved at
 any time to protect against future editing mistakes ( the SAVE directive ).
 It is also possible to abandon editing without creating a new list ( the QUIT
 directive ).
<P>When used in interactive mode, a new list is created even though errors may
 have occured during command input unless the QUIT directive is used. In
 online and batch modes no new list will be created if errors occured
 during the edit. In this case an error message in generated.
<P>Take care to note that some directives refer to atom or group of atoms,
 others refer to one or more parameters, and two
 (CHANGE  and  SELECT)will refer to either an atom specification
 or a parameter specification.
 Although atom definitions can include a series of symmetry operators,
 the only directives that will use them are those
 for which the subsequent description explicitly states that the
 symmetry operators are used.
 In all other cases, the symmetry information will be read in without any
 error messages and ignored.
 Those operations which require a single parameter type as argument
 (ADD,  MULTIPLY  etc ) will fail if composite parameters ( "U'S", etc )
 are given.
<P>
<div class="instruction"><strong><u>\EDIT INPUTLIST OUTPUTLIST</u></strong><br>

<div class="parameter"><i>INPUTLIST</i>
<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
<P>
</div>
<div class="parameter"><i>OUTPUTLIST</i>
<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
<P>
</div>
<div class="directive"><strong><i>EXECUTE</i></strong>
 This directive which has no parameters does nothing to the edited list. It
 is provided to allow the user to see the results of one operation (
 initiated by the directive whose input is terminated by EXECUTE ) before
 attempting the next.
</div>
<div class="directive"><strong><i>SAVE</i></strong>
 Forces the current atom list to be writen to disk.
</div>
<div class="directive"><strong><i>QUIT</i></strong>
 This directive will cause the edit to be abandoned without the creation
 of a new list if it is followed by
 END . If it is followed by any other directive it is ignored.
<P>
</div>
<div class="directive"><strong><i>LIST LEVEL</i></strong>
 This directive produces a list of the current edited list in the monitor
 output stream and in the listing file. If KEEP has been used, the atoms
 which will be kept are indicated.
 The possible values for 'level' are :-

<pre>
      OFF               No listing produced
      LOW               Type and serial listed
      MEDIUM            Type , serial , occ , u[iso] ,
                        x , y , z listed
      HIGH              All atomic parameters listed
</pre><p><BR>
</div>
<div class="directive"><strong><i>MONITOR LEVEL</i></strong>
 This directive controls the level of monitoring of editing operations. When
 each operation is performed, the results can be monitored in the monitor
 channel and in the listing file. Four levels of monitoring are provided. The
 inital level and the default level used when no value is specified is
 'MEDIUM'. The possible values of the parameter 'level' are :-

<pre>
      OFF          No monitoring occurs
      LOW          Type and serial only are displayed
      MEDIUM       Program selects level of display   (default)
      HIGH         At least the level represented by
                   'MEDIUM' listing is displayed
</pre><p><BR>
<P>When the program selects a monitor level account is taken of the
 amount of relevant information for the particular directive. Thus for
 DELETE only 'type' and 'serial' need be displayed whereas for CHANGE
 all parameter values are displayed.
</div>
<div class="directive"><strong><i>END</i></strong>
 This must be the last directive in the set of modification directives, 
 and writed the list to disk.
<BR>
<BR>
<BR>
<BR>
<BR>
</div>
<div class="directive"><strong><i>ADD  VALUE  PARAMETERS  ...</i></strong>
<BR>
</div>
<div class="directive"><strong><i>AFTER  ATOM-SPECIFICATION  ...</i></strong>
<P>This defines the atom in the list after which atoms
 that are  MOVEd  should be placed.
 (See  MOVE  below).
 If this directive is omitted, the default option places the first  MOVED
 atom at the head of the list, and successive atoms after it.
 Once one  AFTER  directive has been given, atoms are placed behind the
 given atom in the order in which they are presented on  MOVE  directives.
 If no atom specification is given on this directive, subsequent MOVEs will move
 the atoms  to the  head of the list.
<BR>
</div>
<div class="directive"><strong><i>ANISO  ATOM SPECIFICATIONS  .  .</i></strong>
 This directive causes all the specified atoms to be converted so that they
 have anisotropic temperature factors.
 If an atom is already anisotropic, no action is taken, and any symmetry
 operators given are ignored.
 If this directive is given with no arguments, all the atoms in the current
 atomic parameter list are converted to anisotropic temperature factors.
<P>Note that   the anisotropic temperature factor produced by this operation
 is in fact still spherically symmetrical, and
 that the s.f.l.s.
 routines automatically ensure that when the temperature factor of an atom
 is to be  refined, it is in the correct form.
<BR>
</div>
<div class="directive"><strong><i>ATOM TYPE SERIAL OCC FLAG X Y Z U11 ..</i></strong>
 This directive causes the system to add an atom to the
 end of the edited list. The format is the same as that used in \LIST 5 (see
section !elabel!LIST05!).
 Values must be provided for 'type' , 'serial' , 'x' , 'y' , and 'z' .
 Default values are provided for the other parameters as in \LIST 5.
 Example :
<pre>
 ATOM O 1 X = 0.3427 .89004 .09181
</pre><p><BR>
</div>
<div class="directive"><strong><i>CENTROID Z ATOM-SPECIFICATION ...</i></strong>
 A new atom is created at the centroid of the specified atoms, and with
 a pseudo adp representing the inertial tensor (ie the 'shape' of the
 group). The atom TYPE is QC, and its serial Z.
 The sequence Z ATOM-SPECIFICATIONS can be repeated.
<BR>
</div>
<div class="directive"><strong><i>CHANGE  ARG(1)  ARG(2)  ARG(3)  .</i></strong>
 There are two possible formats for each 'ARG(i)' on this directive.
 the first is :
<pre>
 PARAMETER(i)  VALUE(i)
</pre><p><BR>
 If  ARG(i)  is of this form, the specified parameter or parameters
 are changed to the value  VALUE(i) .
 If  PARAMETER(i)  defines one or more atomic parameters, then the
 symmetry operators found or inserted by default
 are applied to the resulting set of atomic parameters.
 For overall parameters,
 no symmetry information can be provided.
 The  VALUE  associated with this argument must always be present.
<P>The second form of  ARG(i)  on this directive is :
<pre>
 ATOM-SPECIFICATION
</pre><p><BR>
 For this form of  ARG(i) , the symmetry operators given in the
 atom specification or assumed by default are applied, but no
 other atomic parameter is explicitly altered.
 There is no  VALUE  associated with  ARG(i)  in this format.
<P>The two different types of argument on this directive may be used
 interchangeably :

<pre>
      CHANGE  S(1,OCC) UNTIL O(1) .5
      CONT    C(1,-2,1) UNTIL C(12)
      CONT    C(13,X) .0179
</pre><p><BR>
<BR>
</div>
<div class="directive"><strong><i>COPYXYZ  ATOM-PAIRS  ...</i></strong>
 This directive COPIES the XYZ coordinates of the first atom into
 the second atom.  The other parameters are left  unchanged.  
<BR>
<BR>
</div>
<div class="directive"><strong><i>COPYUIJ  ATOM-PAIRS  ...</i></strong>
 This directive COPIES the Uij coordinates of the first atom into
 the second atom.    The other parameters are left  unchanged.
<BR>
<BR>
</div>
<div class="directive"><strong><i>CREATE Z ATOM-SPECIFICATION  ...</i></strong>
 This directive applies the symmetry operators given or assumed by default
 in the atom specification, and creates a set of new atoms from those given.
 The new atoms are added at the end of the current list. The serial numbers
 of the new atoms are given by:
<pre>
      NEWSERIAL = Z + OLDSERIAL
</pre><p><BR>
 The sequence Z ATOM-SPECIFICATIONS can be repeated.
 When moving from a centrosymmetric to a non-centrosymmetric space group,
 for example, atoms formerly related by the centre of symmetry can be
 generated :
<pre>
      CREATE 30 MO(1,-1) UNTIL C(15)

      Creates atoms MO(31) until C(45)
</pre><p><BR>
</div>
<div class="directive"><strong><i>DELETE  ATOM SPECIFICATIONS  .  .</i></strong>
 All the specified atoms are removed
 from the current atomic parameter list.
 Deleted atoms should not be referenced by subsequent directives.
<BR>
</div>
<div class="directive"><strong><i>DEORTHOGINAL  ATOM SPECIFICATION . .</i></strong>
 This directive applies the matrix vector saved by a previous MOLAX SAVE
 directive to the atoms given  in the atom specification. THEIR ORIGINAL
 COORDIANATES x,y,z MUST be in the MOLAX coordinate (Angstrom) system
 This directive does not create new atoms, but simply modifies
 those already present. Symmetry operators are not permitted.
<BR>
</div>
<div class="directive"><strong><i>DIVIDE  VALUE  PARAMETERS  ...</i></strong>
 These directives causes the 'value' to be applied to the parameter.
 'PARAMETER(I)' may be an overall parameter, or a single atomic
 parameter of one  or more atoms, as defined above.
 Any symmetry operators given with this directive will be ignored.
 Note that the parameter SERIAL is numeric, and so can be arithmetically
 modified.
<BR>
</div>
<div class="directive"><strong><i>DRENAME ATOM1 ATOM2 </i></strong>
 Used by SCRIPTS to avoid name clashes.
<BR>
</div>
<div class="directive"><strong><i>DSORT TYPE1 TYPE2 ...</i></strong>
</div>
<div class="directive"><strong><i>DSORT KEYWORD</i></strong>
 This directive is exactly analagous to SORT, below, except that it sorts
 into descending order.
<BR>
</div>
<div class="directive"><strong><i>INSERT IDENTIFIER=NAME</i></strong>
 This directive inserts the value of the named identifier into the
 parameter 'SPARE' in the atom list, replacing any previous value
 (except 'RESIDUE' which uses the 'RESIDUE' paramter in the atom list).
 SPARE is normally used to hold rho after Fourier maps.
<P> Currently available values for NAME are

<BR>
<BR> ELECTRON - This inserts the atomic electron count calculated
from the form factor
<BR> WEIGHT - This inserts the atomic weight from LIST 29 (see section !elabel!LIST29!).
<BR> RESIDUE - This inserts a residue number into the 'RESIDUE' slot
 of list 5 replacing any previous value, such that all connected atoms
 have the same residue number and each molecule has a different residue number.
<BR> NCONN - This inserts the number of atoms connected to an atom, using
 the list of bonds.
<BR> RELAX - This inserts an ID, based upon the bonding topology and atomic
 types of the atoms. Atoms at topologically identical positions will be given
 the same ID. (e.g. the terminal F's in a CF3 group).
<BR>
</div>
<div class="directive"><strong><i>KEEP  Z ATOM-SPECIFICATIONS ...</i></strong>
<P>Only the atoms referenced in this directive will be kept in the list,
 all the others will be lost, even though they can be referenced
 right up until the final END.
 The sequence Z ATOM-SPECIFICATIONS can be repeated.
<BR>
 Atoms that are  KEPT  are moved to the top of the list, and stored in the
 order in which they are specified on  the KEEP  directive. Only one KEEP
 directive may be given. Use CONTINUE if one line isn't long enough for the
 atom sequence.
<P>The atom specifications may contain symmetry operators, which are used
 to generate the coordinates of the atoms that are to be retained.
  'Z' Is an optional parameter which defines the serial number
 of the first atom in the specification immediately following it.
 For each atom thereafter in the current atom specification, the serial
 number is incremented by one to generate the output
 serial number.
 Atoms whose serial numbers are changed in this way must be referred to
 in subsequent directives by their new serial numbers.
 If 'Z' is not given, the atoms retain
 their old serial numbers.
<P>If an  UNTIL  sequence is used after a  KEEP  directive has
 been given, it should be used with care, since the order of the new
 parameter list is different from the input list.
<BR>
</div>
<div class="directive"><strong><i>MOVE Z ATOM-SPECIFICATION  ...</i></strong>
<P>This directive moves atoms about in the list and places them
 in the position defined by the latest  AFTER  directive.
 (See the previous directive).
 This directive does not remove atoms from the list, but simply
 reorders the list.
 The sequence Z ATOM-SPECIFICATIONS can be repeated.
<P>The atom specifications may contain symmetry operators, which are used
 to generate the coordinates of the atoms that are to be moved.
  'Z'  is an optional parameter which defines the serial number
 of the first atom in the specification immediately following it.
 For each atom thereafter in the current atom specification, the serial
 number is incremented by one to generate the output
 serial number.
 Atoms whose serial numbers are changed in this way must be referred to
 in subsequent directives by their new serial numbers.
 If no  'Z' is given, the atoms retain
 their old serial numbers.
<P>If an  UNTIL  sequence is used after one or more  MOVE  directives have
 been given, it should be used with care, since the order of the new
 parameter list is different from the input list.
<BR>
</div>
<div class="directive"><strong><i>MULTIPLY  VALUE  PARAMETERS  ...</i></strong>
<BR>
</div>
<div class="directive"><strong><i>PERTURB VALUE PARAMETERS ...</i></strong>
  This directive perturbs the specified parameters using a rnadom
 number generator. The VALUE is the requested rms perturbation, in the
 natural units of the parameters. The mean deviation applied should be
 approximately zero, and the rms deviation applied should be
 approximately that requested.
<BR>
</div>
<div class="directive"><strong><i>REFORMAT</i></strong>
This directive converts an old (non-FLAG) version of LIST 5 (see
section !elabel!LIST05!) to the new format (extra parameters, old U[iso] 
slot now used as a flag and u[11] used for u[iso]).
<BR>
</div>
<div class="directive"><strong><i>RENAME ATOM1  ATOM2  (, ATOM1  ATOM2) ...</i></strong>
 This directive requires pairs of atom specifications (optionally separated
 by a comma). The TYPE and SERIAL of 'atom1' are changed to those of 'atom2'.
 Atom1 must exist in LIST 5, atom2 must NOT exist in LIST 5. An atom can be
 renamed repeatedly. If atom1 contains symmetry operators, these are applied
 to the coordinates of the renamed atom. An atom cannot be renamed to itself
 in a single step.
<BR>
</div>
<div class="directive"><strong><i>RESET PARAMETER-NAME  VALUE ATOM LIST</i></strong>
<P>This directive assigns the given value to the named parameter
 for all the atoms in the atom list

<pre>
      RESET OCC 1.0 ALL
      RESET OCC .5 O(1) O(2) O(3)
      RESET U[11] .05 C(27) UNTIL C(50)
</pre><p><BR>
</div>
<div class="directive"><strong><i>ROTATE</i></strong>
This directive rotates a group of atoms a certain number of degrees
around a specified vector. The rotation is carried out in orthogonal
space so preserves the geometry of the group.
<BR>
There are three options available:
ROTATE D X Y Z VX VY VZ atom-specification  <BR>
ROTATE D ATOM1 VX VY VZ atom-specification  <BR>
ROTATE D ATOM1 ATOMS2   atom-specification  <BR>
<BR>
The first rotates the specified atoms, D degrees around the vector
VX,VY,VZ keeping point X,Y,Z fixed. (X,Y,Z and VX,VY,VZ are given in
crystal fractions).
<BR>
The second notation uses ATOM1 instead of X,Y,Z to specify the fixed point.
<BR>
The third notation uses ATOM1 to specify the fixed point and the vector
from ATOM1 to ATOM2 to rotate around.
<BR>
The rotation is D degrees anti-clockwise, when the specified vector
is pointing towards you.
<BR>
1) Rotate the hydrogens of a methyl group by sixty degrees.
<pre>
 \EDIT
 ROTATE 60 C(1) C(2) H(20) H(21) H(22)
 END
</pre><p><BR>
2) Turn a phenyl ring through 30 degrees around its external connecting
bond, c(1) to c(20).
<pre>
 \EDIT
 ROTATE 30 C(1) C(20) C(21) C(22) C(23) C(24) C(25)
 END
</pre><p><BR>
3) Rotate a residue 90 degrees about the a-direction from its centroid, QC(1)
 (see also CENTROID and INSERT RESIDUE directives)
<pre>
 \EDIT
 INSERT RESIDUE
 CENTROID 1 RESIDUE(1)
 ROTATE 90 QC(1) 1 0 0 RESIDUE(1)
 END
</pre><p><BR>
</div>
<div class="directive"><strong><i>SELECT ATOM-PARAMETER  OPERATOR  VALUE, . .</i></strong>
<P>This directive selects and retains atoms with parameters satisfying
 the specified conditions.
 Only atoms that satisfy ALL the selection criteria, whether these
 are in the same or different directives, will be kept.
 All other atoms will be deleted from the list.
<P>The operators allowed are :

<pre>
            EQ            equal
            NE            not equal
            GT            greater than
            GE            greater than or equal to
            LT            less than
            LE            less than or equal to
</pre><p><BR>
 Examples of the  SELECT  directive are :

<pre>
      SELECT SERIAL LT 50
      SELECT OCC GT 0.5, OCC LT 1.5
      SELECT C(1,X) LT 1., C(1,X) GT 0.
      SELECT TYPE NE Q
</pre><p><BR>
 This example will only retain atoms with serial numbers less than 50
 and occupancies between 0.5 and 1.5.
 The  'X'  parameter of atom c(1) must also lie between 0.0 and
 1.0 oterwise it will be rejected, and any atoms of type Q  will be deleted.
<BR>
</div>
<div class="directive"><strong><i>SHIFT  V1, V2, V3   ATOM-SPECIFICATION . .</i></strong>
 This directive reads the three numbers of a shift vector, which must
 be in the same coodrinate system as the atomic parameters,
 and applies it to the parameters in the atom specification.
 This directive does not create new atoms, but simply modifies
 those already present.
 Any symmetry operators given are applied before the translation.
<BR>
</div>
<div class="directive"><strong><i>SORT TYPE1 TYPE2 ...</i></strong>
</div>
<div class="directive"><strong><i>SORT KEYWORD</i></strong>
 This directive has two formats, and is used to sort the atoms stored in
 LIST 5 into a user-defined order.
 The default action sorts the atoms  on their types and serial numbers.
 The types are taken in the order found in LIST 5, and atoms of each
 type are grouped together. In each group the atoms are
 arranged by ascending serial number.
 The order of the types of atoms may also be determined
 by specifying them explicitly on the SORT directive,  or by a mixture of
 these methods.
<BR>
<P>In the second format, a keyword corresponding to an atom parameter
 name (as defined in LIST 5, see
 section !elabel!LIST05!) is given, and the whole list sorted on
 increasing value of the specified parameter. Note that sorting on TYPE
 will give results depending on the 'collating sequence' of the computer.
 Fortunately, this generally leads to alphabetic sorting.
<P>SORT sorts the whole list 5, and cancels any existing KEEP
 directives.
<BR>
</div>
<div class="directive"><strong><i>SPLIT Z ATOM-SPECIFICATION ...</i></strong>
 Two new isotropic atoms are added to the end of the atom list for every
 atom referenced in the atom-specification. These atoms lie on
 of the principal axis of the original atoms anisotropic adp ellipsoid 
 and U[iso] set to U[meadian] of the original adp.
<P>The original atoms are not deleted.
 The sequence Z ATOM-SPECIFICATIONS can be repeated.
 The new serial numbers are given by
<pre>
      NEWSERIAL(1) = Z* OLDSERIAL and
      NEWSERIAL(2) = Z* OLDSERIAL +1
</pre><p><BR>
</div>
<div class="directive"><strong><i>SUBTRACT  VALUE  PARAMETERS  ...</i></strong>
<BR>
</div>
<div class="directive"><strong><i>SWAP  ATOM-PAIRS  ...</i></strong>
 This directive swaps the atomic coordinates (x's and U's) for the two 
 named atoms.  The occupation numbers, Residue and Parts are left 
 unchanged.  
<BR>
</div>
<div class="directive"><strong><i>TRANSFORM  R11, R21, R31, . . . R33  ATOM SPECIFICATION . .</i></strong>
 This directive reads the nine numbers of a transformation matrix, which must
 be separated by commas or spaces, and applies the matrix to the atoms given
 in the atom specification.
 This directive does not create new atoms, but simply modifies
 those already present.
 Any symmetry operators given are applied before the rotation.
<BR>
</div>
<div class="directive"><strong><i>TYPECHANGE KEYWORD OPERATOR VALUE NEW-ATOM-TYPE</i></strong>
<P>This directive conditionally changes the TYPES of atoms. If an atomic
 parameter selected by the keyword (see sort above) satisfies the
 conditions defined by the 'operator' and 'value' (see SELECT above),
 then the TYPE of the atom is changed to 'new-atom-type'.

<pre>
      TYPECHANGE OCC GT 1.2 O
                              If Occ large, convert to oxygen
      TYPECHANGE U[ISO] LE 0.03 N
                              If Uiso small, convert to nitrogen
      TYPECHANGE TYPE EQ Q C                              Convert peaks (type Q) to carbon
</pre><p><BR>
</div>
<div class="directive"><strong><i>UEQUIV  ATOM SPECIFICATIONS  .  .</i></strong>
 The specified atoms to be converted so that they
 have isotropic temperature factors,
 U(equiv), defined by the SET UEQUIV command.
 IT IS NOT simply related to the
 diagonal elements of U(aniso).
 If an atom is already isotropic, no action is taken.
 If this directive is given with no arguments, all the atoms in the current
 atomic parameter list are converted to isotropic temperature factors.
 Physically impossible values are not rejected.
 Symmetry operators are ignored.

<BR>
<BR>
<BR>
<P>The following directives are used to convert atomic parameters into 
 the special shape parameters
<BR>
<BR>

</div>
<div class="directive"><strong><i>SPHERE NEWSERIAL ATOMLIST</i></strong>
This creates a 'shell' shape from the specified atom list. The centre of
the shell is at the centre of gravity, the size is the mean distance of
the given atoms from the centre, and the occupancy is equal to  the sum of
the occupancies
of the atoms listed. U[iso] is the mean of the U[iso] or Ueqiv of the
listed atoms.
 The atom TYPE is QS, with the given serial number. The
original atoms are not deleted, though they should be or their occupancy
set to zero. The atom type, QS, should be changed to something
appropriate.
<BR>

</div>
<div class="directive"><strong><i>RING NEWSERIAL ATOMLIST</i></strong>
This creates an 'annulus' shape from the specified atom list. The centre of
the ring is at the centre of gravity, the size is the mean distance of
the given atoms from the centre, and the occupancy is equal to the sum of
the occupancies
of the atoms listed. U[iso] is the mean of the U[iso] or Ueqiv of the
listed atoms.
The atom TYPE is QR, with the given serial number. The
original atoms are not deleted, though they should be or their occupancy
set to zero. The atom type, QS, should be changed to something
appropriate. The DECLINATION and AZIMUTH are computed from the
constituent atoms.
<BR>
</div>
<div class="directive"><strong><i>LINE NEWSERIAL ATOMLIST</i></strong>
This creates an 'line' shape from the specified atom list. The centre of
the line is at the centre of gravity, the size is twice the mean distance of
the given atoms from the centre, and the occupancy is equal to the sum of
the occupancies
of the atoms listed. U[iso] is the mean of the U[iso] or Ueqiv of the
listed atoms.
The atom TYPE is QL, with the given serial number. The
original atoms are not deleted, though they should be or their occupancy
set to zero. The atom type, QS, should be changed to something
appropriate. The DECLINATION and AZIMUTH are computed from the
constituent atoms.
<BR>

<BR>
<A NAME="REGROUP"> </A>
<A NAME="Reorganising atoms and peaks"> </A>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.regroup">6.6: Reorganisation of lists 5 and 10  -  \REGROUP</A></H3></CENTER>


<pre>
 \REGROUP INPUTLIST= OUTPUTLIST=
 SELECT MOVE= KEEP= MONITOR= SEQUENCE= SYMMETRY= TRANSLATION= GROUP=
 END
</pre><p><BR>

<pre>
 \REGROUP
 SELECT MOVE=1.6,MONITOR=HIGH
 END
</pre><p><BR>
<P>This routine offers a
 way of re-ordering the atoms in LIST 5 (atomic parameters) or LIST 10
 (Fourier peaks), so that
 related atoms or peaks
 form a sequential group in the list, and the coordinates put the atoms
 as close together as possible.
<P>THIS ROUTINE DOES NOT USE LIST 29 (atomic properties) to get bonding 
 distances, but uses a single overall distance.
<P>In this routine, a set of distances is calculated about
 each atom or peak in the list in turn.
 For each atom or peak in the list below the current pivot, the
 minimum contact distance is chosen, and if this is less than a user
 specified maximum, the atom or peak is moved up the list to
 a position directly below the pivot. ( The  MOVE  parameter).
 When more than one atom or peak is moved, their relative order is
 preserved as they are inserted behind the current pivot atom.
 As well as reordering the list, the necessary symmetry operators are
 applied to the positional and thermal parameters to bring the atom
 or peak into the same part of the unit cell as the current pivot
 atom. The result of this process is to bring related atoms together
 in the list, and to place all the atoms in the same part of the unit cell. 
 Setting the GROUP parameter to YES causes the PART to be incremented 
 between isolated parts of the structure.
<div class="instruction"><strong><u>\REGROUP INPUTLIST= OUTPUTLIST=</u></strong><br>
<div class="parameter"><i>INPUTLIST=</i>

<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="parameter"><i>OUTPUTLIST=</i>

<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="directive"><strong><i>SELECT MOVE= KEEP= MONITOR= SEQUENCE= SYMMETRY= TRANSLATION= GROUP=</i></strong>
<div class="parameter"><i>MOVE=</i>
 This parameter has a default value of 2.0, and is the distance
 below which atoms or peaks are considered to be bonded, and are thus
 moved about the cell and relocated in LIST 5 (atomic parameters).
<P>
 If the MOVE parameter is -ve, then a covalent radius used, and the
 absolute value of MOVE is used as a TOLERANCE, such that bonds are formed
 if D &lt; COV1+COV2+TOLERANCE.
<BR>



</div>
<div class="parameter"><i>KEEP=</i>
 This is the maximum number of atoms that the final output list can
 contain. If this parameter is omitted, all the atoms are output.
 If MOVE is used to move the atoms around, it is unwise to use the  KEEP
 parameter,since some of the original input atoms may find their way
 to the bottom of the list and be eliminated. (The default value is
 1000000).
</div>
<div class="parameter"><i>MONITOR=</i>

<pre>
      LOW   -  Default value
      HIGH
</pre><p><BR>
 If  MONITOR  is  HIGH, then each
 pivot atom and its associated moved atoms are listed, as well as any
 deleted atoms. If MONITOR is LOW,
 the moved atoms are not listed.
</div>
<div class="parameter"><i>SEQUENCE</i>

<pre>
      NO   -  Default value
      YES
      EXHYD
</pre><p><BR>
 If  SEQUENCE  is  YES, the outputlist is resquenced as described above.
<BR>
 If  SEQUENCE  is  NO, the serial numbers of the atoms are not
 changed from the  original list.
<BR>
 If SEQUECE is EXHYD the hydrogen atoms are excluded from the 
renumbering.
</div>
<div class="parameter"><i>SYMMETRY=</i>
 This parameter controls the use of symmetry information in the calculation of
 contacts, and can take three values.

<pre>
      SPACEGROUP  -  Default value. The full spacegroup symmetry is used in
                                    all computations
      PATTERSON.     A centre of symmetry in introduced, and the translational
                     parts of the symmetry operators are dropped.
      NONE.          Only the identity operator is used.
</pre><p><BR>
</div>
<div class="parameter"><i>TRANSLATION=</i>
 This parameter controls the application of cell translations in the
 calculation of contacts, and can take the values YES or NO
<BR>
</div>
<div class="parameter"><i>GROUP</i>

<pre>
      NO   -  Default value
      YES
</pre><p><BR>
 If  GROUP  is  YES, the PART parameter for each atom is set.
<BR>
<A NAME="COLLECT"> </A>
<A NAME="Repositioning atoms and peaks"> </A>
</div>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.collect">6.7: Repositioning of atoms  -  \COLLECT</A></H3></CENTER>

<P>This routine changes the atom
 coordinates so as to form a 'molecule' using the covalent radii given in
 LIST 29 (atomic properties - see section !elabel!LIST29!). The atom TYPE, SERIAL 
 and order in LIST 5 (atomic parameters - see section !elabel!LIST05!) is not changed.
<BR>
<div class="instruction"><strong><u>\COLLECT INPUTLIST= OUTPUTLIST=</u></strong><br>
<div class="parameter"><i>INPUTLIST=</i>

<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="parameter"><i>OUTPUTLIST=</i>

<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="directive"><strong><i>SELECT MONITOR= TOLERANCE= TYPE= SYMMETRY= TRANSLATION=</i></strong>
<div class="parameter"><i>MONITOR=</i>

<pre>
      LOW   -  Default value
      HIGH
</pre><p><BR>
 If  MONITOR  is  HIGH, then each
 pivot atom and its associated moved atoms are listed, as well as any
 deleted atoms. If MONITOR is LOW,
 only deleted atoms are listed.
<BR>
</div>
<div class="parameter"><i>TOLERANCE=</i>
 The tolerance is added to the sum of the co-valent radii
 taken from LIST 29 (atomic properties - see section !elabel!LIST29!) to give a 
 value used for determining inter-atomic bonds.
 The default is 0.2 A.
<BR>
</div>
<div class="parameter"><i>TYPE=</i>

<pre>
      ALL
      PEAKS
      ATOMS
</pre><p><BR>
 If TYPE equals ALL, then the coodinates of all atoms and Q-peaks 
 are liable to be
 modified by the symmetry operators in order to assemble a single fragment.
<BR>
 If TYPE equals PEAKS, then only the peaks are moved to bring them as close
 as possible to existing atoms.
<BR>
 If TYPE equald ATOMS, only non-Q atoms are modified
<BR>
</div>
<div class="parameter"><i>SYMMETRY=</i>
 This parameter controls the use of symmetry information in the calculation of
 contacts, and can take three values.

<pre>
      SPACEGROUP  -  Default value. The full spacegroup symmetry is used in
                                    all computations
      PATTERSON.     A centre of symmetry in introduced, and the translational
                     parts of the symmetry operators are dropped.
      NONE.          Only the identity operator is used.
</pre><p><BR>
</div>
<div class="parameter"><i>TRANSLATION=</i>
 This parameter controls the application of cell translations in the
 calculation of contacts, and can take the values YES or NO
<BR>
<BR>
<A NAME="ORIGIN"> </A>
<A NAME="Shifting the molecule to a permitted alternative origin"> </A>
</div>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.origin">6.8: Shifting the molecule to a permitted alternative origin - \ORIGIN</A></H3></CENTER>


<pre>
 \ORIGIN INPUTLIST= OUTPUTLIST= MODE=
 END

</pre><p><BR>
<P>Attempt to move the structure to the centre of the unit cell
 using the permitted origin shifts.
<div class="instruction"><strong><u>\ORIGIN INPUTLIST= OUTPUTLIST= MODE=</u></strong><br>
<BR>
<BR>
<div class="parameter"><i>INPUTLIST=</i>

<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="parameter"><i>OUTPUTLIST=</i>
<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="parameter"><i>MODE=</i>
<pre>
      CENTROID   -  Default value.
      FIRST
</pre><p><BR>
<P>CENTROID tries to move the centroid of LIST 5 as close to .5 .5 .5
 as is permitted by the permitted origin shifts.  Other connected atoms follow 
 the centroid.
<P>FIRST  As above excpet that the first atom in LIST 5 is the 
 target atom.  This may be a user-computed partial centroid.
<pre>
      \edit
      cent 100 residue 3
      move qc(100)
      end
      \origin mode=first
</pre><p><BR>
<P> Currently (April 2011) the code only processes primitive triclinic, 
monoclinic and orthorhombic cells, using the tables in Direct Methods in 
Crystallography, Giacovazzo, Academic press, 1980, pp 74 and 76.
<BR>

<A NAME="CONVERT"> </A>
<A NAME="Converting B[ij's] to U[ij's]"> </A>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.convert">6.9: Conversion of temperature factors - \CONVERT</A></H3></CENTER>


<pre>
 \CONVERT INPUTLIST= OUTPUTLIST= CROSSTERMS=
 END

 \CONVERT
 END
</pre><p><BR>
<P>This routine will convert the temperature factors of a set of atoms
 into the correct form when their temperature factor, t, is given by :

<pre>
       T = exp(-B[iso]*S**2)     where s = sin(theta)/lambda.

 or for an anisotropic atom :

       T = exp(-(h*h*b[11] + k*k*b[22] + l*l*b[33]
           + k*l*2*b[23] + h*l*2*b[13] + h*k*2*b[12]))
</pre><p><BR>
 The cross terms stored in the original LIST 5 (the model parameters) 
 may either be  B[IJ]  or 2*B[IJ] .
 (The correct form of the temperature factor, in terms of u[ii]'s
 and u[ij]'s, is given in the section on the input of LIST 5).
 After conversion, the atoms are output to the disc as a new LIST 5.
 Remember that if U[ISO] is non-zero, (its default at atom input is 0.05)
 the U[IJ] are ignored and so will not be converted.
<div class="instruction"><strong><u>\CONVERT INPUTLIST= OUTPUTLIST= CROSSTERMS=</u></strong><br>
<P>This is the command which initiates the routine
 to convert the temperature factors.
<div class="parameter"><i>INPUTLIST=</i>

<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="parameter"><i>OUTPUTLIST=</i>
<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="parameter"><i>CROSSTERMS=</i>
<pre>
      B[IJ]   -  Default value.
      2B[IJ]
</pre><p><BR>
<A NAME="Hydrogen placement"> </A>
<A NAME="HYDROGENS"> </A>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.hplace">6.10: Hydrogen placing - \HYDROGENS</A></H3></CENTER>


<pre>
 \HYDROGENS INPUTLIST= OUTPUTLIST=
 DISTANCE  D
 SERIAL    N
 U[ISO]    U
 U[ISO]    NEXT   MULT
 AFTER     TYPE(SERIAL)
 PHENYL    X R(1) R(2) R(3) R(4) R(5)
 H33       X R(1) R(2)
 H23       X R(1) R(2)
 H13       X R(1) R(2) R(3)
 H22       X R(1) R(2)
 H12       X R(1) R(2)
 H11       X R(1)
 HBOND     DONOR ACCEPTOR
 END
</pre><p><BR>

<pre>
 \HYDROGENS
 DISTANCE  1.09
 U[ISO]    NEXT   1.2
 H33     C(7) C(6) R(5)
 H22     C(14) C(15) C(13)
 END
</pre><p><BR>
 This routine computes the coordinates of hydrogen atoms bonded to a
 target atom. The hybridisation of the target atom and the identifiers of
 atoms bonded to it must be given.
<div class="instruction"><strong><u>\HYDROGENS INPUTLIST= OUTPUTLIST=</u></strong><br>
<div class="parameter"><i>INPUTLIST=</i>
<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="parameter"><i>OUTPUTLIST=</i>
<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="directive"><strong><i>DISTANCE  D</i></strong>
 This sets the central atom-hydrogen atom distance to
 'D' angstroms. The default value is 1.0.
 The current value of 'D' remains in force until another 'DISTANCE'
 directive is given.
</div>
<div class="directive"><strong><i>SERIAL  N</i></strong>
 This sets the serial number of the next hydrogen atom
 to be added to LIST 5 (atomic parameters) to 'N'.
 The default value is 1.
 Subsequent hydrogen atoms will have the serial numbers 'N+1', 'N+2', etc.,
 until the next 'SERIAL' directive is input.
</div>
<div class="directive"><strong><i>U[ISO]    U</i></strong>
 This directive sets the isotropic temperature factor
 of each hydrogen atom
 to 'U' angstroms squared,
 and remains in force until another 'U[ISO]'
 directive is given.
 If no values is given for U, the next definition is used.
</div>
<div class="directive"><strong><i>U[ISO]    NEXT   MULT</i></strong>
 This is an alternatine form of the preceding directive. It sets the
 isotropic temperature factor  of each hydrogen atom
 to 'MULT' times the equivalent temperature factor of the atom it is
 bonded to.  The default value is 1.2.
 The directive remains in force until another 'U[ISO]'
 directive is given.
</div>
<div class="directive"><strong><i>AFTER   TYPE(SERIAL)</i></strong>
 The hydrogen atoms generated by the placing routines
 are inserted in the new LIST 5 (atomic parameters) after the atom
 'TYPE(SERIAL)'.
 This directive must appear immediately after the directive that generated
 the hydrogen atom coordinates, and applies only to that group of
 hydrogen atoms.
 If no 'AFTER' directive is
 given, the new hydrogen atoms are added at the end of the
 current LIST 5 (atomic parameters).
</div>
<div class="directive"><strong><i>PHENYL  X R(1) R(2) R(3) R(4) R(5)</i></strong>
 This generates the coordinates of  the five hydrogen atoms
 of a phenyl group. The first atom specified must be
 the atom that bonds the phenyl group
 to the rest of the structure, and the other atoms must be in the order
 of connectivity.
</div>
<div class="directive"><strong><i>H33  X R(1) R(2)</i></strong>
 This geneates the hydrogen atoms of a methyl
 group.
 The methyl carbon is the first atom specified, and
 the hydrogen atoms are generated so that one of them is trans
 with respect to the third atom specified, R(2).

<pre>
      H
       \
      H-X-R(1)-R(2)
       /
      H
</pre><p><BR>
</div>
<div class="directive"><strong><i>H23  X R(1) R(2)</i></strong>
 This generates the coordinates of two hydrogen atoms on an sp3 atom X.

<pre>
      H   R(1)
       \ /
        X
       / \
      H   R(2)
</pre><p><BR>

</div>
<div class="directive"><strong><i>H13  X R(1) R(2) R(3)</i></strong>
 This generates the coordinates of one hydrogen atom on an sp3 atom X.

<pre>
          R(1)
         /
     H- X-R(2)
         \
          R(3)
</pre><p><BR>

</div>
<div class="directive"><strong><i>H22  X R(1) R(2)</i></strong>
 This generates the coordinates of two hydrogen atoms on an sp2  atom X

<pre>
      H        R(2)
       \      /
        X=R(1)
       /
      H
</pre><p><BR>

</div>
<div class="directive"><strong><i>H12  X R(1) R(2)</i></strong>
 This generates the coordinates of one hydrogen atom on an sp2 atom X.

<pre>
        H
         \
          X=R(1)
         /
      R(2)
</pre><p><BR>
</div>
<div class="directive"><strong><i>H11  X  R</i></strong>
 This generates the coordinates of the single
 hydrogen atom bonded to an SP hybridised atom.
</div>
<div class="directive"><strong><i>HBOND X  R</i></strong>
 This generates a single H atom 'DISTANCE' angstroms from the donor
 in the direction of the acceptor. X is the donor, R the acceptor.

<pre>

        X-H....R
</pre><p><BR>

<pre>
 Place Hydrogen atoms on the following fragment:

      C(1)          C(5)
          \        /
           C(2)=C(3)
                   \
                    C(4)-Br(1)

     \HYDROGENS
      DISTANCE 0.99
      U[ISO]   0.06
      H33 C(1) C(2) C(3)
      AFTER C(1)
      H12 C(2) C(1) C(3)
      AFTER C(2)
      H23 C(4) Br(1) C(3)
      AFTER C(4)
      H33 C(5) C(3) C(4)
      END
</pre><p><BR>
<A NAME="Hydrogen placement - automatic"> </A>
<A NAME="PERHYDRO"> </A>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.perhydro">6.11: Perhydrogenation - \PERHYDRO</A></H3></CENTER>


<pre>
 \PERHYDRO INPUTLIST= OUTPUTLIST=
 DISTANCE  D
 SERIAL    N
 U[ISO]    U
 U[ISO]    NEXT   MULT
 ACTION    MODE
 TYPE      C or N
 END
</pre><p><BR>

<pre>
 \PERHYDRO
 U[ISO] NEXT 1.0
 END
</pre><p><BR>
 This command scans the atomic coordinates for carbon atoms, attempts
 to assign their hybridisation state (on the basis of bond lengths) and
 then generates \HYDROGEN commands to create any necessary hydrogen atoms.
 Existing Hydrogen atoms are not replaced by this routine.
<P>The generated commands may be processed internally by CRYSTALS without
 the user needing to see them, or they may be sent to the external files for
 later use. This is the default mode. If no new hydrogen atoms are 
 generated, no new external files are created.
<P>The external files are called DELH.DAT and PERH.DAT, with DELH 
 containing an entry for every atom created by PERH.  Executing DELH and 
 PERH will delete existing named atoms, and recreate them geometrically.
<div class="instruction"><strong><u>\PERHYDRO INPUTLIST= OUTPUTLIST=</u></strong><br>
<div class="parameter"><i>INPUTLIST=</i>
<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="parameter"><i>OUTPUTLIST</i>
<pre>
      5   -  Default value, the atomic coordinates
      10                    the Fourier peaks search
</pre><p><BR>
</div>
<div class="directive"><strong><i>DISTANCE  D</i></strong>
 This sets the central atom-hydrogen atom distance to
 'D' angstroms. The default value is 1.0.
 The current value of 'D' remains in force until another 'DISTANCE'
 directive is given.
</div>
<div class="directive"><strong><i>SERIAL  N</i></strong>
 This sets the serial number of the next hydrogen atom
 to be added to LIST 5 to 'N'.
 The default value is 1.
 Subsequent hydrogen atoms will have the serial numbers 'N+1', 'N+2', etc.,
 until the next 'SERIAL' directive is input.
</div>
<div class="directive"><strong><i>U[ISO]    U</i></strong>
 This directive sets the isotropic temperature factor
 associated with each hydrogen atom
 to 'U' angstroms squared.
 The default value is 0.05.
 The directive remains in force until another 'U[ISO]'
 directive is given.
</div>
<div class="directive"><strong><i>U[ISO]    NEXT   MULT</i></strong>
 This is an alternatine form of the preceding directive. It sets the
 isotropic temperature factor  associated with each hydrogen atom
 to 'MULT' times the equivalent temperature factor of the atom it is
 bonded to.  The default value is 1.2.
 The directive remains in force until another 'U[ISO]'
 directive is given.
</div>
<div class="directive"><strong><i>ACTION    MODE</i></strong>
<BR>
<div class="parameter"><i>MODE</i>
<pre>
      NORMAL
      PUNCH
      BOTH     -  Default value.
</pre><p><BR>
 NORMAL causes internal commands to be generated and executed. PUNCH causes
 output to the PUNCH file only. BOTH forces both actions.
<BR>
<BR>&nbsp;<BR>
</div>
</div>
<div class="directive"><strong><i>TYPE    MODE</i></strong>
<BR>
<div class="parameter"><i>MODE</i>
<pre>
      C   -  Default value.
      N
</pre><p><BR>
 C enables the program to place hydrogen atoms on carbon atoms.
<BR>
 N enables the program to place hydrogen atoms on nitrogen.
<BR>
It is advisable to perform placement on C before N, since the
hybridisation states of C are more clearly defined.
<BR>
<BR>&nbsp;<BR>
<BR>
<A NAME="HNAME"> </A>
<A NAME="Hydrogen - automatic renumbering  "> </A>
</div>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.hnumber">6.12: Hydrogen re-numbering - \HNAME</A></H3></CENTER>


<pre>
 \HNAME INPUTLIST= OUTPUTLIST=
 END
</pre><p><BR>

<pre>
 \HNAME
 END
</pre><p><BR>
 This command automatically renumbers hydrogen atoms so that their
 serial numbers are related to the bonded non-hydrogen atom.
<BR>&nbsp;<BR>
<A NAME="REGULARISE"> </A>
<A NAME="Regularisation of atomic groups"> </A>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.regularise">6.13: Regularisation of atomic groups - \REGULARISE</A></H3></CENTER>


<pre>
 \REGULARISE    MODE
 COMPARE
 KEEP
 REPLACE
 AUGMENT
 METHOD NUMBER
 GROUP NUMBER
 TARGET Atom Specifications
 IDEAL  Atom Specifications
 RENAME offset number
 CAMERON
 MAP Atom Specifications
 ONTO Atom Specifications
 SYSTEM a b c alpha beta gamma
 ATOM    x    y    z
 CP-RING x
 HEXAGON x
 OCTAHEDRON x y z
 PHENYL
 SQP x y z
 SQUARE x y
 TBP x z
 TETRAHEDRON x
 END
</pre><p><BR>
<BR>&nbsp;<BR>

<pre>
 \REGULARISE REPLACE
 GROUP 6
 TARGET C(1) UNTIL C(6)
 PHENYL
 END
</pre><p><BR>
<P>This routine calculates a fit between the
 coordinates of a group of atoms in LIST 5 (atomic parameters) and another 
 group.
 The calculated fitting matrix may be used to compare the geometry of two
 groups, or it may be applied to transform the new coordinates which will
 then replace the existing group in LIST 5 (D. J. Watkin, Act Cryst
 (1980). A36,975).
<P>In this section, the group of atoms in LIST 5 to whose coordinates the
 fit is made is referred to as the 'TARGET atoms', and the group to be fitted
 onto that group is referred to as the 'IDEAL atoms'.
<P>The source of the 'IDEAL atoms' can be the LIST 5,
 a pre-stored idealised geometry,  or values read in from the directives.
 Those directives that refer to LIST 5 use the usual CRYSTALS formats for
 atom specifications. Once a transformation has been found, this can be 
 used as the basis for naming one fragment based on the names of 
 another.

<div class="instruction"><strong><u>Input for REGULARISE</u></strong><br>
<P>The input to REGULARISE must define the groups to be fitted together,
 the method used for fitting , and the use to be made of the results.
 The user must ensure that corresponding atoms
 are specified in the same positions of the 'TARGET' and 'IDEAL' group
 definitions, so the program knows which pairs of atoms are to be
 matched.
   It is not necessary to have co-ordinates of every atom
 in the TARGET fragment. The inclusion of atom specifications
 for which coordinates do not exist in the parameter list indicates
 that the procedure must generate coordinates for these atoms.
  This allows the user to give a type and serial to new atoms
 created by the procedure.
 Any 'atoms' without coordinates are not included in the fitting
 process.
<P>The maximum number of atom  IDENTIFIERS permitted on an TARGET or
 IDEAL directive is about 250. Note that an UNTIL sequence only 
 counts as two identifiers.
 The number of implied atoms permitted is very large.
<P>The 'IDEAL' group may be given in various ways.
 For calculations
 on a single structure,  it may be extracted from the stored data
 in the same way as the 'TARGET' group.  In this case however, all the atoms
 must previously exist.
 Alternatively, explicit co-ordinates may be  given in
 a system defined  by the user,   or a predefined group may be used.
 In any case all the positional parameters of
 the atoms in the  'IDEAL' group will be known before the
 calculation begins. Finally, various pre-defined geometrical groups are
 available.
</div>
<div class="instruction"><strong><u>Output from REGULARISE</u></strong><br>
<P>The output from REGULARISE  includes the fragment centroids, their
 sums and differences and the
 transformation fitting the IDEAL onto the TARGET.

</div>
<div class="instruction"><strong><u>Method of calculation</u></strong><br>

<P>The centroid of each fragment is moved to the origin.
  The atomic
 coordinates are converted to an orthogonal system and rotated  to an
 'inertial tensor' system (to help condition the L.S. matrix).
<P>The fitting calculation is either constrained to be a pure rotation-
 inversion, or is a free linear transformation (rotation-diltion).
 If requested, the pure rotation component of the calculated
 rotation-dilation matrix is extracted.

 The calculated  matrix is applied to the co-ordinated of the
 'IDEAL' group, which is then converted back to crystal fractions,
 for comparison with the TARGET.
<div class="directive"><strong><i>WARNING</i></strong>
<P>The  3 by 3  transformation  matrices  generated  at  various
 stages  may  well  be  singular,  especially if  no rotation  is
 defined about one of the axes.  To combat possible problems with
 matrix inversion, a Moore-Penrose type matrix inverter is used.
 Even so, the user should be aware that there may be no unique solution
 to his problem. For example, when a planar fragment is fitted to an
 almost planar fragment one fit may involve inversion of the non-planar
 fragment. Inversion can be prevented by using Method 3.
 Note also that if almost planar groups are being fitted, the dilation
 factor perpendicular to the plane may be very large, and thus have an
 undesirable effect if applied to atoms far from the plane.
<BR>
</div>
</div>
<div class="instruction"><strong><u>\REGULARISE    MODE</u></strong><br>
 MODE is an  optional  parameter.
<div class="parameter"><i>MODE</i>
<pre>
      COMPARE      -      Default value
      KEEP
      REPLACE
      AUGMENT
</pre><p><BR>
<P>The effects are :-
<P>COMPARE        The specified groups are only compared. The
 translations and rotations necessary to match the
 groups will be calculated but not applied.
<P>KEEP           The specified groups will be compared and the
 calculated transformations applied. The TARGET atoms are
 kept, and atoms  whose parameters have been
 calculated will be stored at the end of the new LIST 5.
 NOTE. If KEEP is given as a keyword, it can be followed by an offset
 to be used for the new serial numbers
<P>REPLACE        The specified groups will be compared and the
 calculated transformations applied. The new atoms whose parameters
 have been calculated will
 be placed at the end of LIST 5 and the old atoms deleted form the list.
<P>AUGMENT        The specified groups will be compared and the
 calculated transformations applied. The TARGET atoms which actually
 exist in LIST 5 are retained unaltered.
 Parameters that have been  calculated for dummy atoms (represented by a
 name only in the TARGET list) will be placed at the end of the new LIST 5.
<P>For REPLACE and KEEP the 'IDEAL' coordinates define the geometry to
 be preserved, i.e. the model, and the 'TARGET' coordinates specify where,
 in what orientation and with what atom identifiers the model is to be placed.
 That is, the TARGET structure is replaced by the IDEAL.
<BR>
</div>
<div class="directive"><strong><i>KEEP  Z</i></strong>
</div>
<div class="directive"><strong><i>COMPARE</i></strong>
</div>
<div class="directive"><strong><i>REPLACE</i></strong>
</div>
<div class="directive"><strong><i>AUGMENT</i></strong>
<P>These 4 directives override the option specified by the MODE parameter of
 the REGULARISE command. The next group calculated will be treated
 in the specified mode. See the description of MODE for
 details. If the mode is KEEP, an offset Z can be given to be added to 
ther SERIAL of kept atoms (default 0) otherwise there are no parameters.
</div>
<div class="directive"><strong><i>METHOD NUMBER</i></strong>
<P>This directive selects the method for matching the
 groups by giving its number from the
 following list:-

<pre>
      Number     Method
      ------     ------
       1        Rotation  component of  rotation-dilation
                matrix applied. ( default )
       2        Rotation-dilation  matrix  calculated and
                applied.
       3        Pure  rotation matrix  calculated  by the
                Kabsch method and applied. This algorithm
                preserves chirality.
       4        Enable improper rotation in Kabsch method
       5        Use identity matrix as rotation component
</pre><p><BR>
</div>
<div class="directive"><strong><i>GROUP NUMBER</i></strong>
<P>This directive specifies the number of atoms in the groups to be matched.
 It should be the first directive for each group of atoms. The appearance
 of a second or subsequent GROUP directive in the input
 initiates the calculation for the previous group.
</div>
<div class="directive"><strong><i>TARGET Atom Specifications</i></strong>
<P>This directive is used to specify the 'TARGET' group of atoms. The directive
 will carry a series of atom specifications which will define the positions
 of the 'TARGET' atoms and the names of any atoms to be created by the
 routine. Atoms which exist in LIST 5 and atoms to be created can appear in
 any order in the TARGET group , although the order should be such that
 corresponding pairs of atoms appear at the same relative positions in the
 'TARGET' and 'IDEAL' groups.
</div>
<div class="directive"><strong><i>IDEAL Atom Specifications</i></strong>
<P>This directive is used to specify a group of 'IDEAL' atoms to be taken
 from the stored LIST 5. Every atom on this directive must exist.
</div>
<div class="directive"><strong><i>SYSTEM a b c alpha beta gamma</i></strong>
<P>This directive is will change the co-ordinate system used to interpret any
 subsequent ATOM directives.
<P>The initial co-ordinate system has orthogonal axes of unit length and is
 equivalent to :-
<pre>
 SYSTEM  1.0  1.0  1.0  90.0  90.0  90.0
</pre><p><BR>
<P>Values must be given for a', b', and c', the angles default to 90.0.
</div>
<div class="directive"><strong><i>ATOM    x    y    z</i></strong>
 This directive allows the cordinates of a single atom to be specified,
 in fractional co-ordinates in the current co-ordintate system. It must be
 followed by three decimal numbers which will be the X, Y, and Z coordinates
 of the atom.
</div>
<div class="directive"><strong><i>RENAME offset number</i></strong>
 This directive can only be used after previous directives have been 
 used to match one group onto another (REGULARISE COMPARE),
 and enables the use of the MAP 
 and ONTO directives. The MAP list of atoms is transformed by the 
 existing transformation matrix (which may have been computed from only a 
 few specified atoms). Each atom is then compared with the ONTO list, 
 and the TYPE and SERIAL of the MAP atom used to generate a TYPE and 
 SERIAL for the closest ONTO atom. 
<div class="parameter"><i>OFFSET</i>
      The serial numbers of the atoms in the group being re-named are 
  related to those of the master group by an increment of 'OFFSET'. The 
 default value is 100
</div>
<div class="parameter"><i>NUMBER</i>
 If the number of atoms supplied on the following MAP and ONTO 
 directives does not match NUMBER, a warning is printed.
</div>
</div>
<div class="directive"><strong><i>CAMERON</i></strong>
 This matches atoms as in RENUMBER, but only creates CAMERON files
 with atoms transformed into the common coordinate system.
</div>
<div class="directive"><strong><i>MAP  Atom Specifications</i></strong>
 This specifies the atoms whose TYPE and SERIAL are to be propogated 
 into the ONTO atoms. The atoms can be in any order.
</div>
<div class="directive"><strong><i>ONTO  Atom Specifications</i></strong>
 This specifies the atoms to be renamed. The atoms may be in any order 
 and have any TYPE, but there must be EXACTLY as many as on the MAP 
 directive. The atoms can have any TYPE, but must have unique SERIAL 
 numbers.

</div>
<div class="directive"><strong><i>HEXAGON X</i></strong>
 The 'IDEAL' group is a regular hexagon with
 a side of length 'X'. The default for x is 1.0.
</div>
<div class="directive"><strong><i>PHENYL</i></strong>
 The same as HEXAGON with a fixed side of 1.39.
</div>
<div class="directive"><strong><i>CP-RING X</i></strong>
 The 'IDEAL' group is a regular pentagon with
 a side of length 'X'. The default for x is 1.4.
</div>
<div class="directive"><strong><i>SQUARE X Y</i></strong>
 The 'IDEAL' group is a rectangle with atoms
 at (x,0,0) , (0,y,0) , (-x,0,0) , (0,-y,0) . The parameters
 X and Y specify the size of the group to be used.
</div>
<div class="directive"><strong><i>OCTAHEDRON X Y Z</i></strong>
 The 'IDEAL' group is an octahedron with
 atoms at (0,0,0) , (-x,0,0) , (0,y,0) , (x,0,0) , (0,-y,0) ,
 (0,0,z) , (0,0,-z).
 The parameters X, Y and Z specify the size of the octahedron.
 'z' defaults to 'y' defaults to 'x'
 defaults to '1.0'
</div>
<div class="directive"><strong><i>SQP X Y Z</i></strong>
 The 'IDEAL' group is a square pyramid with
 atoms at (0,0,0) , (x,0,0) , (0,y,0) , (-x,0,0) , (0,-y,0) ,
 (0,0,z).
 The parameters X, Y and Z specify the size of the octahedron.
 'z' defaults to 'y' defaults to 'x'
 defaults to '1.0'
</div>
<div class="directive"><strong><i>TBP X Z</i></strong>
 The 'IDEAL' group is a trigonal bipyramid with
 atoms at (0,0,0) , (x,0,0) , (-x/2,0.86603x,0), (-x/2,-0.86603x,0) ,
 (0,0,z) , (0,0,-z) . The parameters X and Z specify the scale in the
 xy plane  and z directions.
</div>
<div class="directive"><strong><i>TETRAHEDRON X</i></strong>
 The 'IDEAL' group is a regular tetrahedron with
 an atom at the centre.
 'x' is the distance in Angstrom from the
 centre to an apex and defaults to '1.0'
</div>
<div class="directive"><strong><i>ORIGIN</i></strong>
<P>This directive is not yet implemented.
<BR>
</div>
</div>
<div class="instruction"><strong><u>Uses of \REGULARISE</u></strong><br>
<BR>&nbsp;<BR>
<div class="directive"><strong><i>1 - Extending a fragment to a complete molecule</i></strong>
<BR>
<P>Three atoms of a phenyl group ( C(1), C(2) C((6)) have been located.
 Fill in the missing  atoms from a non-dilated idealised phenyl group.

<pre>
      \REGULARISE AUGMENT
      GROUP 6
      METHOD 1
      \ C(3), C(4), and C(5) do not yet exist.
      TARGET C(1) C(2) C(3) C(4) C(5) C(6)
      PHENYL
      END
</pre><p><BR>
<BR>
</div>
<div class="directive"><strong><i>2 - Forcing a regular shape on a group of atoms</i></strong>
<P>A group of atoms is approximately  octahedral.
 Replace them by a (posibly dilated) regular octahedron.

<pre>
      \REGULARISE REPLACE
      GROUP 7
      METHOD 2
      TARGET CO(1) N(1) N(2) N(3) N(4) N(5) N(6)
      OCTAHEDRON
      END
</pre><p><BR>
</div>
<div class="directive"><strong><i>3 - Checking for an additional symmetry element</i></strong>
<P>Determine whether the two molecules in an asymmetric unit are
 related  by a  symmetry operation not  expected for the space  group.
 The matrix relating the molecules and the translation required  to
 make their centroids  coincide should display any additional
 (approximate)  symmetry  present. Remember that if one molecule is
 the enantiomer of the other, Method 3 will lead to an unsatisfactory
 fitting unless  one molecule is inverted, (by using the operator -1 in
 the atom specifications e.g. FIRST(-1) UNTIL C(23). This can be done
 even if the space group is non-centrosymmetric ).
<BR>

<pre>
      \REGULARISE COMPARE
      GROUP 16
      TARGET C(101) UNTIL N(102)
      IDEAL  C(201) UNTIL N(202)
      END
</pre><p><BR>
</div>
<div class="directive"><strong><i>4 - Renaming a group of atoms</i></strong>
 A second group of atoms is given new TYPES and SERIAL numbers 
 so that the atom names are related to  a previously named group.
<P>
 In the example, the user has identified two sets of four non-coplanar 
 atoms in each 
 group e.g. C(1) with Q(103), C(3) with  Q(99) etc. The transformation 
 is then used to map the whole of the first group (C(1) until O(25)) onto 
 the second group (Q(96) until Q(120)). Both of these groups must contain 
 the same number of atoms, but they may be in any order. Atom Q(103) will 
 be renamed to C(101), atom Q(100) to C(107) etc. Once all the atoms 
 have been renamed, the list could be sorted based on the serial numbers.
<P>
  The MAP group of atoms must correspond to (though not necessarily include)
  the IDEAL, and similarly the ONTO and TARGET groups.

<pre>
      \REGULARISE
      GROUP 4
      IDEAL C(1) C(3) C(5) C(7)
      TARGET Q(103) Q(99) C(116) Q(100)
      RENAME 100
      MAP C(1) UNTIL O(25)
      ONTO Q(96) UNTIL Q(120)
      END
      \EDIT
      SORT SERIAL
      END
</pre><p><BR>
</div>
<div class="directive"><strong><i>5 - Viewing matched molecules in CAMERON</i></strong>
 This does the mapping as RENAME, but doesn't
 rename the atoms, just outputs CAMERON input files showing the two molecules
 superimposed.
<P>
  The MAP group of atoms must correspond to (though not necessarily include)
  the IDEAL, and similarly the ONTO and TARGET groups.  Use as follows:

<pre>
   \REGULARISE
   group 16
   target C(10) until C(26)
   ideal  C(60) until C(76)
   cameron
   onto   C(1) until C(49)
   map    C(51) until C(99)
   end
</pre><p><BR> This produces a cameron.ini, regular.l5i and regular.oby which may be viewed
 by choosing Graphics-&gt;Special-&gt;Cameron (use existing...) from the menu.
 Then type "obey regular.oby" in Cameron to colour the molecules nicely.
 The TARGET and IDEAL are used to obtain the mapping. The atoms in MAP and ONTO
 are just the ones you want to be included.
 Don't read the atoms back into CRYSTALS when closing CAMERON - they're in
 orthogonal coordinates.
<BR>
</div>
<div class="directive"><strong><i> - Comparing two structures</i></strong>
 The SYSTEM and ATOM directives enable one to compare one structure with
atoms from a second structure. However, since the second structure is 
not part of the main model, CRYSTALS knows nothing about the 
connectivity.  Using the KEEP z directive, the second strcuture can be 
added to the DSC file, enabling a complete calculation to be performed.
<BR> In the following example, O(16) is in a quite distinctly different 
position in the two structures, so place holder Q(16) is used during the 
first mapping. The input coordinates are added to the DSC file with 
SERIAL numbers off-set by 400.
<BR>
In the second calculation O(16) of the original structure is compared 
with Q(416) of the input structure. 
<pre>
\regular keep
keep 400
group 7
old mo(1) o(11) o(12) o(13) o(14) o(15) q(16)
system 8.4830 10.1870 11.0340 105.260 95.290 95.100 909.60
atom 0.1570 0.5269 0.2514
atom 0.1356 0.5975 0.1278  
atom -0.0296 0.4567 0.2632  
atom 0.2258 0.3448 0.1750  
atom 0.1693 0.6928 0.3850  
atom 0.4211 0.5669 0.2567  
atom 0.7960 0.1904 0.1727  


\regular compare
group 7
old mo(1) o(11) until o(16)
new mo(401) until q(416)
end
</pre><p><BR>

<BR>&nbsp;<BR>
<A NAME="MATCH"> </A>
<A NAME="Map two atomic groups together"> </A>
</div>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.MATCH">6.14: Map two atomic groups together - \MATCH</A></H3></CENTER>


<pre>
 \MATCH
 MAP Atom Specifications
 ONTO Atom Specifications
 RENAME n
 EQUALATOM
 METHOD
 END
</pre><p><BR>
<BR>&nbsp;<BR>

<pre>
 \MATCH
 METHOD 3
 MAP RESIDUE(1)
 ONTO RESIDUE(2)
 RENAME 100
 END
</pre><p><BR>
<P>This routine  uses the mapping routines in REGULARISE to compare
two residues.  Unlike REGULARISE itself, the user does not have
to list the atoms in any special order - the routine attempts to make
pairwise assigments. Initially this is done via a topographical search,
and refined by minimising cartesian residuals whenever degeneracy is 
found.

<div class="directive"><strong><i>MAP</i></strong>
<P>The following list of atoms is the ideal fragment with ideal atom 
types and numbers
<BR>
</div>
<div class="directive"><strong><i>ONTO</i></strong>
<P>The following list of atoms is the fragment ot be compared with the 
ideal.  There must be the same number of atoms in both fragments, but 
not necessarily in the same order. Inclusion of any Q atoms sets the 
EQUALATOM flag, ie the atom types are ignored.
<BR>
</div>
<div class="directive"><strong><i>EQUALATOM</i></strong>
<P>If this parameter is included, the atom types in the "ONTO" list are 
ignored - they can even be Q atoms
<BR>
</div>
<div class="directive"><strong><i>METHOD</i></strong>
<P>One of the METHODS available in REGULARISE<BR>
The default is method 4.
<BR>
</div>
<div class="directive"><strong><i>RENAME  n</i></strong>
<P>If the mapping is succerssful, atoms in the ONTO list are given the 
same type as the corresponding atom in the MAP list, and the same SERIAL 
plus "n".
<BR>
</div>
<div class="directive"><strong><i>OUTPUT LIST= PUNCH=</i></strong>
<P>lIST takes the values OFF, LOW, MEDIUM, HIGH.
<P>unch takes the values OFF, RESULTS<BR>
<P>Results creates an ASCII file that could be processed by EXCEL or 
other spreadsheet.
The fields are tab-deliminated, and have the following attributes.
<pre>
CSD_CIF_BAZHAM01  (title)
Asymmetric  (potential internal symmetry)
:Centroids   (x,y,z)A and (x,y,z)B  
:Axes of Inertia   (long, medium, short)A and (long, medium, short)B 
:Sum dev sq  After matching, Sum(delta_x^2), y and z.  Sum Separation^2 
:RMS dev  As above, but root mean square deviation rather than sums  
:RMS bond and tors dev  RMS differences of equivalent bond lengths and torsion angles  
:Min and Max bond dev  Minimum and maximum bond length differences.  
:Min and Max tors dev   Minimum and maximum torsion angle differences. 
:Mean & delta Centroids  Mean(xA,xB), (yA,yB), (zA,zB) and (xA-xB), (yA-yB), (zA-zB)
:Transformation   (3x3) transformation matrix
:Det and trace   Determinant and trace of matrix
:Closeness to ideal rotation  RMS of the deviations of matrix elements from integers  
:Closeness to group operator  RMS of the deviations of translations from integers  
:Combined measure of closeness    
:Rworst & Raverage  Worst and Average for to an operator, operator identifier  
:Symmetry  Local point group relating molecules.
:Pseudo  Pseudo point group  relating molecules.
:Operator  Pseudo symmetry operator.
:No_Atoms  Number of atoms in each molecule.
:S.G.  Original space group.
:Cell  Original unit cell parameters.
</pre><p><BR>
</div>
<div class="directive"><strong><i>Comparing lots of Z'=2 structures</i></strong>
<P>If one has a single cif file containing many Z'=2 structures, the whole 
 file can be processed structure-by-structure automatically, with 
 automatic matching of the structures. See
 Structure matching: measures of similarity and pseudosymmetry. 
 A.  Collins, R. I.  Cooper and D. J.  Watkin. 
 Journal of Applied Crystallography 2006;39(6):842-849.
<P>To do this, extract the structures from the CSD saving the results to 
 a single file using the operation 'Import CIF file' from the drop-down 
 menu 'X-ray Data'.  Before starting, 
 ensure that a file titled "cifproc.dat" is in the same folder as the 
 composite cif file and that it says:

<pre>
/edit
mon off
list off
insert resi
sel type ne h
end
/match
output punch=results
map resi(1)
onto resi(2)
end
/purge
end
</pre><p><BR>
<BR>&nbsp;<BR>
</div>
<div class="directive"><strong><i>Output from MATCH</i></strong>
<P>If the output is set to PUNCH=RESULTS, a summary of the result of 
each matching operation is copied to the Punch file (Usually BFILE.PCH)
All the information for each match is appended to a single line. The 
items are "tab deliminated" to facilitate reading them into 
spreadsheets. The keywords are preceeded by a ":" so that an editor can 
be used to break the line as necessary.
<P>Description of output:<BR>
<pre>
CSD_CIF_AANHOX01  
:Centroids    (the x,y and z coordinates of both centroids)
:Axes of Inertia    (the three axes of inertia of both molecules)
:Sum dev sq   (sum of the squares of the deviations in x,y,z and delta-d)
:RMS dev   (rms deviations in x,y,z and delta-d)
:RMS bond and tors dev     
:Min and Max bond dev     
:Min and Max tors dev   
:Sum & delta Centroids   
:Transformation    (matrix transforming one molecule to the other)
:Det and trace     (of the matrix - -ve indicates inversion)
:Closeness to ideal rotation   
:Closeness to group operator   
:Combined measure of closeness   
:Rworst & Raverage   
:Symmetry   
:Pseudo   
:Operator   
:No_Atoms   
:S.G.   
:Cell  
</pre><p><BR>
<BR>&nbsp;<BR>
<P>Example of output<BR>
<pre>
CSD_CIF_AANHOX01 
:Centroids       0.9169 0.6281 0.3346 1.0255 0.8741 0.8117 
:Axes of Inertia 59.3690 10.0284 0.1392 59.1659 10.1380 0.0762 
:Sum dev sq      0.0014 0.0014 0.0726 0.0754 
:RMS dev         0.0115 0.0114 0.0812 0.0828 
:RMS bond and tors dev 0.0040 2.3978 
:Min and Max bond dev  0.0003 0.0094 
:Min and Max tors dev  0.2952 6.1112 
:Sum & delta Centroids 0.9712 0.7511 0.5731 0.1086 0.2461 0.4771 
:Transformation 0.9662 0.1296 -0.071 -0.237 0.961 0.146 -0.476 0.292 -0.960
:Det and trace -1.0000 0.9679 
:Closeness to ideal rotation 0.21507 
:Closeness to group operator 0.21567 
:Combined measure of closeness 0.21522 
:Rworst & Raverage 0.203432098 0.186725736 10 
:Symmetry m 
:Pseudo m 
:Operator 0.11+X 0.25+Y 1.15-Z 
:No_Atoms 11 
:S.G. P N A 21 
:Cell 7.5570 11.4580 17.6020 90.0000 90.0000 90.0000
</pre><p><BR>

<BR>&nbsp;<BR>
<A NAME="BONDCALC"> </A>
<A NAME="Calculation of interatomic bonds"> </A>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.bondcalc">6.15: Calculation of interatomic bonds - \BONDCALC</A></H3></CENTER>
<A NAME="LIST41"> </A>


<pre>
 \BONDCALC
  END
</pre><p><BR>
<BR>&nbsp;<BR>

<pre>
 \BONDCALC FORCE
 END
</pre><p><BR>
<P>This routine calculates a list of unique bonds between
atoms in LIST 5 including bonds to symmetry related atoms.
The bonds are stored in LIST 41.

<div class="instruction"><strong><u> Method of calculation</u></strong><br>

<P>The BONDCALC routine uses the atomic positions from LIST 5 (the
model parameters, see !elabel!LIST05!) (together
with cell (LIST 1, see !elabel!LIST01!) and spacegroup information 
(LIST 2, see !elabel!LIST02!),
the covalent radii from LIST 29 (atomic properties, see !elabel!LIST29!), and any 
additional bonding information in LIST 40 to calculate a list of bonds. 
The algorithm and tolerances used depend upon settings in LIST 40.

<P>LIST 41 is only updated by \BONDCALC if there has been a change
to LISTS 5 or 40 OR if \BONDCALC FORCE is issued.<BR>
<BR>&nbsp;<BR>
<A NAME="\LIST 40"> </A>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.list40">6.16: Bonding information - \LIST 40</A></H3></CENTER>
<A NAME="LIST40"> </A>


<pre>
 \LIST 40
 DEFAULTS TOLTYPE= TOLERANCE= MAXBONDS= NOSYMMETRY= SIGCHANGE=
 READ NELEMENTS= NPAIRS= NMAKE= NBREAK=
 ELEMENT TYPE= RADIUS= MAXBONDS=
 PAIR TYPE1= TYPE2= MIN= MAX= BONDTYPE=
 MAKE TYPE= SERIAL= S= L= TX= TY= TZ=
      TYPE2= SERIAL2= S2= L2= TX2= TY2= TZ2= BONDTYPE=
 BREAK TYPE= SERIAL= S= L= TX= TY= TZ=
       TYPE2= SERIAL2= S2= L2= TX2= TY2= TZ2=
 END
</pre><p><BR>
<div class="directive"><strong><i>DEFAULTS TOLTYPE= TOLERANCE= MAXBONDS= NOSYMMETRY= SIGCHANGE=</i></strong>
<P> This directive may only appear once. It affects the algorithm used
to update LIST 41.
<div class="parameter"><i>TOLTYPE=</i>
 A value of 1 (default) causes \BONDCALC to use as a threshold for
 bonding, the sum of the covalent radii * the tolerance given.
 A value of 0 causes \BONDCALC to use the sum of the covalent radii + the
 tolerance given (in Angstroms), as a threshold.
</div>
<div class="parameter"><i>TOLERANCE=</i>
 The tolerance to be used in the \BONDCALC calculation as a threshold
 for bonds. Exact use depends on the value of the TOLTYPE keyword above.
</div>
<div class="parameter"><i>MAXBONDS=</i>
 Specifies the maximum number of bonds that may be formed to an atom. The
 BONDCALC calculation proceeds through the list of atoms searching for bonds,
 according to the TOLERANCE criteria. If more than MAXBONDS bonds are found,
 the best MAXBONDS will be kept. Best bonds are those where the sum of the
 covalent radii is closest to the actual bond length. (Where a PAIR 
 directive has been used, the best are the closest to the mean of the min and 
 max values  on the PAIR directive.)
 Note well: The calculation proceeds through the list of atoms, so bonds
 are formed from atoms near the top of the list to those lower down. While
 atoms lower down will still only form at most MAXBONDS bonds, they are 
 less likely to be the 'best' bonds since they are formed from atoms higher
 up the list. E.g. You have an H right at the end of the list, and you
 set MAXBONDS=1 for H (see ELEMENT). If the first atom forms a bond to that
 H, then no more bonds can be formed to that H even if they are better.
 If the H were at the top of the list it would get the choice of which bonds
 to pick. This is fairly unimportant stuff, it is rare that there will
 be ambiguities over whether something is bonded or not. The default value
 of MAXBONDS is therefore 15.
</div>
<div class="parameter"><i>NOSYMMETRY=</i>
 0 (default) searches for all symmetry related bonds.
 1 ignores symmetry, will not find bonds across operators, may speed
   up bond bond calculation slightly.
</div>
<div class="parameter"><i>SIGCHANGE=</i>
 Number of angstroms that any atom in LIST 5 must move during refinement
 for it to be considered a significant change resulting in a recalculation
 of bonding.
</div>
</div>
<div class="directive"><strong><i>READ NELEMENTS= NPAIRS= NMAKE= NBREAK=</i></strong>
 Specify the number of ELEMENT, PAIR, MAKE and BREAK directives that are
 to follow.
</div>
<div class="directive"><strong><i>ELEMENT TYPE= RADIUS= MAXBONDS=</i></strong>
 Override the covalent radius in L29 and the MAXBONDS value on the DEFAULTS
 directive for a specific element.
<div class="parameter"><i>TYPE=</i>
 The element type. E.g. C
</div>
<div class="parameter"><i>RADIUS=</i>
 The covalent radius to use for this element.
</div>
<div class="parameter"><i>MAXBONDS=</i>
 The maximum number of bonds to this element.
</div>
</div>
<div class="directive"><BR>DPAIR TYPE1= TYPE2= MIN= MAX= BONDTYPE=
 Override the covalent based calculation altogether.
<div class="parameter"><i>TYPE1=</i>
 An element type, e.g. C
</div>
<div class="parameter"><i>TYPE2=</i>
 An element type, e.g. O
</div>
<div class="parameter"><i>MIN=</i>
 The minimum length of a bond.
</div>
<div class="parameter"><i>MAX=</i>
 The maximum length of a bond.
</div>
<div class="parameter"><i>BONDTYPE=</i>
 The bondtype to be assigned to this bond. BONDCALC will eventually have a
 go at bond type assignment, if you are forced to add in extra PAIR
 commands then there is not much chance that the assignment will be correct
 so it can be specified here. Use 0 for unknown.
<P>More than one pair of the same elements can be used at once:

<pre>
e.g.
  PAIR C O 1.0 1.2 BONDTYPE=2
  PAIR C O 1.2 1.4 BONDTYPE=1
</pre><p><BR>
</div>
</div>
<div class="directive"><strong><i>MAKE TYPE= SERIAL= S= L= TX= TY= TZ= TYPE2= SERIAL2= S2= L2= TX2= TY2= TZ2= BONDTYPE=</i></strong>
Makes a bond between two atoms (possibly symmetry related).
<div class="parameter"><i>TYPE= TYPE2=</i>
An element type, e.g. C.
</div>
<div class="parameter"><i>SERIAL= SERIAL2=</i>
The serial number of the atom. (From List 5, atomic parameters).
</div>
<div class="parameter"><i>S= S2=</i>
The number of the symmetry matrix used from List 2 (list of space group 
symmetry operators, see section !elabel!LIST02!) (default, unity = 1).
Negative indicates centre of symmetry applied aswell.
</div>
<div class="parameter"><i>L= L2=</i>
The number of the non-primitive lattice translation from List 2. (default =1, 
see section !elabel!LIST02!)
</div>
<div class="parameter"><i>TX= TY= TZ= TX2= TY2= TZ2=</i>
Translations from asymmetric unit co-ordinates.
</div>
<div class="parameter"><i>BONDTYPE=</i>
 The bondtype to be assigned to this bond. BONDCALC will eventually have a
 go at bond type assignment, if you are forced to add in extra MAKE
 commands then there is not much chance that the assignment will be correct
 so it can be specified here. Use 0 for unknown.
</div>
</div>
<div class="directive"><strong><i>BREAK TYPE= SERIAL= S= L= TX= TY= TZ= TYPE2= SERIAL2= S2= L2= TX2= TY2= TZ2=</i></strong>
As for MAKE, but without the BONDTYPE keyword.
<BR>
<A NAME="\BONDING"> </A>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.bonding">6.17: Bonding information - \BONDING</A></H3></CENTER>


<pre>
 \BONDING ACTION
 DEFAULTS TOLTYPE= TOLERANCE= MAXBONDS= NOSYMMETRY= SIGCHANGE=
 ELEMENT TYPE= RADIUS= MAXBONDS=
 PAIR TYPE1= TYPE2= MIN= MAX= BONDTYPE=
 MAKE  atom-specification TO atom-specification bondtype
 BREAK atom-specification TO atom-specification
 END
</pre><p><BR>
<P>THis is a more user-friendly alternative to inputting a LIST 40.
Directive syntax is like \LIST 40 with the following exceptions:
<P>1) ACTION. This can take two values:

<pre>
      REPLACE (Default, and replace previous LIST 40 with a new on)
      EXTEND  (adds new commands to end of existing LIST 40)
</pre><p><BR>
<P>2) The MAKE and BREAK directives look like this:

<pre>
 MAKE C(1) TO C(4) 8
 BREAK N(1) TO H(14)
</pre><p><BR>
<P>Symmetry may be specified in the standard CRYSTALS way, the numbers
in parenthesis are serial,S,L,Tx,Ty,Tz (see above) the list may be
truncated when the rest are default values: (serial,1,1,0,0,0):

<pre>
 MAKE C(1,2,1,0,1,1) TO C(8) 4
</pre><p><BR>
<P>3) The READ directive need not be given. This makes it easier to edit
text files containing the command as you don't have to remember to alter
the values on the READ directive.
<P>3) The command may be given as \BONDING EXTEND, in which case it takes
any directives given and adds them to the existing LIST 40.
<BR>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.print40">6.18: Printing of LIST 40</A></H3></CENTER>

<P>LIST 40 may be listed with either
<div class="instruction"><strong><u>\PRINT 40</u></strong><br>
 or
</div>
<div class="instruction"><strong><u>\SUMMARY 40</u></strong><br>
<P>LIST 40 may be punched with
</div>
<div class="instruction"><strong><u>\PUNCH 40</u></strong><br>
which will produce a standard List 40 in CRYSTALS format, or
</div>
<div class="instruction"><strong><u>\PUNCH 40 B</u></strong><br> 
which will produce a \BONDING command which is easier to edit.
<BR>
</div>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.null list 40">6.19: Creating a null LIST 40</A></H3></CENTER>

<P>A null LIST 40, containing no extra information, may be created with

<pre>
 \LIST 40
 END
</pre><p><BR>
or

<pre> 
 \BONDING
 END
</pre><p><BR>
<HR><small><A HREF="crystalsmanual-atomic.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="atomic.print41">6.20: Printing of LIST 41</A></H3></CENTER>

<P>LIST 41 may be listed with either
<div class="instruction"><strong><u>\PRINT 41</u></strong><br>
 or
</div>
<div class="instruction"><strong><u>\SUMMARY 41</u></strong><br>
<P>Issuing \BONDCALC when there is no LIST 40 will cause a null list 40
to be created.
<BR>
<BR>
</div>
