<!-- XTLVAR title="Getting Started" -->
<!-- XTLVAR comment="Getting Started" -->
<!-- XTLVAR cvssource="manual/guide.man" -->
<H1>Crystals User Guide</H1>
<H2>Chapter 2: Getting Started</H2>
<DL><DT>
<DD><A HREF="guide-2.html#2.1">2.1: INITIALISATION file</A><br>
<DD><A HREF="guide-2.html#2.2">2.2: The basic data file</A><br>
<DD><A HREF="guide-2.html#2.3">2.3: Migration from other program systems</A><br>
<DD><A HREF="guide-2.html#2.4">2.4: The SCRIPT 'NEWSTRUCTURE'</A><br>
<DD><A HREF="guide-2.html#2.5">2.5: Data reduction</A><br>
<DD><A HREF="guide-2.html#2.6">2.6: EXAMPLE 1</A><br>
<DD><A HREF="guide-2.html#2.7">2.7: EXAMPLE 2</A><br>
<DD><A HREF="guide-2.html#2.8">2.8: EXAMPLE 3</A><br>
<DD><A HREF="guide-2.html#2.9">2.9: EXAMPLE 4</A><br>
</DL>
<BR>
<P>The CRYSTALS system contains no routines for initial processing of the 
 user's raw diffractometer data. Some other program must be used to prepare
 a file containing at least h,k,l and I for each reflection. If there is a
 serial number or X-ray exposure time
 associated with each reflection, the reflections need not be 
 on a common scale, and a list of scale factors can be input to CRYSTALS
 (LIST 27) to perform the scaling as a function of serial or time.
 If reflections fall into a number of
 distinct batches each on its own absolute scale
 (from two crystals for example)
 a batch serial number may be associated with each reflection,
 and batch scale factors refined later during least-squares.
 There is no mechanism provided for extracting scale factors from intersecting
 data sets (Hamilton, Rollet, Sparks, Acta Cryst (1965) 18, 129). If absorption
 corrections are going to be applied, the user can either let CRYSTALS
 compute the reflection setting angles, or if a non-standard geometry was used
 he can input the actual observed angles.
 If the user wishes to use the standard
 deviations of his reflection in some future calculation, they should be
 provided in the input data and keys set to store them on the DISK.
<P>If Patterson methods are not the most suitable for solving the structure,
 the user must use some other program (for example SIR, SHELXS, MULTAN). 
 The instructions \PUNCH 6 and \FOREIGN enable
 structure factors to  be output
 from CRYSTALS after data reduction in a variety of fixed and variable
 formats, some suitable for direct input to other programs.
<BR>
 The compressed format provides a suitable method for economical archiving  
 of the reflections. This file could perhaps be appended to a file containing
 the other basic data for the structure, thus providing a source for rebuilding
 the DISK file should that be necessary. From time to time the user could 
 append his latest coordinates to this file . 
<BR>
<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.1">2.1: INITIALISATION file</A></H3></CENTER>
<P>On program startup, CRYSTALS tries to obey an initialisation file,
  CRYSINIT.DAT, if it exists. This file may contain any valid CRYSTALS
 commands. Typically it contains 'system' commands like \SET &lt;parameters&gt;.
 It may also contain instructions to perform disk house keeping, or pass
 control to other files. In particular, the command \USE 
 CRDIR:CRYSINIT.DAT will pass control to a CRYSINIT file in the current 
 subdirectory, so that different subdirectories can have different
 initialisation files. The commands \USE CONTROL passes control to the 
 terminal or batch control file without obeying futher CRYSINIT commands,
 and can be used to terminate the SCRIPT mode of working. A command like
 \USE CRDIR:INITIAL.DAT causes the file INITIAL to be processed, and so
 provides a mechanism for loading the disk file on systems where it cannot
 be preserved between jobs.
<BR>
<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.2">2.2: The basic data file</A></H3></CENTER>
<BR> 
<P>The basic data file contains those data which are unlikely to change 
 during the course of the refinement. If subsequent events indicate that
 the original data were in error (for example, space group ambiguity) the
 new data could be appended to this file so that a record is kept of the
 initial tries. Details of most of the LISTS are found in VOL2,  INITIAL.

<P>
 The basic data file should contain:-
<pre>
 TITLE   A line giving the compound name, source, formula, 
          date etc.
 LIST 1  The cell parameters. 
 LIST 2  The space group information. This is more 
          conveniently input with the SPACEGROUP command.
 LIST 3  The scattering factors. This list may contain 
          coefficients for atom types not in the current 
          structure, but since every atom type entry occupies 
          space in the users DISK, it would be unwise to use
          a single LIST 3 containing more than a dozen atom 
          types, unless the structure contained about that 
          many different atom types.
 LIST 4  The weighting scheme. The default is unit weights.
          Statistical weights are also available, but they
          are rarely suitable for the least-squares refinement 
          without extensive modification (Huml, Computing in 
          Crystallography, (1980), 12.15,  Indian Academy of 
          Sciences, Bangalore). 
 LIST 13 Details of the data collection procedure.
 LIST 14 The Fourier map limits. Remember the unique volume for
          a Patterson synthesis may be different to that for a 
          Fourier. Both are usually set with the SPACEGROUP 
          command.
 LIST 23 Mainly concerned with details for structure factors 
          and least-squares, but worth setting up here in case 
          it's forgotten later.
 LIST 29 Elemental properties, such as radii, weight.
</pre><p><BR>
<P>The command \SPACEGROUP can be used to generate operators for most
 spacegroups in most settings and will also generate the Fourier limits,
 and \COMPOSITION will generate LISTS 3 and 29
 from standard data files provided with the program.

<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.3">2.3: Migration from other program systems</A></H3></CENTER>
<BR>
<P>If the basic data processing has been done in some other program system,
 the command \QUICKSTART provides a convenient way to transfer the data to
 CRYSTALS. If intensity
 data, i.e. I not F or F**2, are given, data reduction for four circle
 geometry is automatically performed.
  This is an example taken from VOL2 of the manual.

<pre>
 \QUICKSTART
 SPACEGROUP P 21 21 2
 FORMULA C 6 H 4 N O 2 CL
 FILE CRDIR:REFLECT.DAT
 FORMAT (3F3.0, 2X, 2F8.2)
 DATA 1.5418
 CELL 10.2 12.56 4.1
 END
</pre><p><BR>
<BR>
<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.4">2.4: The SCRIPT 'NEWSTRUCTURE'</A></H3></CENTER>
<BR>
<P>At sites where some on-line working is permitted, the SCRIPT NEWSTRUCTURE
 (which call the scripts STARTUP and DATRED, and hence many other sub-scripts)
 will guide the user into getting his initial data into the 
 CRYSTALS data base.
<BR>
<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.5">2.5: Data reduction</A></H3></CENTER>
<BR>
<P>Intensity data can be introduced to CRYSTALS either by embedding it in a 
 control file, or from an auxilliary file read by the instruction \LIST 6 or
 \HKLI. This is the only time in CRYSTALS that users data are read in
 from an auxilliary device. If the data are in a compact form,
 say lines with four reflections
 per line, and there are not too many reflections, it would be best to enter them directly into the command line. If the reflections are in an extended form
 with, say, setting angles and other information for each
 reflection, it is probably more efficient to read them from the auxilliary 
 file. The user has the option of FIXED or FREE format
 reads. With the exception of CRYSTALS compressed data, FIXED format reads
 are always more efficient. Remember that a figure of -512 or less for
 the first value on a reflection line terminates reflection input.
<P>The section REFLECTIONS in the manual describes the options available
 and explains why work files are used at this stage. The user has already
 been cautioned (above) about the work files, he should also remember that
 sorting many thousand records can be time consuming. At the end of data
 reduction the user must copy his data from the work file onto his DISK
 (using READ TYPE=COPY in LIST 6)
 otherwise all it will contain is information pointing to the (possibly
 deleted!) work file. Some installations may provide means to preserve
 the work files, but this should only be necessary when processing large
 data sets. The reflection handling procedures in CRYSTALS are powerful
 but for many purposes a simple strategy will suffice. If multi-batch
 data is being processed, e.g. from several crystals, the user will need
 to change the data keys.
 REFLECTIONS bears reading several times.
<P>The instruction \SYSTEMATIC should always be used, since it may provide
 confirmation of the space group, and moves reflections, by the permitted
 symmetry operators, into a standard segment of reciprocal space. This
 is a prerequisite for \SORT and \MERGE, which should also usually be applied
 since the computation of Fourier maps and structure factors is speeded
 up if the reflections are in a standard order. The user should not MERGE
 his reflections or apply Friedel's law if subsequent computations are geometry
 (e.g. analytic absorption) or polarity (e.g. anomalous scattering) dependent,
 or if he has multi-batch data and intends to refine batch scale factors.
<P>A user doing many crystals structures might prepare himself a standard
 data reduction file which he could USE for all structures.
<BR>
<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.6">2.6: EXAMPLE 1</A></H3></CENTER>
<BR>
<P>Intensity data are available on a common scale, 4 reflections per line, having been collected on a Weissenberg diffractometer, and are to
 be embedded in the input stream. The INSTRUCTONS, DIRECTIVES and keywords
 are written out more or less in full, though the experienced user might
 wish to omit or abreviate them.

<pre> 
 \LIST 13
 DIFFRACTION GEOMETRY=EQIUINCLINATION
 CONDITIONS WAVELENGTH=1.5418
 AXIS 1 0 0
 \LIST 6
 READ NCOEF=4 TYPE=FIXED F'S=NO NGROUP=4 UNIT=DATAFILE
 FORMAT (4(3F4.0,F8.0))
 END
 1   0   0    1234   2   0   0   24600   
 4   0   0    5000   6   0   0    100
 (etc)
 -512 
 \ a dummy reflection to end the list
 \LP
 \SYST
 \SORT
 \MERGE
 \LIST 6
 READ TYPE=COPY
 \FINISH
</pre><p><BR>
<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.7">2.7: EXAMPLE 2</A></H3></CENTER>
<P>The reflection data output from a CAD4 are in a separate file produced 
 by a pre-processor and in a format defined in the manual. No geometry
 dependent calculations are being done, so the default null orientation matrix
 can be used.

<pre>
 \LIST 13
 DIFF GEOM=CAD4
 MATRIX
 COND
 \ the standard conditions on this site are 
 \ monochromatic Mo radiation
 \HKLI
 \LP
 \SYST
 \SORT
 \MERGE
 WEIGHT SCHEME=2 NPARAM=6
 \ this scheme filters out outliers
 PARAM .05 3.0 1.0 2.0 .01 .0001
 REFLECTIONS LIST=MEDIUM
 \ contributors more than 3 sigma from the 
 \ mean are listed with a *
 \LIST 6
 READ TYPE=COPY
 \FINISH
</pre><p><BR>
<P>The keyword RATIO should be used in LIST 28 to limit the minimum ratio of
 I/sigma(I) used in calculations.
<BR>
<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.8">2.8: EXAMPLE 3</A></H3></CENTER>
<P>The data are in a free format, and the user wishes to carry weights 
 based on sigma(Fo)
 through into least-squares. The reflections are embedded in the control data.

<pre>
 \HKLI
 READ 5 FREE UNIT=DATAFILE F'S=YES
 INPUT H K L /FO/ SIGMA(/FO/)
 STORE 7
 OUTPUT INDICES /FO/ WEIGHT /FC/ BATCH/PHASE 
 CONT   SIGMA(/FO/) RATIO
 \ note that a slot is left for the weight later
 END
 1 0 0 123 10
 2  0 0 24600 130
 3  1 0 15420  70
 -512 0 0 0 0
 \LP
 \SYST
 \SORT
 \MERGE
 \LIST 4
 SCHEME 7
 \ to generate weights from sigma
 \WEIGHT
 \ this generates the weights from sigma, and stores 
 \ them in the weight slot. NOTE  that after the COPY, 
 \ the sigma slot does not exist by default, so that a 
 \ reWEIGHTing with scheme 7 will loose the weights.
 \LIST 6
 READ TYPE=COPY
 END
 \LIST 4
 SCHEME 5
 \ this ensures that we dont loose the weights by an 
 \ accidental reweight.
 END
 \USE LAST
</pre><p><BR>
<P>In this example the weights are calculated and applied while the data is
 on the scratch files. The LIST 4 could equally well have been applied after
 the LIST 6, i.e. at some much later stage of the process, if we had preserved
 the sigmas.
<P>The instruction \HKLI enables the user to apply some simple absorption 
 corrections. All are only approximate, but do prove to be cost effective 
 for routine work. The PHI and THETA corrections involve interpolation. The 
 interval between  the points should reflect the rate at which the curve
 is changing. This is particularly important for the PHI correction (NORTH,
 PHILLIPS, MATHEWS, Acta Cryst (1968) A24, 351) when the sample is plate-like.
 A plan for preparing a phi curve is to observe the intensity of a reflection
 whose scattering vector is close to the diffractometer phi axis at a number
 of phi values (say, at 10 degree intervals). For the calculation to be even
 approximately valid, the I vs phi curve should have two-fold symmetry, so
 that the two halves of the curve (0-180 and 180-360) can be superimposed
 and a smooth curve drawn through them. Values of I and phi are taken from this
 curve for a range rather less than 180 degrees and input to CRYSTALS.
 The user should note that he must give PHI 
 Eulerian values, and not psi or phi-Kappa values.
<P>The 'tube' correction, originally devised for cases where the sample was
 in a capilliary tube inclined at a substantial angle to the phi axis,
 (Watkin, J. Appl. Cryst. (1975) 8, 491),
 can be used to provide an approximate correction for needle-like crystals
 inclined to the phi axis. In this case the parameter 'MU' should be something
 like 0.8*mu*r, where r is the needle diameter. A[max] in this case would be
 the correction for a ray passing along the axis of needle. The 'plate'
 correction is similar, with 'MU' being mu*t, where t is the plate 
 thickness. A[max] is rather less than the correction for a ray passing along 
 a diameter of the plate.
<P>The theta correction is suitable for any correction which is a smooth
 function of theta only, for example the spherical or cylindrical corrections
 tabulated in International Tables. Expect to see your temperature factors
 increase if you apply this correction!
<P>If the user has measured standard reflections from time to time, he can 
 compute decay or stability corrections. These are introduced to CRYSTALS as 
 a LIST 27. Each reflection must have an associated sequence number.
 This can either be a serial number or a figure derived from, say, the X-ray
 exposure time. 
 The scale factors in LIST 27 are associated with the the sequence
 number of the first of each batch of standard reflections. The scale factor
 for general reflections is then obtained by interpolation in this table.
 To avoid interpolation across scale discontinuities, two different scale
 factors may be given with the same sequence number. If the reflection sequence
 numbers do not rise continuously, (for example data from two experiments)
 interpolation will continue safely if scale factors are present in LIST 27
 for the two reflections at the discontinuity. The scale factor scalenumbers
 are not used by CRYSTALS. Remember that there is a maximum value for
 the sequence numbers (try (X-ray time in secs)*0.1). 
<BR>

<HR><small><A HREF="guide-2.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="2.9">2.9: EXAMPLE 4</A></H3></CENTER>
<pre>
 \LIST 27
 READ NSCALE=10
 SCALE 1 1.00 1.00 2
 SCALE 2 1.01 1.00 30
 SCALE 3 1.00 1.00 60
 \ reflection sequence 60 is the first with 
 \ the larger scale factor
 SCALE 4 3.00 3.00 60
 SCALE 5 3.01 3.01 90
 SCALE 6 3.02 3.02 120
 SCALE 7 3.03 3.03 147 
 \ reflection sequence 147 is the last in 
 \ the old experiment
 \ reflection sequence 3 is the first in the new
 SCALE 8 3.03 3.03 3
 SCALE 9 3.02 3.03 50
 SCALE 10 3.03 3.03 100
 END
</pre><p><BR>
