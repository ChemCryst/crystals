<!-- XTLVAR title="Atoms And Peaks, Parameters, And Parameter Values." -->
<!-- XTLVAR comment="Atoms And Peaks, Parameters, And Parameter Values." -->
<!-- XTLVAR cvssource="manual/guide.man" -->
<H1>Crystals User Guide</H1>
<H2>Chapter 3: Atoms And Peaks, Parameters, And Parameter Values.</H2>
<DL><DT>
<DD><A HREF="guide-3.html#3.1">3.1: ATOMS and PEAKS</A><br>
<DD><A HREF="guide-3.html#3.2">3.2: Parameters</A><br>
<DD><A HREF="guide-3.html#3.3">3.3: IMPLICIT parameters</A><br>
<DD><A HREF="guide-3.html#3.4">3.4: EXAMPLE 1</A><br>
<DD><A HREF="guide-3.html#3.5">3.5: EXPLICIT parameters</A><br>
<DD><A HREF="guide-3.html#3.6">3.6: Parameter values</A><br>
<DD><A HREF="guide-3.html#3.7">3.7: CAUTION</A><br>
<DD><A HREF="guide-3.html#3.8">3.8: EXAMPLE 2</A><br>
<DD><A HREF="guide-3.html#3.9">3.9: LIST 5</A><br>
<DD><A HREF="guide-3.html#3.10">3.10: EXAMPLE 3</A><br>
<DD><A HREF="guide-3.html#3.11">3.11: EXAMPLE 4</A><br>
<DD><A HREF="guide-3.html#3.12">3.12: Modifying LIST 5</A><br>
</DL>
<P>For the user, it is probably the highly stylised and powerful methods
 for refering to atoms and structural parameters which provide the 
 greatest conveniences in CRYSTALS. Atoms can be refered to either by
 a simple symbolic string, or by a more complex string which includes
 symmetry information.
 Parameters can  be refered to either explicitly or implicitly.
<BR>
<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.1">3.1: ATOMS and PEAKS</A></H3></CENTER>
<P>Atoms are identified by their TYPE (up to four alphanumeric characters
 beginning with a letter) and their SERIAL number.
 Atoms with the same type are distinguished from one another by having
 different serial numbers. However, at no stage is a check made to ensure
 that there is not more than one atom in LIST 5 with the same type and
 serial number. If a routine is searching for an atom with a given type
 and serial number, the first atom so specified will always be taken, and any
 subsequent atoms with the same type and serial number will be ignored.
<P>The atom 
 TYPE is used as the key when looking for scattering factors in LIST 3.
 The atom type PEAK is used by the system to identify peaks taken from a 
 map peak search. Users wishing to compute structure factors on peaks lists
 must either have a scattering factor for an atom type PEAK in their LIST 3,
 or use \EDIT to change PEAKS into some other atom type.
<BR>

<pre>
 EXAMPLES
        C(14)   PB(2)    PEAK(64)   Ca(12)
</pre><p><BR>
<P>Sometimes it is necessary to inform CRYSTALS that it must use an atom
 equivalent by space group symmetry to one actually occuring in LIST 5
 (for example, in defining a constraint), or CRYSTALS may wish inform the 
 user that an output atom is an equivalent (for example, in the distance
 angles output). On these occasions, the extended atom definition 
 (which conveys the symmetry information) is used. The specification is
<P>TYPE(SERIAL,S,L,TX,TY,TZ)
<P>TYPE and SERIAL were defined above, and have no default values. The other
 terms are optional, taking default values if omitted. Terms that are omitted
 must be indicated by their delimiting ",", except that the last given term may
 be delimited by a right parenthesis and the other default term delimiters be
 omitted.  Default values are given after the examples.
<BR>

<pre>
 EXAMPLES
 C(14,-1,2,1,0,1)
 ZN(1,-2,,1,,1)   equivalent to       ZN(1,-2,1,1,0,1)
 CU(3,-1)         equivalent to	     CU(3,-1,1,0,0,0)
</pre><p><BR>
<P>S specifies the symmetry matrix from
 LIST 2 which should be used. If S is negative, the atom coordinates from LIST
 5 are negated before the operator is applied. The default value for S is one
 corresponding to the first symmetry operator given in LIST 2. THIS NEED NOT
 BE THE UNIT MATRIX, though it will be if the user takes care to make his
 first  operator in LIST 2 the identity matrix.
<P>L specifies the non-primative lattice translation to be applied AFTER the S
 operation. The translations for the various centrings are listed in  
 VOL4. The default value for L is 1, corresponding to no translation.
<P>TX, TY, and TZ are whole cell translation parallel to the cell edges, and 
 are applied after S and L. Their default values are zero
<P>Thus if the user makes the unit matrix his first operator in LIST 2,
 atom specifications of the form
<P>C(2) FE(16)
<P>will refer to the atoms at the actual positions given in LIST 5. Two special
 'atoms' are permitted in CRYSTALS to enable users to handle LIST 5s in which
 they are not sure of the atom order. These are FIRST and LAST, refering to
 the first and last atoms in the list. A  SERIAL cannot be given for these 
 atoms, but S, L and the Ts can.
<P>Groups of atoms can be referenced by a composite atom specification, the
 UNTIL sequence.
<P>TYPE1(SERIAL1,S,L,TX,TY,TZ) UNTIL TYPE2(SERIAL2)
<P>In this definition, all atoms between and including TYPE1(SERIAL1) and
 TYPE2(SERIAL2) in LIST 5 are referenced. Clearly, a sensibly ordered 
 LIST 5 will enable the user to profit from this construction.
 If any operators 
 are specified for the first atom, these operators are applied to all the atoms
 in the sequence. The atoms FIRST and LAST may be used in an UNTIL sequence.
<BR>
<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.2">3.2: Parameters</A></H3></CENTER>
<P>Parameters may be given either implicitly or explicitly.
<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.3">3.3: IMPLICIT parameters</A></H3></CENTER>
<P>In an implicit reference, all parameters 
 of a given type are invoked merely by giving the parameter name.

<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.4">3.4: EXAMPLE 1</A></H3></CENTER>
<pre>
 \LIST 12
 FULL X Y Z U'S
 END
</pre><p><BR>
<P>This instruction, which will be discussed more fully under Least-Squares,
 causes full matrix refinement to be carried out on the x, y, z and all the
 anisotropic temperature factors of all the atoms.
<BR>
<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.5">3.5: EXPLICIT parameters</A></H3></CENTER>
<P>In an explicit reference to atomic or overall parameters,
 the individual parameters must be individually defined, though the UNTIL
 sequence, discussed above, provides a method for referencing groups of atoms.
<P>The CRYSTALS system allows the user to associate  parameter names 
 with parameter values. These names are used in symbolic references to the
 parameter itself. 
 Thus, to refer to the X coordinate of carbon(1), the user would type
<P>C(1,X)
<P>Multiple parameter references are permitted in some instances, for example in
 defining matrix blocks for least-squares. e.g.
<P>CL(17,X,Z) indicating that the operation will be applied to both X and Z of the Cl atom with serial number 17.
<BR>
<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.6">3.6: Parameter values</A></H3></CENTER>
<BR>
<P>Values corresponding to parameters are stored 
 either in LIST 5 or in LIST 10. LIST 5
 is either input by the user, or may be generated by system operations
 on an existing LIST 5 or LIST 10. LIST 10 has a similar format to LIST 5
 and is produced either by a peak search on a Fourier map or by an operation on
 an existing LIST 10. Default values are provided by the system for some 
 parameters.
<BR>
<P>The parameters stored for an atom are:
<BR>

<pre>
 TYPE - Described above under ATOMS and PEAKS.
 SERIAL - Described above under ATOMS and PEAKS
 OCC - The chemical site occupation factor, defaults to 1.0 
      (excluding symmetry effects).
 U[ISO]  - The isotropic temperature factor, defaults to 0.05.
 X -  The fractional x coordinate.
 Y -  The fractional y coordinate.
 Z -  The fractional z coordinate.
 U[11] | 
 U[22] |
 U[33] | The components of the atomic displacement parameters.
 U[23] |
 U[13] |
 U[12] |
</pre><p><BR>
<P>The temperature factors are defined by:

<pre>
 T[ISO] = EXP(-8*PI*PI*U[ISO]*S**2) 
 where S = sin(theta)/lambda
</pre><p><BR>
<P>and

<pre>
 T[ANISO] = EXP(-2*PI*PI*(h*h*as*as*U[11]
             +k*k*bs*bs*U[22]+l*l*cs*cs*U[33]
             +2.0*k*l*bs*cs*U[23]+2.0*h*l*as*cs*U[13]
             +2.0*h*k*as*bs*U[12])).
</pre><p><BR>
<P>where 'xs' are the reciprocal cell parameters
 and h, k and l are the Miller indices of the current reflection.
<P>An atom is considered to be isotropic when  abs(U[ISO])&gt;0.00005.
 If an atom is isotropic and one or more of the anisotropic temperature
 factors is to be refined, the anisotropic terms are calculated from
 U[ISO]  and then  U[ISO]  is set to zero. The conversion in the
 other direction is also made, except that  U[ISO]  assumes its default
 setting. \EDIT can be used to generate U[EQUIV] from U[ANISO]. The
 minimum (most negative) permitted value for U[ISO] or U[ii] is set in
 LIST 23.
<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.7">3.7: CAUTION</A></H3></CENTER>
<P>Beware the U[ISO] default when inputting a LIST 5!
 It should be noted that if a set of anisotropic atoms are input with no
 U[ISO]  key or  U[ISO]  data, then the default value of 0.05 will be
 inserted. This implies that all such atoms are
 isotropic, so that the anisotropic temperature factors will be treated as
 zero, and the calculation will proceed for isotropic atoms.
<P>Although it is possible to input an overall temperature factor as one
 of the overall parameters, it is not possible to use it under all
 circumstances. In fact, the structure factor routines always take the
 temperature factor of an individual atom as the value or values stored
 for that atom. If the overall temperature factor is to be refined, the
 system will ensure that the current value of the overall temperature
 factor is inserted for the temperature factor of all the atoms. When the
 new parameters are computed after the solution of the normal equations,
 this substitution is again made, so that all the atoms have the same
 overall isotropic temperature factor. However, if the overall temperature
 factor is not refined, or no refinement is done, the individual temperature
 factor for each atom will be used, and the overall temperature factor ignored.
<P>The dummy overall temperature factor is in no way related to the overall
 temperature factor, and its use is explained in the section on refinement.
<BR>

<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.8">3.8: EXAMPLE 2</A></H3></CENTER>
<pre>
 \LIST 5
 READ NATOM=2
 ATOM  PB 1 U[ISO]=0 X=.89 .78 .97 .11 .22 .33 .23 .13 .12
 ATOM  C  2          X=.45 .56 .46
</pre><p><BR>
<P>The overall structural parameters are:

<pre>
 SCALE    - The overall scale factor. Defaults to 1.0
 DU[ISO]  - The dummy overall temperature factor. 
           See the section on L.S.
 OU[ISO]  - The overall isotropic temperature factor. 
           Default is .05
 POLARITY - The Rogers polarity parameter. Default is 1.
 ENANTIO  - The Flack polarity parameter. Default is zero.
 EXTPARAM - The Larson extinction parameter. Default is zero.
</pre><p><BR>
<P>The remaining parameters are:

<pre>
 LAYERS - The layer scale factors.
 BATCH - The batch scale factors.
</pre><p><BR>
<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.9">3.9: LIST 5</A></H3></CENTER>
<BR>
<P>LIST 5 holds the parameter values, and the user should go to the Manual
  to find the full specifications. It can best be regarded as a table
 in which the column headings define the types of parameter, and the row
 labels the types of entity to which the paramertes belong. Certain entries
 in the table are mandatory, e.g. parameter type SERIAL for entity type
 ATOM, and others are optional, e.g. U[ISO], for which there is already
 a default value entered.
<BR> 
 As an aid to beginners, some examples are given here.
<BR>

<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.10">3.10: EXAMPLE 3</A></H3></CENTER>
<pre>
 \LIST 5\
 \ no overall parameters. DU[ISO],OU[ISO] and SCALE 
 \ all have default values
 \ 5 atoms
 READ NATOM = 5
 ATOM C 1 X=0.094,Y=0.343,Z=0.890
 ATOM C 2 1 0.05 0.149 0.411 0.651 0 0 0 0 0 0
 ATOM C 3 X=0.050 0.406 0.648
 ATOM TYPE=C,SERIAL=4,OCC=1,U[ISO]=0,
 CONT X=0.027,Y=0.384,Z=0.725,
 CONT U[11]=0.075,U[22]=0.048,U[33]=.069,
 CONT U[23]=-.007,U[13]=.043,U[12]=-.001
 ATOM C 5 U[ISO]=0.0 .108,.365,.815,.074 
 CONT .051 .065 -.015 .048 -.014
 END
</pre><p><BR>

<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.11">3.11: EXAMPLE 4</A></H3></CENTER>
<pre>
 \LIST 5
 READ NATOM = 2, NLAYER =   6
 \ the zone axis is (H00)
 INDEX 1 0 0 1
 \ there are 6 layers, 0 to MOD(5)
 \ layer 3 (H=2) had the X-rays turned down!
 LAYERS 1 1 1.3 1 1 1
 OVERALL     20.821314   EXTPARAM=21.2
 ATOM C 1  U[ISO]=0. X=-0.231   0.085   0.066 
 CONT .038 .043 .041 .001 -.006 .003
 ATOM H 73           X=-0.443   0.231   0.219
 END
 \LIST 23
 \ note that layer scales are not applied unless
 \ set in LIST 23
 MODIFY EXTINCTION=YES LAYERSCALES=YES ANOMALOUS=YES
 \LIST 12
 \ remember that 'FULL' implies the overall scale factor.
 FULL LAYER(3)
 END
 \SFLS
 REFINE
 END
</pre><p><BR>
<P>In this example we have some parameters defined by position, (SCALE,
 TYPE, SERIAL, Y, Z, and the temperature factors), and some by keyword
 (U[ISO], EXTPARAM and X). Although only layer 3, h=2, is anomalous,
 layer scales must be given for all layers. The layer scale factors and
 the extinction parameter are
 not applied during the computation of structure factors unless LIST 23
 requests them.
<P>Batch scale factors are handled in the same way as layer scales, except
 that the BATCH parameter must be set for each reflection in LIST 6.
 Remember that the BATCH parameter will be undefined if reflections 
 from different BATCHES have been merged together.
<BR>
<HR><small><A HREF="guide-3.html">[Top]</A> <A HREF="manindex.html">[Index]</A> Manuals generated on Friday 5 July 2024</small>
<CENTER><H3><A NAME="3.12">3.12: Modifying LIST 5</A></H3></CENTER>
<BR>
<P>As mentioned elsewhere, LIST 5 can be output from the binary database
 as a character file. The instruction \PUNCH 5 produces a file in a form
 suitable for re-input to CRYSTALS. '\PUNCH 5 D' produces a file in the
 SHELX format. These files can be edited using the manufacturer's editor,
 and such a procedure might be appropriate in an environment where interactive
 processing is restricted. In general however, the user is advised to use the
 \EDIT instruction in CRYSTALS. This is a purpose-built editor for manipulating
 parameters. Like all editors, it seems to get better as the user becomes more
 familiar with the facilities.
 Before editing a LIST 5, the user will usually wish to know something about
 its contents. Information can be extracted in several ways.
<div class="instruction"><strong><u>1. What is the order of the atoms in LIST 5?</u></strong><br>
<P>This must be known in order to use the UNTIL construct effectively. Possible
 solutions are:-

<pre>
   \SUMMARY LIST 5 LOW
   END
</pre><p><BR>
<P>This produces an ordered listing of the atom types and serial numbers
 on the terminal and output listing.

<pre>
   \MOLAX
   ATOM FIRST UNTIL LAST
   END
</pre><p><BR>
<P>This produces an ordered list of the atom types, serial numbers and 
 'best plane' coordinates onthe terminal and output listing.

</div>
<div class="instruction"><strong><u>2.  What are the atomic coordinates?</u></strong><br>
<pre>
   \DISPLAY HIGH
   END
</pre><p><P>This displays LIST 5 on the terminal.

<pre>
   \EDIT
   LIST HIGH
   END
</pre><p><BR>
<P>This produces an ordered listing of the atom types and serial numbers
 and parameters in an abbreviated form on the terminal.

<pre>
    \PRINT 5
    END
</pre><p><BR>
<P>This produces a full listing of LIST 5 in the line printer file.

</div>
<div class="instruction"><strong><u>3. What is the connectivity?</u></strong><br>
<pre>
   \DISTANCE
   OUTPUT MONITOR=DISTANCE
   END
</pre><p><BR>
<P>This produces a  listing on the terminal and in the printer file.

<pre>
    \MOLAX
    ATOM FIRST UNTIL LAST
    PLOT
    END
</pre><p><BR>
<P>This produces a labelled line diagram on the terminal and the printer file.
<BR>
</div>
